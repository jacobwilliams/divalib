<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Edition of DIVA">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>OPTCHK &ndash; diva</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">diva </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/diva_module.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/diva_module.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>OPTCHK
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.3% of total for procedures.">136 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/diva_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/diva_module.f90.html'>diva_module.f90</a></li>
    
     <li><a href='../module/diva_module.html'>diva_module</a></li>
    
  
     <li class="active">OPTCHK</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/optchk.html#src">OPTCHK</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine OPTCHK(INTCHK, IOPT, ETEXT)
    
    
   
</h2>
    
  


    
    <p>This subroutine is intended for the use of other library routines.
 It is used to check the storage used by options for some array.</p>
<p>INTCHK is an array that provides information on how storage has been
   allocated.  Information is provided in groups of three words, after
   an initial group of 4 that contain:
    0. INTCHK(0) / 10 is the index to use for error messages, and
       mod(INTCHK(0), 10) defines actions as follows:
       Value  Action on Errors  Action if no errors
         0    Prints &amp; Stops               Returns
         1    Prints &amp; Returns             Returns
         2    Prints &amp; Stops      Prints &amp; Returns
         3    Prints &amp; Returns    Prints &amp; Returns
        &gt;3  Any error message will be continued, subtract 4 from the
            value to get one of the actions above.
    1. Contains LAST, 1 more than the index of the last location in
       INTCHK used to store the information as described below.
    2. The amount of storage available in the array being checked.  If
       this is 0, it is assumed that the user would like to know what
       size to declare for the array, and if it is -1, it is assumed
       that a library routine is doing the check without knowing what
       the declared size is.
    3. The amount of storage required in this array if no options were
       used.  (This + 1 is first loc. available for option storage.)
   The rest should be set as follows, for k = 5, LAST, 3:
    k-1 Option index, 0 indicates storage required by default.  (This
        may depend on input parameters, but doesn't depend explicitly
        on an option.)
    k   If &gt;0, gives the start of space used by the option.
        If &lt;0, gives -(amount of space required by an option), for
               which a starting location is to be determined.
    k+1 If preceding entry is &gt;0, gives space required by the option.
        Else it is assumed that the space requested is to be found,
        and a diagnostic will be given if space can not be found.  Else
        INTCHK(K+1) IOPT(INTCHK(k+1)) Diagnostic on successful alloc.?
            0           ----          No
            &lt;0          ----          Yes
            &gt;0          /= -1       Yes
            &gt;0          == -1       No, and IOPT(INTCHK(k+1)) is set
                                      to starting loc. of space found.
        When this program finds the space for an option, values of
        INTCHK(j) for j &gt;= LAST will be used.  INTCHK(k+1) is set
        temporarily to -(space required) and INTCHK(k-1) is reduced by
        2000000 to flag the fact that the location index must be saved
        after INTCHK(LAST).  INTCHK(LAST) is assumed to contain 1 if
        the largest space requested is required, and to contain
        -(minimal space needed) if the large amount requested is not
        essential.
   On exit, INTCHK(1) is set = -LAST if there was some kind of error.
   (Unless the user has called MESS this return can't happen.)
   INTCHK(2) is set to suggest a value for the storage to be declared.
   The remaining locations are changed as follows:
    k-1 Negated if there was a problem with this option, or if the
        following location was initially &lt;0.
    k   Starting location used or suggested for the option.
    k+1 Last location used or suggested for the option.</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">In</span> <span class="n">addition</span> <span class="k">if</span> <span class="n">values</span> <span class="n">of</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">LAST</span> <span class="n">are</span> <span class="n">used</span><span class="p">,</span>
    <span class="n">INTCHK</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="n">LAST</span><span class="o">+</span><span class="mh">1</span><span class="p">,</span> <span class="n">LAST</span><span class="o">+</span><span class="mh">2</span><span class="p">,</span> <span class="p">...,</span> <span class="n">will</span> <span class="n">be</span> <span class="n">set</span> <span class="n">so</span> <span class="n">that</span>
    <span class="n">INTCHK</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="n">is</span> <span class="n">equal</span> <span class="n">to</span> <span class="p">(</span><span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">k</span><span class="p">&#39;</span><span class="n">s</span> <span class="n">above</span><span class="p">)</span> <span class="o">-</span> <span class="mh">1</span> <span class="k">for</span> <span class="n">an</span> <span class="n">option</span>
    <span class="n">that</span> <span class="n">has</span> <span class="n">had</span> <span class="n">a</span> <span class="n">starting</span> <span class="n">location</span> <span class="n">assigned</span><span class="p">,</span> <span class="k">and</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span> <span class="n">is</span>
    <span class="n">set</span> <span class="n">to</span> <span class="n">the</span> <span class="n">last</span> <span class="n">index</span> <span class="n">value</span> <span class="k">for</span> <span class="n">j</span> <span class="n">in</span> <span class="n">the</span> <span class="n">above</span> <span class="n">list</span><span class="p">.</span>
</code></pre></div>

<p>IOPT  This is stored to if INTCHK(k) is &lt; 0, see above.
 ETEXT Input text of the form 'Package_name / Argument_name$E'.  Thus
   for argument KORD of the package DIVA, this would = 'DIVA / KORD$E'.</p>
<p><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em> Variable definitions </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong>*</strong>*</p>
<p>ERRBAD Flag to use for error severity if get an error.  17 if errors
        are to print but not stop, 57 otherwise.
 ETEXT  (Input) Used to construct error messages, see above.
 I      Induction variable for accessing INTCHK().
 INTCHK (InOut) See above.
 IOPT   (Out) If space information is being obtained results are saved
        here.  See above.
 ISTRT  Starting index for placing options with unknown locations.
 KEX    Points to the last place in INTCHK where indices of entries
        that have had locations determined here are stored.
 L      Temporary index.
 LAST   First free location in INTCHK.  (=INTCHK(1))
 LNEG   Index of the first INTCHK entry that is to be positioned.
 LOPT   Location in IOPT to get location of INTCHK entry that is
        positioned.
 LTXTAx Variables setup by PMESS defining the locations in MTXTAA where
        various error messages start.
 LTXTEE Location in MTXTAA where data in ETEXT is stored.
 LTXTZZ Number of characters available for saving ETEXT in MTXTAA.
 LWANT  -Number of locations wanted by INTCHK entry being positioned.
 MACT   Vector used to specify error printing actions, see MESS.
        MACT(2) flags error/diagnostic level.  = 0 none; 07 is used to
        get diagnostics only; and ERRBAD otherwise.
 MEEMES Parameter specifying that error message is to be printed.
 MEIDAT Parameter specifying location in INTCHK to start printing
        integer in MESS.
 MEIMAT Parameter specifying an integer matrix is to be printed.
 MENTXT Parameter specifying location in INTCHK to start printing
        text from MTXTAA in MESS.
 MERET  Parameter specifying the end of an error message.
 MESS   Routine to print error and diagnostc messages.
 METEXT Parameter specifying that text is to be printed.
 MI     Temporary index used to save in acceptable location.
 MTXTAA Used to contain error message text and instructions, see MESS.
 MTXTAx Character variables setup by PMESS and equivalenced into ETEXT
        used to contain parts of the error messages.
 MTXTZZ As for MTXTAx, except not setup by PMESS.  Used to hold text
        from ETEXT.
 MV     Temporary, which contains value associated with INTCHK(MI).
 N      Temporary value.
 NERBAD Array telling what to do concerning errrors.  ERRBAD is set
        from NERBAD(mod(INTCHK(0), 10)), and the default value for
        MACT(2) is set from NERBAD(INTCHK(0)+4).</p>
<h3>History</h3>
<ul>
<li>1998-11-01 OPTCHK  Krogh  ERRSEV =&gt; MACT(2) for "mangle".</li>
<li>1996-05-13 OPTCHK  Krogh  Changes to use .C. and C%%.</li>
<li>1995-03-10 OPTCHK  Krogh  Added "abs(.) just below "do 140 ..."</li>
<li>1994-11-11 OPTCHK  Krogh  Declared all vars.</li>
<li>1993-05-17 OPTCHK  Krogh  Additions for Conversion to C.</li>
<li>1991-11-25 OPTCHK  Krogh  More comments, little clean up of code.</li>
<li>1991-10-09 OPTCHK  Krogh  More comments, little clean up of code.</li>
<li>1991-06-27 OPTCHK  Krogh  Initial Code.</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-intchk"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>INTCHK</strong>(0:*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iopt~3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IOPT</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-etext"></span>character</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ETEXT</strong>*(*)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~optchk~~CalledByGraph Pages: 1 -->
<svg id="procoptchkCalledByGraph" width="153pt" height="32pt"
 viewBox="0.00 0.00 153.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~optchk~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~optchk~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 149,-28 149,4 -4,4"/>
<!-- proc~optchk -->
<g id="proc~~optchk~~CalledByGraph_node1" class="node">
<title>proc~optchk</title>
<polygon fill="none" stroke="black" points="145,-24 90,-24 90,0 145,0 145,-24"/>
<text text-anchor="middle" x="117.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">OPTCHK</text>
</g>
<!-- proc~diva -->
<g id="proc~~optchk~~CalledByGraph_node2" class="node">
<title>proc~diva</title>
<g id="a_proc~~optchk~~CalledByGraph_node2"><a xlink:href=".././proc/diva.html" xlink:title="DIVA">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVA</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;proc~optchk -->
<g id="proc~~optchk~~CalledByGraph_edge1" class="edge">
<title>proc~diva&#45;&gt;proc~optchk</title>
<path fill="none" stroke="#000000" d="M54.07,-12C62.12,-12 71.14,-12 79.76,-12"/>
<polygon fill="#000000" stroke="#000000" points="80,-15.5 90,-12 80,-8.5 80,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/optchk.html#src">OPTCHK</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">OPTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">,</span> <span class="n">ETEXT</span><span class="p">)</span>

      <span class="kt">integer </span><span class="n">INTCHK</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="o">*</span><span class="p">),</span> <span class="n">IOPT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">ETEXT</span><span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="kt">integer </span><span class="n">I</span><span class="p">,</span> <span class="n">ISTRT</span><span class="p">,</span> <span class="n">KEX</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">LAST</span><span class="p">,</span> <span class="n">LNEG</span><span class="p">,</span> <span class="n">LOPT</span><span class="p">,</span> <span class="n">LWANT</span><span class="p">,</span> <span class="n">MI</span><span class="p">,</span> <span class="n">MV</span><span class="p">,</span> <span class="n">N</span>

      <span class="c">! Declarations for error messages.</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MENTXT</span> <span class="o">=</span> <span class="mi">23</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIDAT</span> <span class="o">=</span> <span class="mi">24</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MECONT</span> <span class="o">=</span> <span class="mi">50</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MERET</span>  <span class="o">=</span> <span class="mi">51</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEEMES</span> <span class="o">=</span> <span class="mi">52</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">METEXT</span> <span class="o">=</span> <span class="mi">53</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIMAT</span> <span class="o">=</span> <span class="mi">58</span>

      <span class="kt">integer </span><span class="n">MACT</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">ERRBAD</span><span class="p">,</span> <span class="n">NERBAD</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">! ********* Error message text ***************</span>
<span class="c">![Last 2 letters of Param. name]  [Text generating message.]</span>
<span class="c">!AA OPTCHK$B</span>
<span class="c">!AB &quot;Option #&quot; is negated if option needs attention.$N</span>
<span class="c">!   &quot;Option 0&quot; is for space not associated with a specific option.$N</span>
<span class="c">!   &quot;First Loc.&quot; is negated if user did not set value.$N</span>
<span class="c">!   Space avail. = $I; all options must have first loc. &gt; $I$E</span>
<span class="c">!AC Option #$HFirst Loc.$HLast Loc.$E</span>
<span class="c">!AD From subprogram/argument: $B</span>
<span class="c">!AE Space for ETEXT.$E</span>

      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAA</span> <span class="o">=</span>   <span class="mi">1</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAB</span> <span class="o">=</span>   <span class="mi">9</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAC</span> <span class="o">=</span> <span class="mi">233</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAD</span> <span class="o">=</span> <span class="mi">267</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAE</span> <span class="o">=</span> <span class="mi">295</span>

      <span class="kt">character </span><span class="n">MTXTAA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">156</span><span class="p">)</span>
<span class="c">!                          Next 4 lines not automatically generated</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTEE</span> <span class="o">=</span> <span class="n">LTXTAE</span> <span class="o">-</span> <span class="mi">156</span> <span class="o">-</span> <span class="mi">2</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXEND</span> <span class="o">=</span> <span class="mi">156</span>
<span class="c">!</span>
      <span class="k">data </span><span class="n">MTXTAA</span><span class="o">/</span><span class="s1">&#39;OPTCHK$B&quot;Option #&quot; is negated if option needs attenti&amp;</span>
<span class="s1">     &amp;on.$N&quot;Option 0&quot; is for space not associated with a specific option&amp;</span>
<span class="s1">     &amp;.$N&quot;First Loc.&quot; is negated if user di&#39;</span><span class="p">,</span><span class="s1">&#39;d not set value.$NSpace av&amp;</span>
<span class="s1">     &amp;ail. = $I; all options must have first loc. &gt; $I$EOption #$HFirst$&amp;</span>
<span class="s1">     &amp; Loc.$HLast Loc.$EFrom subprogram/argument: $BSpace for ETEXT.$E&#39;</span><span class="o">/</span>
<span class="c">!</span>
<span class="c">!                      1 2 3      4       5  6       7      8       9</span>
      <span class="k">data </span><span class="n">MACT</span> <span class="o">/</span> <span class="n">MEEMES</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LTXTAD</span><span class="p">,</span> <span class="n">MEIDAT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">MENTXT</span><span class="p">,</span><span class="n">LTXTAB</span><span class="p">,</span> <span class="n">METEXT</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">MEIMAT</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">LTXTAC</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">MERET</span> <span class="o">/</span>
<span class="c">!            10    13     14 15     16</span>
      <span class="k">data </span><span class="n">NERBAD</span> <span class="o">/</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span> <span class="o">/</span>
<span class="c">!</span>
<span class="c">! *************************** Start of Executable Code *****************</span>
<span class="c">!</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">=</span><span class="n">MERET</span>
      <span class="n">I</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">-</span> <span class="mi">4</span>
         <span class="n">MACT</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="n">MECONT</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">ERRBAD</span> <span class="o">=</span> <span class="n">NERBAD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">NERBAD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
      <span class="n">LAST</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">KEX</span> <span class="o">=</span> <span class="n">LAST</span>
   <span class="mi">20</span> <span class="n">LNEG</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">do </span><span class="mi">100</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">LAST</span><span class="p">,</span> <span class="mi">3</span>
<span class="c">!       Loop to sort on the low indices -- Inefficient algorithm to keep</span>
<span class="c">!       code short -- LAST should never be very big.</span>
         <span class="n">MI</span> <span class="o">=</span> <span class="n">I</span>
         <span class="n">MV</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
         <span class="k">do </span><span class="mi">50</span> <span class="n">L</span> <span class="o">=</span> <span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">LAST</span><span class="p">,</span> <span class="mi">3</span>
<span class="c">!                                    Find mimimum from here down.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MV</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">MI</span> <span class="o">=</span> <span class="n">L</span>
               <span class="n">MV</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">   </span><span class="mi">50</span>    <span class="k">continue</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">MI</span> <span class="o">/=</span> <span class="n">I</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                                   Interchange to get low at top.</span>
            <span class="k">do </span><span class="mi">70</span> <span class="n">L</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
               <span class="n">N</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="n">L</span><span class="p">)</span>
               <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="n">L</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">MI</span><span class="o">+</span><span class="n">L</span><span class="p">)</span>
               <span class="n">INTCHK</span><span class="p">(</span><span class="n">MI</span><span class="o">+</span><span class="n">L</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
   <span class="mi">70</span>       <span class="k">continue</span>
<span class="k">         end if</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">MV</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                Save loc. of last entry that needs space to be found.</span>
            <span class="n">LNEG</span> <span class="o">=</span> <span class="n">I</span>
         <span class="k">else if</span> <span class="p">(</span><span class="n">LNEG</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!        Entry I and previous entries are in their correct sorted order.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1000000</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2000000</span>
                  <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!                            Save INTCHK index defining allocated space.</span>
                  <span class="n">KEX</span> <span class="o">=</span> <span class="n">KEX</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="n">INTCHK</span><span class="p">(</span><span class="n">KEX</span><span class="p">)</span> <span class="o">=</span> <span class="n">I</span> <span class="o">-</span> <span class="mi">1</span>
               <span class="k">else</span>
<span class="c">!                   Error -- Got request for a negative amount of space.</span>
                  <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ERRBAD</span>
                  <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
               <span class="k">end if</span>
<span class="k">            end if</span>
<span class="c">!                Save final location used by the option.</span>
            <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="c">!                                           Error -- options overlap.</span>
               <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
               <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ERRBAD</span>
            <span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">  </span><span class="mi">100</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">LNEG</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!     Find spaces that need to be allocated, starting with the smallest.</span>
         <span class="n">ISTRT</span> <span class="o">=</span> <span class="n">LNEG</span>
         <span class="n">I</span> <span class="o">=</span> <span class="n">LNEG</span>
  <span class="mi">120</span>    <span class="n">LWANT</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="p">)</span>
         <span class="n">LOPT</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="n">LNEG</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                         Make fake entry to get started.</span>
            <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">         do </span><span class="mi">140</span> <span class="n">ISTRT</span> <span class="o">=</span> <span class="n">ISTRT</span><span class="p">,</span> <span class="n">LAST</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span>
            <span class="k">if</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="n">LWANT</span> <span class="o">&lt;</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">ISTRT</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span>   <span class="p">&amp;</span>
     <span class="p">&amp;</span>         <span class="n">go</span> <span class="n">to</span> <span class="mi">150</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">ISTRT</span> <span class="o">+</span> <span class="mi">3</span>
  <span class="mi">140</span>    <span class="k">continue</span>
<span class="k">  </span><span class="mi">150</span>    <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LOPT</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">LOPT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               if</span> <span class="p">(</span><span class="n">IOPT</span><span class="p">(</span><span class="n">LOPT</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">IOPT</span><span class="p">(</span><span class="n">LOPT</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="p">)</span>
                  <span class="n">go</span> <span class="n">to</span> <span class="mi">160</span>
               <span class="k">end if</span>
<span class="k">            end if</span>
<span class="c">!                     Error -- IOPT not expecting starting loc.</span>
            <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ERRBAD</span>
         <span class="k">end if</span>
<span class="k">  </span><span class="mi">160</span>    <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LWANT</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LNEG</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2000000</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LNEG</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">20</span>
         <span class="n">I</span> <span class="o">=</span> <span class="n">LNEG</span>
         <span class="n">LNEG</span> <span class="o">=</span> <span class="n">LNEG</span> <span class="o">-</span> <span class="mi">3</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LAST</span> <span class="o">/=</span> <span class="n">KEX</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">KEX</span><span class="p">)</span> <span class="o">==</span> <span class="n">LAST</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                     </span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                     <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
                  <span class="k">end if</span>
<span class="k">               end if</span>
<span class="k">            end if</span>
<span class="k">         end if</span>
<span class="k">         </span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
         <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ERRBAD</span>
      <span class="k">end if</span>
<span class="k">  </span><span class="mi">180</span> <span class="k">if</span> <span class="p">(</span><span class="n">LAST</span> <span class="o">/=</span> <span class="n">KEX</span><span class="p">)</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span> <span class="o">=</span> <span class="n">KEX</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  </span><span class="mi">190</span>    <span class="k">if</span> <span class="p">(</span><span class="n">LAST</span> <span class="o">/=</span> <span class="n">KEX</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            do </span><span class="mi">200</span> <span class="n">I</span> <span class="o">=</span> <span class="n">LAST</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">KEX</span><span class="p">)</span>
               <span class="n">INTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="mi">200</span>       <span class="k">continue</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">KEX</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">210</span>
            <span class="n">KEX</span> <span class="o">=</span> <span class="o">-</span><span class="n">KEX</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">MACT</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">LAST</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
         <span class="n">MTXTAA</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">LTXTEE</span><span class="p">:</span><span class="n">LTXEND</span><span class="p">)</span><span class="o">=</span><span class="n">ETEXT</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span>
         <span class="k">call </span><span class="n">MESS</span><span class="p">(</span><span class="n">MACT</span><span class="p">,</span> <span class="n">MTXTAA</span><span class="p">,</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">LAST</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LAST</span> <span class="o">/=</span> <span class="n">KEX</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">190</span>
      <span class="k">end if</span>
<span class="k">  </span><span class="mi">210</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">LAST</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">return</span>
<span class="k">    end subroutine </span><span class="n">optchk</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> diva was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>