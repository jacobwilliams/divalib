<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Edition of DIVA">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>DZERO &ndash; diva</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">diva </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/diva_module.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/diva_module.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>DZERO
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.4% of total for procedures.">259 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/diva_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/diva_module.f90.html'>diva_module.f90</a></li>
    
     <li><a href='../module/diva_module.html'>diva_module</a></li>
    
  
     <li class="active">DZERO</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dzero.html#src">DZERO</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine DZERO(X1, F1, X2, F2, MODE, TOL)
    
    
   
</h2>
    
  


    
    <p>SUBROUTINE TO FIND A BOUNDED ZERO</p>
<p>analysis and coding by Fred T.Krogh at the Jet Propulsion
 Laboratory, Pasadena, Calif.  April 25, 1972.
 Modified for portability, April 1984 by Krogh.
 Algorithmic changes, vars. added to save stmt., Sept. 1987 by Krogh</p>
<p>Parameters in the calling sequence are defined as follows:</p>
<p>X1  = independent variable
  F1  = dependent variable --  initially   F1=F(X1).
        When MODE=1 (or 5) the user is to compute F(X1) given X1
  X2  = second value of independent variable
  F2  = F(X2) on the initial entry.  When MODE = 2-4, F2=F(X2) and
        F1<em>F2 &lt;= 0.
  MODE  is a parameter used for communication between this
        subroutine and the user. (The user should set MODE
        only to initialize it to 0 before the first call)
      =1  compute F(X1) and call $ZERO
      =2  F(X1) is approximately 0, the iteration is finished
          and the error criterion is satisfied.
      =3  same as MODE=2, except the error criterion can
          not be satisfied.
      =4  apparently the function has a discontinuity
          between X1 and X2 -- No zero can be found
      =5  F1</em>F2 was greater than zero on the first call, and an attempt
          to bound the zero on both sides have failed.
      =6  fatal error -- $ZERO was called after mode was set &gt;=2.
          If $ZERO is called again, the program will be stopped.
          (Unless MODE is set to 0)
      &lt;0  If MODE is set &lt;0 and $ZERO is called, no action is taken
          except that print is turned on for -MODE calls to $ZERO.
          This print gives all values of X and F used in the iteration.
  TOL    is the error tolerance
     TOL&gt;0  Iterate until values of X1 and X2 are known
              for which abs(X1-X2) &lt;= tol and F1*F2 &lt;= 0.
     TOL&lt;0  Iterate until a value of X1 is found for which
              abs(F1) &lt;= abs(TOL).
     TOL  = 0  Iterate until the zero is determined as
              precisely as possible.  MODE = 3 is impossible
              in this case.</p>
<p>Usage is as follows (of course, variations are possible.)
         Somehow one has available X1, F1, X2, and F2 such
         that F1 = F(X1), F2 = F(X2) and F1<em>F2 &lt;= 0.
         In addition, one should assign a value to TOL.
     MODE = 0
</em><strong>  In the statement below, $ is replaced by an 'S' for single
</strong>*  precision and a 'D' for double.
 XXX call $ZERO(X1,F1,X2,F2,MODE,TOL)
     go to  (N1,N2,N3,N4,N5,N6), MODE
  N1 COMPUTE  F1=F(X1)
     go to XXX</p>
<p>N4 continue
  N5 continue
  N6 stop
  N3 If you want to -- print results to note that error
                       is too big.
  N2 zero is found, do whatever you want to with it.</p>
<p>End of comments explaining usage.</p>
<p><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>* Usage of internal variables </em></strong><strong><em>*</em></strong><strong>*</strong>*</p>
<p>C0     Parameter = 0.
 C1     Parameter = 1.
 C1P25  Parameter = 1.25
 C2     Parameter = 2.
 C4     Parameter = 4.
 CP01   Parameter = 0.01
 CP125  Parameter = 1.25
 CP25   Parameter = 0.25
 CP5    Parameter = 0.5
 CP75   Parameter = 0.75
 CP99   Parameter = 0.99
 D1MACH Gets constants associated with floating point arithmetic.
 DFDXXX = (XXMXL/FFMFL) * (est. deriv. of f w.r.t. x at x = XX).  All
   derivatives are base on a second degree polynonial that interpolates
   the last three points generated.
 DFDXXX = (XXMXO/FFMFL) * (est. deriv. of f w.r.t. x at x = X0).
 DIV    If artificial subdivision of the interval is used, determines
   the amount of the sudivision.  (-XXMXOO * DIV / (1. + DIV))
 DMESS  Prints error messages.
 DXDFFF = (FFMFL/XXMXL) * (est. deriv. of x w.r.t. f at f = FF).
 DXDFFO = (FFMFO/XXMXL) * (est. deriv. of x w.r.t. f at f = FO).
 F1     (formal arg.) The last value of F computed, on return the value
   of F(X1).
 F2     (formal arg.) The other initial value provided for F.  Set to
   the value of F(X2) on returns.
 FDAT   Temporary storage for floating point values for messages.
 FF     Value of F1 after F is computed.
 FFDFO  FF / FO
 FFMFB  FFMFL + FLMFB = FF - value of FF 2 iterations back.
 FFMFL  FF - FL
 FL     Value of FF from the previous iteration.
 FLMFB  Value of FFMFL from the previous iteration
 FO     F(XO)
 I      Comments for LCHNG define how I is set.
 IDAT   Temporary storage for integer values for messages.
 J      This is 1 if FF &lt;= 0., and is 2 if FF &gt; 0.
 KNKP   KNKP(J) (see J above) is decreased by 3 when there are signs of
   decent convergence.  It is counted up when convergence is slow.
 KS     =-1  initially,
        = 0  whenever F changes sign, otherwise
        = number of times the sign of F has remained the same
 KTYP   = 1 if interpolation was used to get the last iterate, = 0 if
   an artificial subdivision was used.
 LCHG  the J-th continuation in the data statement for LCHG below gives
 new states for the case when the state number is J-1.  State 0 is the
 initial state.  The I-th entry on a row gives the state for case on I
 as follows:  (TP is the ratio (new f) / (last f of same sign)
    I = 1   TP &lt; 0.01
    I = 2   .01 &lt;= TP &lt; 1
    I = 3   TP = 1
    I = 4   1 &lt; TP &lt;= 4
    I = 5   TP &gt; 4.
 States are as follows:
    0   initial state, or big increase, or small increase in state 0
    1   after big decrease, perhaps followed by small decreases
    2   after one or more small decreases from state 0
    3   one or more small increases from state 2
    4   one or more small decreases from state 3
    5   decision made that noise is a problem on this side of zero.
 LINIT  - the maximum number of iterations that can be taken with out
   getting a sign change in F.
 LMODE  The value of MODE the last time in this routine.
 LNLP
 LTXTxx Names of this form are used in setting up data statements for
   error messages.  These names are generated automatically by PMESS,
   the program that makes up these messages.
 MACT   This array difines the actions to be taken by the error message
   program.  See comments in MESS for details.  MODE is set to MACT(3)
   on exit.
 MACT1  As for MACT except used for the diagnostic print.
 MExxxx Parameters defining constants used for interaction with the
   error message program MESS.  See comments there for definitions.
 MLOC   Contains locations in MTXTAA for error messages.
 MODE   (formal) See comments above.
 MTXTAA Text for error messages.
 MTXTAB Text for diagnostic message.
 MTXTAC Text for diagnostic message.
 NP     If &gt; 0, gives number of iterations till diagnostic print stops.
 QFM
 QXM
 RND    Largest relative difference between succesive floating point
   numbers.
 SMALL  .5 / (RND * largest floating point number)
 TOL    (Formal) See description above.
 TOLX   Actually tolerance required for accuracy in X.  Usually =
   max(TOL, XRND).  It can be cut by a factor of 2 for use in setting
   bounds on an acceptable interval.
 TP     Ordinarily the ratio (FF / prev. FF of the same sign.
 TP1    Used for temporary storage.
 X1     (Formal) Value of x where F is to be computed, and value
   returned for the zero after convergence.
 X2     (Formal) Initially other value of x where F is given.  After
   convergence gives the other closest x which gives an F of opposite
   sign from that given by x1.
 XL     Value of XX from the previous iteration.
 XLMXB  Value of XXMXL from the previous iteration.
 XO     Value of x on opposite side of the zero from the current x.
 XRND   Best accuracy that one could hope for based on the finite
   precision of floating point numbers.
 XX     Current x, the last value of X1 where F was computed.
 XXMXL  XX - XL
 XXMXO  XX - XO = length of interval in which 0 lies.
 XXMXOL Value of XXMXO from a previous iteration.</p>
<h3>History</h3>
<ul>
<li>2010-04-14 DZERO  Krogh  No discontinuity message if |F1-F2| small.</li>
<li>2010-04-12 DZERO  Krogh  Fixed KNKP to get discontinuity diagnostic.</li>
<li>2010-02-20 DZERO  Krogh  $G =&gt; $F for print out of iterations</li>
<li>2008-03-01 DZERO  Krogh  Minor change in diagnostic print.</li>
<li>2000-12-01 DZERO  Krogh  Removed unused variable C1P01.</li>
<li>1998-11-01 DZERO  Krogh  Set so errors stop less easily.</li>
<li>1998-11-01 DZERO  Krogh  For "mangle", INDIC replaced with MACT(3).</li>
<li>1996-03-30 DZERO  Krogh  Added external statement.</li>
<li>1995-11-09 DZERO  Krogh  Fixed so char. data at col. 72 is not ' '.</li>
<li>1994-11-11 DZERO  Krogh  Declared all vars.</li>
<li>1994-10-20 DZERO  Krogh  Changes to use M77CON</li>
<li>1994-09-08 DZERO  Krogh  Added CHGTYP code.</li>
<li>1993-04-27 DZERO  Krogh  Additions for Conversion to C.</li>
<li>1993-04-13 DZERO  Krogh  Minor change for new MESS.</li>
<li>1992-04-08 DZERO  Krogh  Unused label 400 removed.</li>
<li>1992-01-09 DZERO  Krogh  Moved calc. of XXMXO up (for error msg.)</li>
<li>1991-11-26 DZERO  Krogh  Converted to new error processor.</li>
<li>1988-08-14 DZERO  Krogh  Labels runumbered.</li>
<li>1988-03-07 DZERO  Krogh  Initial code.</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x1"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f1"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x2"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f2"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mode"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>MODE</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tol~2"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>TOL</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dzero~~CallsGraph Pages: 1 -->
<svg id="procdzeroCallsGraph" width="242pt" height="32pt"
 viewBox="0.00 0.00 242.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dzero~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dzero~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 238,-28 238,4 -4,4"/>
<!-- proc~dzero -->
<g id="proc~~dzero~~CallsGraph_node1" class="node">
<title>proc~dzero</title>
<polygon fill="none" stroke="black" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">DZERO</text>
</g>
<!-- proc~dmess -->
<g id="proc~~dzero~~CallsGraph_node2" class="node">
<title>proc~dmess</title>
<g id="a_proc~~dzero~~CallsGraph_node2"><a xlink:href=".././proc/dmess.html" xlink:title="DMESS">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DMESS</text>
</a>
</g>
</g>
<!-- proc~dzero&#45;&gt;proc~dmess -->
<g id="proc~~dzero~~CallsGraph_edge1" class="edge">
<title>proc~dzero&#45;&gt;proc~dmess</title>
<path fill="none" stroke="#000000" d="M54.4,-12C62.39,-12 71.31,-12 79.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-15.5 89.92,-12 79.92,-8.5 79.92,-15.5"/>
</g>
<!-- proc~messfi -->
<g id="proc~~dzero~~CallsGraph_node3" class="node">
<title>proc~messfi</title>
<g id="a_proc~~dzero~~CallsGraph_node3"><a xlink:href=".././proc/messfi.html" xlink:title="MESSFI">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 180,-24 180,0 234,0 234,-24"/>
<text text-anchor="middle" x="207" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFI</text>
</a>
</g>
</g>
<!-- proc~dmess&#45;&gt;proc~messfi -->
<g id="proc~~dzero~~CallsGraph_edge2" class="edge">
<title>proc~dmess&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M144.4,-12C152.39,-12 161.31,-12 169.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-15.5 179.92,-12 169.92,-8.5 169.92,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dzero.html#src">DZERO</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">DZERO</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">MODE</span><span class="p">,</span> <span class="n">TOL</span><span class="p">)</span>

      <span class="kt">integer </span><span class="n">MODE</span>
      <span class="kt">double precision </span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">TOL</span>

      <span class="c">!external D1MACH</span>
      <span class="kt">integer </span><span class="n">LINIT</span><span class="p">,</span> <span class="n">KS</span><span class="p">,</span> <span class="n">KTYP</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">I</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">LINIT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
      <span class="kt">integer </span><span class="n">KNKP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">LCHG</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">LMODE</span><span class="p">,</span> <span class="n">LNLP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">NP</span>
      <span class="kt">double precision </span><span class="n">XX</span><span class="p">,</span> <span class="n">XO</span><span class="p">,</span> <span class="n">XL</span><span class="p">,</span> <span class="n">FF</span><span class="p">,</span> <span class="n">FO</span><span class="p">,</span> <span class="n">FL</span><span class="p">,</span> <span class="n">FFDFO</span>
      <span class="kt">double precision </span><span class="n">DIV</span><span class="p">,</span> <span class="n">QFM</span><span class="p">,</span> <span class="n">QXM</span><span class="p">,</span> <span class="n">TP</span><span class="p">,</span> <span class="n">TP1</span><span class="p">,</span> <span class="n">XXMXO</span><span class="p">,</span> <span class="n">XXMXOL</span>
      <span class="kt">double precision </span><span class="n">RND</span><span class="p">,</span> <span class="n">XRND</span><span class="p">,</span> <span class="n">SMALL</span><span class="p">,</span> <span class="n">TOLX</span>
      <span class="kt">double precision </span><span class="n">XXMXL</span><span class="p">,</span> <span class="n">XLMXB</span><span class="p">,</span> <span class="n">FFMFL</span><span class="p">,</span> <span class="n">FFMFB</span><span class="p">,</span> <span class="n">FLMFB</span>
      <span class="kt">double precision </span><span class="n">DXDFFF</span><span class="p">,</span> <span class="n">DXDFFO</span><span class="p">,</span> <span class="n">DFDXXX</span><span class="p">,</span> <span class="n">DFDXXO</span>
      <span class="kt">double precision </span><span class="n">C0</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">CP125</span><span class="p">,</span> <span class="n">CP25</span><span class="p">,</span> <span class="n">CP5</span><span class="p">,</span> <span class="n">CP75</span><span class="p">,</span> <span class="n">C1P25</span>
      <span class="kt">double precision </span><span class="n">C8</span><span class="p">,</span> <span class="n">CP01</span><span class="p">,</span> <span class="n">CP99</span><span class="p">,</span> <span class="n">CP001</span><span class="p">,</span> <span class="n">C1P031</span>
      <span class="c">!double precision D1MACH</span>
<span class="c">!</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C0</span> <span class="o">=</span> <span class="mf">0.D0</span><span class="p">,</span> <span class="n">C1</span> <span class="o">=</span> <span class="mf">1.D0</span><span class="p">,</span> <span class="n">C2</span> <span class="o">=</span> <span class="mf">2.D0</span><span class="p">,</span> <span class="n">C4</span> <span class="o">=</span> <span class="mf">4.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C8</span> <span class="o">=</span> <span class="mf">8.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP125</span> <span class="o">=</span> <span class="mf">0.125D0</span><span class="p">,</span> <span class="n">CP25</span> <span class="o">=</span> <span class="mf">0.25D0</span><span class="p">,</span> <span class="n">CP75</span> <span class="o">=</span> <span class="mf">0.75D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP5</span> <span class="o">=</span> <span class="mf">0.5D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1P25</span> <span class="o">=</span> <span class="mf">1.25D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP01</span> <span class="o">=</span> <span class="mf">0.01D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP001</span> <span class="o">=</span> <span class="mf">0.001D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP99</span> <span class="o">=</span> <span class="mf">0.99D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1P031</span> <span class="o">=</span> <span class="mf">1.03125D0</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!                      Declarations for error message processing.</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">MERET</span><span class="p">,</span> <span class="n">MEEMES</span><span class="p">,</span> <span class="n">METEXT</span>
      <span class="kt">double precision </span><span class="n">FDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
      <span class="kt">integer </span><span class="n">MACT</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">MACT1</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">MLOC</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">save </span><span class="n">DIV</span><span class="p">,</span> <span class="n">FL</span><span class="p">,</span> <span class="n">FLMFB</span><span class="p">,</span> <span class="n">FO</span><span class="p">,</span> <span class="n">KNKP</span><span class="p">,</span> <span class="n">KS</span><span class="p">,</span> <span class="n">KTYP</span><span class="p">,</span> <span class="n">LCHG</span><span class="p">,</span> <span class="n">LMODE</span><span class="p">,</span>             <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">LNLP</span><span class="p">,</span> <span class="n">MACT</span><span class="p">,</span> <span class="n">NP</span><span class="p">,</span> <span class="n">RND</span><span class="p">,</span> <span class="n">SMALL</span><span class="p">,</span> <span class="n">XL</span><span class="p">,</span> <span class="n">XLMXB</span><span class="p">,</span> <span class="n">XO</span><span class="p">,</span> <span class="n">XX</span><span class="p">,</span> <span class="n">XXMXOL</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MERET</span>  <span class="o">=</span><span class="mi">51</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MEEMES</span> <span class="o">=</span><span class="mi">52</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">METEXT</span> <span class="o">=</span><span class="mi">53</span><span class="p">)</span>
<span class="c">! ********* Error message text ***************</span>
<span class="c">![Last 2 letters of Param. name]  [Text generating message.]</span>
<span class="c">!AA DZERO$B</span>
<span class="c">!AB Best bound for zero is [$F, $F], but tolerance is $F.$E</span>
<span class="c">!AC Apparent discontinuity in function near X = $F.$E</span>
<span class="c">!AD Can not find a sign change: X1=$F, X2=$F, F1=$F, F2=$F$E</span>
<span class="c">!AE Called with MODE = $I.$E</span>
<span class="c">!   $</span>
<span class="c">!AF In DZERO -- X1=$F F1=$F KTYP=$I DIV=$G KS=$I$E</span>
<span class="c">!   $</span>
<span class="c">!AG             X2=$F F2=$F$E</span>
      <span class="kt">integer </span><span class="n">LTXTAA</span><span class="p">,</span><span class="n">LTXTAB</span><span class="p">,</span><span class="n">LTXTAC</span><span class="p">,</span><span class="n">LTXTAD</span><span class="p">,</span><span class="n">LTXTAE</span><span class="p">,</span><span class="n">LTXTAF</span><span class="p">,</span><span class="n">LTXTAG</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">LTXTAA</span><span class="o">=</span>  <span class="mi">1</span><span class="p">,</span><span class="n">LTXTAB</span><span class="o">=</span>  <span class="mi">8</span><span class="p">,</span><span class="n">LTXTAC</span><span class="o">=</span> <span class="mi">63</span><span class="p">,</span><span class="n">LTXTAD</span><span class="o">=</span><span class="mi">112</span><span class="p">,</span><span class="n">LTXTAE</span><span class="o">=</span><span class="mi">169</span><span class="p">,&amp;</span>
     <span class="p">&amp;</span> <span class="n">LTXTAF</span><span class="o">=</span>  <span class="mi">1</span><span class="p">,</span><span class="n">LTXTAG</span><span class="o">=</span>  <span class="mi">1</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">MTXTAA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">193</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">MTXTAB</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">MTXTAC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">25</span><span class="p">)</span>
      <span class="k">data </span><span class="n">MTXTAA</span><span class="o">/</span><span class="s1">&#39;DZERO$BBest bound for zero is [$F, $F], but tolerance&amp;</span>
<span class="s1">     &amp; is $F.$EApparent discontinuity in function near X = $F.$ECan not$&amp;</span>
<span class="s1">     &amp; find a sign change: X1=$F, X2=$F, F1=$F, F2=$F$ECalled with MODE$&amp;</span>
<span class="s1">     &amp; = $I.$E&#39;</span><span class="o">/</span>
      <span class="k">data </span><span class="n">MTXTAB</span><span class="o">/</span><span class="s1">&#39;In DZERO -- X1=$F F1=$F KTYP=$I DIV=$F KS=$I$E&#39;</span><span class="o">/</span>
      <span class="k">data </span><span class="n">MTXTAC</span><span class="o">/</span><span class="s1">&#39;            X2=$F F2=$F$E&#39;</span><span class="o">/</span>
<span class="c">! **** End of automatically generated text</span>
<span class="c">!                      1  2  3  4      5</span>
      <span class="k">data </span><span class="n">MACT</span> <span class="o">/</span> <span class="n">MEEMES</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MERET</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">MACT1</span> <span class="o">/</span> <span class="n">METEXT</span><span class="p">,</span> <span class="n">MERET</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">MLOC</span> <span class="o">/</span> <span class="n">LTXTAB</span><span class="p">,</span> <span class="n">LTXTAC</span><span class="p">,</span> <span class="n">LTXTAD</span><span class="p">,</span> <span class="n">LTXTAE</span> <span class="o">/</span>
<span class="c">!</span>
      <span class="k">data </span><span class="n">RND</span> <span class="o">/</span> <span class="n">C0</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">KS</span><span class="p">,</span> <span class="n">KTYP</span><span class="p">,</span> <span class="n">LMODE</span><span class="p">,</span> <span class="n">DIV</span> <span class="o">/</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">C0</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">LCHG</span> <span class="o">/</span>                                                       <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                                                 <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                                                 <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                                                 <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                                                 <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                                                 <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">NP</span> <span class="o">/</span> <span class="mi">0</span> <span class="o">/</span>

<span class="c">!</span>
<span class="c">! INITIALIZE</span>
<span class="c">!</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">MODE</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">NP</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">MODE</span>
         <span class="k">return</span>
<span class="k">      end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">NP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">NP</span> <span class="o">=</span> <span class="n">NP</span> <span class="o">-</span> <span class="mi">1</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">X1</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">F1</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DIV</span>
         <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KTYP</span>
         <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">KS</span>
         <span class="k">call </span><span class="n">DMESS</span><span class="p">(</span><span class="n">MACT1</span><span class="p">,</span> <span class="n">MTXTAB</span><span class="p">,</span> <span class="n">IDAT</span><span class="p">,</span> <span class="n">FDAT</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">MODE</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">LMODE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">450</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">X2</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">F2</span>
         <span class="k">call </span><span class="n">DMESS</span><span class="p">(</span><span class="n">MACT1</span><span class="p">,</span> <span class="n">MTXTAC</span><span class="p">,</span> <span class="n">IDAT</span><span class="p">,</span> <span class="n">FDAT</span><span class="p">)</span>
      <span class="k">else if</span> <span class="p">(</span><span class="n">MODE</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">LMODE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">450</span>
      <span class="k">end if</span>
<span class="c">!</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">RND</span> <span class="o">==</span> <span class="n">C0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">RND</span> <span class="o">=</span> <span class="n">D1MACH</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
         <span class="n">SMALL</span> <span class="o">=</span> <span class="n">CP5</span> <span class="o">/</span> <span class="p">(</span><span class="n">RND</span> <span class="o">*</span> <span class="n">D1MACH</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">XL</span> <span class="o">=</span> <span class="n">X2</span>
      <span class="n">FL</span> <span class="o">=</span> <span class="n">F2</span>
   <span class="mi">30</span> <span class="n">TP</span> <span class="o">=</span> <span class="n">C1</span>
      <span class="n">MODE</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="n">XXMXOL</span> <span class="o">=</span> <span class="n">C0</span>
      <span class="n">KNKP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KNKP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">LNLP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">LNLP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KS</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="n">XX</span> <span class="o">=</span> <span class="n">X1</span>
      <span class="n">FF</span> <span class="o">=</span> <span class="n">F1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">FL</span><span class="p">)</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span>
   <span class="mi">40</span> <span class="k">if</span> <span class="p">(</span><span class="n">FF</span><span class="p">)</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">100</span>
   <span class="mi">50</span> <span class="k">if</span> <span class="p">(</span><span class="n">FF</span><span class="p">)</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">60</span>
   <span class="mi">60</span> <span class="n">LMODE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c">!             Take care of points on same side of zero.</span>
   <span class="mi">70</span> <span class="n">FF</span> <span class="o">=</span> <span class="n">F1</span>
      <span class="n">XX</span> <span class="o">=</span> <span class="n">X1</span>
      <span class="n">TP</span> <span class="o">=</span> <span class="n">FF</span> <span class="o">/</span> <span class="n">FL</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&lt;</span> <span class="n">C0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">30</span>
      <span class="n">LMODE</span> <span class="o">=</span> <span class="n">LMODE</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LMODE</span> <span class="o">&lt;</span> <span class="n">LINIT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XL</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">FF</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">FL</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">250</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&gt;</span> <span class="n">C1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">FF</span> <span class="o">=</span> <span class="n">FL</span>
         <span class="n">XX</span> <span class="o">=</span> <span class="n">XL</span>
         <span class="n">FL</span> <span class="o">=</span> <span class="n">F1</span>
         <span class="n">XL</span> <span class="o">=</span> <span class="n">X1</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">FF</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">C8</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">FL</span><span class="o">-</span><span class="n">FF</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         </span><span class="n">TP</span> <span class="o">=</span> <span class="n">C8</span>
      <span class="k">else</span>
<span class="k">         </span><span class="n">TP</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">CP25</span><span class="o">*</span><span class="nb">dble</span><span class="p">(</span><span class="n">LMODE</span><span class="p">),</span> <span class="n">FF</span> <span class="o">/</span> <span class="p">(</span><span class="n">FL</span> <span class="o">-</span> <span class="n">FF</span><span class="p">))</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">FL</span> <span class="o">=</span> <span class="n">FF</span>
      <span class="n">XO</span> <span class="o">=</span> <span class="n">XL</span>
      <span class="n">XL</span> <span class="o">=</span> <span class="n">XX</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">XX</span> <span class="o">==</span> <span class="n">XO</span><span class="p">)</span> <span class="n">XO</span> <span class="o">=</span> <span class="n">C1P031</span> <span class="o">*</span> <span class="n">XX</span> <span class="o">+</span> <span class="nb">sign</span><span class="p">(</span><span class="n">CP001</span><span class="p">,</span> <span class="n">XX</span><span class="p">)</span>
      <span class="n">XX</span> <span class="o">=</span> <span class="n">XX</span> <span class="o">+</span> <span class="n">TP</span> <span class="o">*</span> <span class="p">(</span><span class="n">XX</span> <span class="o">-</span> <span class="n">XO</span><span class="p">)</span>
      <span class="n">X1</span> <span class="o">=</span> <span class="n">XX</span>
      <span class="n">MODE</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">return</span>
<span class="c">!</span>
   <span class="mi">75</span> <span class="n">X1</span> <span class="o">=</span> <span class="n">XL</span>
      <span class="n">F1</span> <span class="o">=</span> <span class="n">FL</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">250</span>
<span class="c">! END OF INITIALIZATION</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">! ENTRY AFTER COMPUTING F FOR THE LAST ITERATE</span>
   <span class="mi">80</span> <span class="n">FF</span> <span class="o">=</span> <span class="n">F1</span>
      <span class="n">TP</span> <span class="o">=</span> <span class="n">FF</span> <span class="o">/</span> <span class="n">FL</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span><span class="p">)</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">110</span>
   <span class="mi">90</span> <span class="n">TP</span> <span class="o">=</span> <span class="n">FF</span> <span class="o">/</span> <span class="n">FO</span>
      <span class="n">KS</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="mi">100</span> <span class="n">FO</span> <span class="o">=</span> <span class="n">FL</span>
      <span class="n">XO</span> <span class="o">=</span> <span class="n">XL</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
  <span class="mi">110</span> <span class="n">KS</span> <span class="o">=</span> <span class="n">KS</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="mi">120</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">FF</span> <span class="o">&gt;</span> <span class="n">C0</span><span class="p">)</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">-</span> <span class="n">C1</span><span class="p">)</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">130</span>
  <span class="mi">130</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&gt;</span> <span class="n">C4</span><span class="p">)</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">5</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">160</span>
  <span class="mi">140</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">3</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">160</span>
  <span class="mi">150</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&lt;</span> <span class="n">CP01</span><span class="p">)</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&lt;</span> <span class="n">CP99</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">170</span>
  <span class="mi">160</span> <span class="n">KNKP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">KNKP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
  <span class="mi">170</span> <span class="n">KNKP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="mi">180</span> <span class="n">XXMXO</span> <span class="o">=</span> <span class="n">XX</span> <span class="o">-</span> <span class="n">XO</span>
      <span class="n">LNLP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">LCHG</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">LNLP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LNLP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">LNLP</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">J</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">210</span>
      <span class="k">end if</span>
<span class="c">! XXMXO GIVES THE LENGTH OF THE INTERVAL INSIDE WHICH</span>
<span class="c">! THE ZERO IS KNOWN TO LIE.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">C2</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">XXMXO</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">XXMXOL</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         </span><span class="n">KNKP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">KNKP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">XXMXOL</span> <span class="o">=</span> <span class="n">XXMXO</span>
      <span class="n">XRND</span> <span class="o">=</span> <span class="n">RND</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">XO</span><span class="p">)</span> <span class="o">+</span> <span class="n">SMALL</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">! TEST FOR CONVERGENCE</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TOL</span><span class="p">)</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span>
  <span class="mi">190</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">FF</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TOL</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">220</span>
  <span class="mi">200</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">TOLX</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">TOL</span><span class="p">,</span> <span class="n">XRND</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">XXMXO</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TOLX</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">310</span>
<span class="c">!</span>
<span class="c">! CONVERGENCE -- PREPARE FOR FINAL EXIT</span>
  <span class="mi">210</span> <span class="k">if</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">XXMXO</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TOL</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">TOL</span> <span class="o">/=</span> <span class="n">C0</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         </span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">TOL</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">XXMXO</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">FDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XO</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XO</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="c">! SET FINAL VALUES FOR X1,F1,X2,AND F2</span>
  <span class="mi">220</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">FF</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">FO</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">240</span>
      <span class="n">F1</span> <span class="o">=</span> <span class="n">FO</span>
      <span class="n">X1</span> <span class="o">=</span> <span class="n">XO</span>
  <span class="mi">230</span> <span class="n">FO</span> <span class="o">=</span> <span class="n">FF</span>
      <span class="n">XO</span> <span class="o">=</span> <span class="n">XX</span>
  <span class="mi">240</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">XO</span>
      <span class="n">F2</span> <span class="o">=</span> <span class="n">FO</span>
<span class="c">! TEST FOR DISCONTINUITY</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">KNKP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">KNKP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">F1</span> <span class="o">-</span> <span class="n">F2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">RND</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="mf">1.D0</span><span class="p">))</span> <span class="k">then</span>
<span class="k">          </span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span>
          <span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span>
        <span class="k">end if</span>
<span class="k">      end if</span>
<span class="k">  </span><span class="mi">250</span> <span class="n">MODE</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">430</span>
<span class="c">! END OF CODE FOR FINAL EXIT</span>
<span class="c">!</span>
<span class="c">! F NOT DECREASING (OR THE FIRST ITERATE)</span>
<span class="c">! PREPARE TO DIVIDE THE INTERVAL</span>
  <span class="mi">260</span> <span class="n">TP</span> <span class="o">=</span> <span class="n">C1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KS</span><span class="p">)</span> <span class="mi">370</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">270</span>
  <span class="mi">270</span> <span class="k">if</span> <span class="p">(</span><span class="n">KTYP</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">290</span>
  <span class="mi">280</span> <span class="n">DIV</span> <span class="o">=</span> <span class="n">C2</span>
  <span class="mi">290</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">DIV</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">DIV</span><span class="p">,</span> <span class="n">FFDFO</span><span class="p">)</span>
<span class="c">! KTYP=0 IF AND ONLY IF THE INTERVAL WAS DIVIDED (USING DIV)</span>
<span class="c">! ON THE LAST ITERATION</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KTYP</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">DIV</span> <span class="o">=</span> <span class="n">DIV</span> <span class="o">*</span> <span class="p">(</span><span class="n">C1P25</span> <span class="o">/</span> <span class="p">(</span><span class="n">C1P25</span> <span class="o">-</span> <span class="n">TP</span><span class="p">))</span>
<span class="c">! DIVIDE THE INTERVAL AS SPECIFIED BY DIV</span>
  <span class="mi">300</span> <span class="n">TP1</span> <span class="o">=</span> <span class="o">-</span><span class="n">XXMXO</span> <span class="o">*</span> <span class="p">(</span><span class="n">DIV</span><span class="o">/</span><span class="p">(</span><span class="n">DIV</span><span class="o">+</span><span class="n">C1</span><span class="p">))</span>
      <span class="n">KTYP</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
<span class="c">!</span>
  <span class="mi">310</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">XXMXL</span> <span class="o">=</span> <span class="n">XX</span> <span class="o">-</span> <span class="n">XL</span>
      <span class="n">FFMFL</span> <span class="o">=</span> <span class="n">FF</span> <span class="o">-</span> <span class="n">FL</span>
      <span class="n">FFDFO</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">FF</span> <span class="o">/</span> <span class="n">FO</span><span class="p">)</span>
      <span class="n">TOLX</span> <span class="o">=</span> <span class="n">CP5</span> <span class="o">*</span> <span class="n">TOLX</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&gt;=</span> <span class="n">C1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">260</span>
<span class="c">! DIVIDE THE INTERVAL IF F HAS HAD THE SAME SIGN FOR</span>
<span class="c">! FOUR OR MORE TIMES IN SUCCESSION</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KS</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">290</span>
  <span class="mi">320</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">FLMFB</span> <span class="o">==</span> <span class="n">C0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">340</span>
<span class="c">! BEGINNING OF CODE TO DETERMINE IF INVERSE QUADRATIC</span>
<span class="c">! INTERPOLATION IS TO BE USED.</span>
      <span class="n">FFMFB</span> <span class="o">=</span> <span class="n">FFMFL</span> <span class="o">+</span> <span class="n">FLMFB</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">FFMFB</span> <span class="o">==</span> <span class="n">C0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">330</span>
      <span class="n">QFM</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">-</span> <span class="p">(</span><span class="n">FFMFL</span> <span class="o">/</span> <span class="n">FLMFB</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">XLMXB</span> <span class="o">/</span> <span class="n">XXMXL</span><span class="p">)</span>
      <span class="n">QXM</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">-</span> <span class="p">(</span><span class="n">XXMXL</span> <span class="o">/</span> <span class="n">XLMXB</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">FLMFB</span> <span class="o">/</span> <span class="n">FFMFL</span><span class="p">)</span>
      <span class="n">DXDFFF</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">+</span> <span class="p">(</span><span class="n">FFMFL</span> <span class="o">/</span> <span class="n">FFMFB</span><span class="p">)</span> <span class="o">*</span> <span class="n">QFM</span>
      <span class="n">DXDFFO</span> <span class="o">=</span> <span class="n">DXDFFF</span> <span class="o">+</span> <span class="n">C2</span> <span class="o">*</span> <span class="p">((</span><span class="n">FO</span> <span class="o">-</span> <span class="n">FF</span><span class="p">)</span> <span class="o">/</span> <span class="n">FFMFB</span><span class="p">)</span> <span class="o">*</span> <span class="n">QFM</span>
      <span class="n">TP1</span> <span class="o">=</span> <span class="n">XXMXL</span> <span class="o">+</span> <span class="n">XLMXB</span>
      <span class="n">DFDXXX</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">+</span> <span class="p">(</span><span class="n">XXMXL</span> <span class="o">/</span> <span class="n">TP1</span><span class="p">)</span> <span class="o">*</span> <span class="n">QXM</span>
      <span class="n">DFDXXO</span> <span class="o">=</span> <span class="n">DFDXXX</span> <span class="o">+</span> <span class="n">C2</span> <span class="o">*</span> <span class="p">((</span><span class="n">XO</span> <span class="o">-</span> <span class="n">XX</span><span class="p">)</span> <span class="o">/</span> <span class="n">TP1</span><span class="p">)</span> <span class="o">*</span> <span class="n">QXM</span>
      <span class="n">TP1</span> <span class="o">=</span> <span class="n">DXDFFF</span> <span class="o">*</span> <span class="n">DFDXXX</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">TP1</span> <span class="o">&lt;=</span> <span class="n">CP25</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">TP1</span> <span class="o">&gt;=</span> <span class="n">C4</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">330</span>
      <span class="n">TP1</span> <span class="o">=</span> <span class="n">DXDFFO</span> <span class="o">*</span> <span class="n">DFDXXO</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">TP1</span> <span class="o">&gt;</span> <span class="n">CP25</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">TP1</span> <span class="o">&lt;</span> <span class="n">C4</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">380</span>
<span class="c">!</span>
<span class="c">! DERIVATIVES DO NOT MATCH WELL ENOUGH</span>
  <span class="mi">330</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">KS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">FFDFO</span> <span class="o">-</span> <span class="n">C1</span><span class="p">)</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">370</span><span class="p">,</span> <span class="mi">360</span>
  <span class="mi">340</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">((</span><span class="n">KTYP</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&gt;=</span> <span class="n">CP75</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">290</span>
      <span class="k">continue</span>
<span class="k">      </span><span class="n">TP</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">-</span> <span class="n">TP</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&lt;=</span> <span class="n">FFDFO</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">280</span>
      <span class="n">FFDFO</span> <span class="o">=</span> <span class="n">FFDFO</span> <span class="o">/</span> <span class="n">TP</span>
      <span class="n">DIV</span> <span class="o">=</span> <span class="n">CP125</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">290</span>
  <span class="mi">350</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">DIV</span> <span class="o">=</span> <span class="n">CP5</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">CP25</span><span class="p">,</span> <span class="n">FFDFO</span><span class="p">),</span> <span class="n">TP</span> <span class="o">/</span> <span class="p">(</span><span class="n">C1P25</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">TP</span><span class="p">,</span> <span class="n">C1</span><span class="p">)))</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">300</span>
  <span class="mi">360</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">DIV</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">C4</span><span class="p">,</span> <span class="n">CP5</span> <span class="o">*</span> <span class="n">FFDFO</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">300</span>
<span class="c">! INTERPOLATE WITH SECANT METHOD</span>
  <span class="mi">370</span> <span class="n">TP1</span> <span class="o">=</span> <span class="o">-</span><span class="n">XXMXL</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">390</span>
<span class="c">!</span>
<span class="c">! DERIVATIVES MATCH UP PRETTY WELL.</span>
  <span class="mi">380</span> <span class="k">continue</span>
<span class="c">! INTERPOLATE USING THE INVERSE QUADRATIC</span>
      <span class="n">TP1</span> <span class="o">=</span> <span class="n">XXMXL</span> <span class="o">*</span> <span class="p">(</span><span class="n">QFM</span> <span class="o">*</span> <span class="p">(</span><span class="n">FL</span> <span class="o">/</span> <span class="n">FFMFB</span><span class="p">)</span> <span class="o">-</span> <span class="n">C1</span><span class="p">)</span>
  <span class="mi">390</span> <span class="n">TP1</span> <span class="o">=</span> <span class="p">(</span><span class="n">FF</span><span class="o">/</span><span class="n">FFMFL</span><span class="p">)</span> <span class="o">*</span> <span class="n">TP1</span>
      <span class="n">KTYP</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c">!</span>
<span class="c">! EXIT TO GET F(X)</span>
  <span class="mi">410</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">FL</span> <span class="o">=</span> <span class="n">FF</span>
      <span class="n">FLMFB</span> <span class="o">=</span> <span class="n">FFMFL</span>
      <span class="n">XLMXB</span> <span class="o">=</span> <span class="n">XXMXL</span>
      <span class="n">XL</span> <span class="o">=</span> <span class="n">XX</span>
<span class="c">! COMPUTE X1, INSURING THAT IT IS NOT TOO CLOSE TO THE</span>
<span class="c">! ENDS OF THE INTERVAL</span>
      <span class="n">XX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">XL</span> <span class="o">+</span> <span class="n">TP1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">XL</span><span class="p">,</span> <span class="n">XO</span><span class="p">)</span> <span class="o">+</span> <span class="n">TOLX</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">XL</span><span class="p">,</span> <span class="n">XO</span><span class="p">)</span> <span class="o">-</span> <span class="n">TOLX</span><span class="p">)</span>
      <span class="n">X1</span> <span class="o">=</span> <span class="n">XX</span>
  <span class="mi">420</span> <span class="n">LMODE</span> <span class="o">=</span> <span class="n">MODE</span>
      <span class="k">return</span>
<span class="c">!</span>
  <span class="mi">430</span> <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">11</span><span class="o">*</span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">-</span> <span class="mi">19</span>
  <span class="mi">440</span> <span class="n">MACT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">MLOC</span><span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">call </span><span class="n">DMESS</span><span class="p">(</span><span class="n">MACT</span><span class="p">,</span> <span class="n">MTXTAA</span><span class="p">,</span> <span class="n">IDAT</span><span class="p">,</span> <span class="n">FDAT</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">420</span>
<span class="c">!</span>
<span class="c">! A CALL TO THE SUBROUTINE HAS BEEN MADE WITH MODE/=1</span>
  <span class="mi">450</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MODE</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6</span>
      <span class="n">MODE</span> <span class="o">=</span> <span class="mi">6</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LMODE</span> <span class="o">/=</span> <span class="mi">6</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">440</span>
    <span class="k">end subroutine </span><span class="n">dzero</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> diva was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>