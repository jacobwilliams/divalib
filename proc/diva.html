<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Edition of DIVA">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>DIVA &ndash; diva</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">diva </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>DIVA
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 7.8% of total for procedures.">308 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/diva_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/diva_module.f90.html'>diva_module.f90</a></li>
    
     <li><a href='../module/diva_module.html'>diva_module</a></li>
    
  
     <li class="active">DIVA</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/diva.html#src">DIVA</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine DIVA(TSPECS, Y, F, KORD, NEQ, DIVAF, DIVAO, IDIMT, IDIMY, IDIMF, IDIMK, IOPT)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/divaev_module.html'>divaev_module</a></li>
    
    <li><a href='../module/diva_constants.html'>diva_constants</a></li>
    
    <li><a href='../module/divasc_module.html'>divasc_module</a></li>
    
    <li><a href='../module/divamc_module.html'>divamc_module</a></li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~diva~~UsesGraph Pages: 1 -->
<svg id="procdivaUsesGraph" width="452pt" height="154pt"
 viewBox="0.00 0.00 452.00 154.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~diva~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 150)">
<title>proc~~diva~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-150 448,-150 448,4 -4,4"/>
<!-- proc~diva -->
<g id="proc~~diva~~UsesGraph_node1" class="node">
<title>proc~diva</title>
<polygon fill="none" stroke="black" points="444,-84 390,-84 390,-60 444,-60 444,-84"/>
<text text-anchor="middle" x="417" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50">DIVA</text>
</g>
<!-- module~divamc_module -->
<g id="proc~~diva~~UsesGraph_node2" class="node">
<title>module~divamc_module</title>
<g id="a_proc~~diva~~UsesGraph_node2"><a xlink:href=".././module/divamc_module.html" xlink:title="divamc_module">
<polygon fill="#337ab7" stroke="#337ab7" points="354,-146 257,-146 257,-122 354,-122 354,-146"/>
<text text-anchor="middle" x="305.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">divamc_module</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;module~divamc_module -->
<g id="proc~~diva~~UsesGraph_edge1" class="edge">
<title>proc~diva&#45;&gt;module~divamc_module</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M399.37,-84.1C387.15,-92.72 369.97,-104.27 354,-113 351.11,-114.58 348.08,-116.13 345.01,-117.64"/>
<polygon fill="#000000" stroke="#000000" points="343.32,-114.57 335.76,-121.99 346.3,-120.9 343.32,-114.57"/>
</g>
<!-- module~divasc_module -->
<g id="proc~~diva~~UsesGraph_node3" class="node">
<title>module~divasc_module</title>
<g id="a_proc~~diva~~UsesGraph_node3"><a xlink:href=".././module/divasc_module.html" xlink:title="divasc_module">
<polygon fill="#337ab7" stroke="#337ab7" points="351.5,-104 259.5,-104 259.5,-80 351.5,-80 351.5,-104"/>
<text text-anchor="middle" x="305.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">divasc_module</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;module~divasc_module -->
<g id="proc~~diva~~UsesGraph_edge2" class="edge">
<title>proc~diva&#45;&gt;module~divasc_module</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M389.77,-76.79C381.32,-78.33 371.61,-80.11 361.87,-81.89"/>
<polygon fill="#000000" stroke="#000000" points="360.97,-78.49 351.77,-83.73 362.23,-85.38 360.97,-78.49"/>
</g>
<!-- module~diva_constants -->
<g id="proc~~diva~~UsesGraph_node4" class="node">
<title>module~diva_constants</title>
<g id="a_proc~~diva~~UsesGraph_node4"><a xlink:href=".././module/diva_constants.html" xlink:title="diva_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="221,-104 130,-104 130,-80 221,-80 221,-104"/>
<text text-anchor="middle" x="175.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diva_constants</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;module~diva_constants -->
<g id="proc~~diva~~UsesGraph_edge3" class="edge">
<title>proc~diva&#45;&gt;module~diva_constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M389.76,-71.48C378.72,-71.29 365.73,-71.09 354,-71 310.89,-70.65 299.76,-65.51 257,-71 246.36,-72.36 235.12,-74.71 224.52,-77.34"/>
<polygon fill="#000000" stroke="#000000" points="223.39,-74.02 214.6,-79.93 225.16,-80.79 223.39,-74.02"/>
</g>
<!-- module~divaev_module -->
<g id="proc~~diva~~UsesGraph_node5" class="node">
<title>module~divaev_module</title>
<g id="a_proc~~diva~~UsesGraph_node5"><a xlink:href=".././module/divaev_module.html" xlink:title="divaev_module">
<polygon fill="#337ab7" stroke="#337ab7" points="352.5,-24 258.5,-24 258.5,0 352.5,0 352.5,-24"/>
<text text-anchor="middle" x="305.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">divaev_module</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;module~divaev_module -->
<g id="proc~~diva~~UsesGraph_edge4" class="edge">
<title>proc~diva&#45;&gt;module~divaev_module</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M393.91,-59.88C382.07,-53.39 367.24,-45.26 354,-38 348.72,-35.11 343.11,-32.03 337.66,-29.05"/>
<polygon fill="#000000" stroke="#000000" points="339.19,-25.9 328.73,-24.17 335.83,-32.04 339.19,-25.9"/>
</g>
<!-- module~divamc_module&#45;&gt;module~diva_constants -->
<g id="proc~~diva~~UsesGraph_edge5" class="edge">
<title>module~divamc_module&#45;&gt;module~diva_constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M267.82,-121.96C253.76,-117.35 237.54,-112.03 222.7,-107.16"/>
<polygon fill="#000000" stroke="#000000" points="223.78,-103.83 213.19,-104.04 221.6,-110.48 223.78,-103.83"/>
</g>
<!-- module~divasc_module&#45;&gt;module~diva_constants -->
<g id="proc~~diva~~UsesGraph_edge6" class="edge">
<title>module~divasc_module&#45;&gt;module~diva_constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M259.37,-92C250.28,-92 240.63,-92 231.25,-92"/>
<polygon fill="#000000" stroke="#000000" points="231.22,-88.5 221.22,-92 231.22,-95.5 231.22,-88.5"/>
</g>
<!-- iso_fortran_env -->
<g id="proc~~diva~~UsesGraph_node6" class="node">
<title>iso_fortran_env</title>
<g id="a_proc~~diva~~UsesGraph_node6"><a xlink:href="http://fortranwiki.org/fortran/show/ISO_FORTRAN_ENV" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-104 0,-104 0,-80 94,-80 94,-104"/>
<text text-anchor="middle" x="47" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- module~diva_constants&#45;&gt;iso_fortran_env -->
<g id="proc~~diva~~UsesGraph_edge7" class="edge">
<title>module~diva_constants&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M129.9,-92C121.71,-92 113.06,-92 104.57,-92"/>
<polygon fill="#000000" stroke="#000000" points="104.34,-88.5 94.34,-92 104.34,-95.5 104.34,-88.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>Main routine.</p>
<h3>Notes</h3>
<div class="codehilite"><pre><span></span><code>++S Default KDIM = 16
++  Default KDIM = 20
++  Default MAXORD = 2, MAXSTF = 1
++  Default INTEGO, VAREQ, OUTPUT, DUMP, GSTOP, EXTRAP
++  Default STIFF=.F., ARGM=.F., ERRSTO=.F.
</code></pre></div>

<h3>History</h3>
<ul>
<li>2015-03-15 DIVA  Krogh  Removed extra call divabu after noise test</li>
<li>2015-03-15 DIVA  Krogh  Forced restart needs more reduction in h.</li>
<li>2010-02-20 DIVA  Krogh  Fixed calling DIVAOP with array other than F</li>
<li>2009-11-03 DIVA  Krogh  Added option 11, more variables initialized.</li>
<li>2009-10-30 DIVA  Krogh  Gave KSSTRT and ROBND initial values.</li>
<li>2009-10-30 DIVA  Krogh  Fixed reference to undefined location in F.</li>
<li>2009-10-21 DIVA  Krogh  Got rid of NaN in diag. print when LSC=3.</li>
<li>2009-10-15 DIVA  Krogh  A few changes on how noise is handled.</li>
<li>2002-11-12 DIVA  Krogh  Fixed problem integrating to final output pt</li>
<li>2002-08-29 DIVA  Krogh  Added test for invalid HMIN/HMAX.</li>
<li>2002-07-26 DIVA  Krogh  Added KOUTKO to fully support Option 10.</li>
<li>2002-05-14 DIVA  Krogh  Fix starting prob. for Option 18.</li>
<li>2002-05-13 DIVA  Krogh  Put exponent letter in  numbers missing them</li>
<li>2002-05-12 DIVA  Krogh  Added error message for bad option 5 usage.</li>
<li>2001-09-07 DIVA  Krogh  Changes to allow user tol on G-Stops.</li>
<li>2001-05-25 DIVA  Krogh  Minor change for making .f90 version.</li>
<li>2001-05-18 DIVA  Krogh  Less computing with no error test</li>
<li>2001-05-17 DIVA  Krogh  Fixed so with no error test can't start dump</li>
<li>2001-04-24 DIVA  Krogh  Inserted comments from ivacom.</li>
<li>2000-12-01 DIVA  Krogh  Removed (some of) unused C1, MAXSTF, METEXT.</li>
<li>1999-12-28 DIVA  Krogh  Saved S in DIVACR for output consistency.</li>
<li>1999-08-19 DIVA  Krogh  Removed superfluous test above label 3520.</li>
<li>1997-04-22 DIVA  Krogh  Got rid of assigned go to's. F=0 if diag.</li>
<li>1996-08-26 DIVA  Krogh  Initialize F to 0 if dumping solution.</li>
<li>1996-08-23 DIVA  Krogh  Print TN not TSPECS(1) in error messages.</li>
<li>1996-05-30 DIVA  Krogh  Changed DERIVS/OUTPUT to  DIVAF/DIVAO.</li>
<li>1996-04-27 DIVA  Krogh  Changes to use .C. and C%%.</li>
<li>1996-03-30 DIVA  Krogh  Added external statement.</li>
<li>1996-03-25 DIVA  Krogh  Introduced TEXT1 to comply with F77.</li>
<li>1996-02-27 DIVA  Krogh  Fixed so DUMP not affected by ignored eqs.</li>
<li>1995-12-18 DIVA  Krogh  Fixed so no solution dump on 0 length integ.</li>
<li>1995-11-09 DIVA  Krogh  Fixed so char. data at col. 72 is not ' '.</li>
<li>1995-06-19 DIVA  Krogh  Fixed prob. with discon. just after restart.</li>
<li>1995-05-09 DIVA  Krogh  Fixed G-Stop/discontinuity code interaction</li>
<li>1995-04-26 DIVA  Krogh  Use KQMAXS instead of KQMAXI when LDIS&gt;1000.</li>
<li>1995-04-26 DIVA  Krogh  Keep current KQL on discontinutiy.</li>
<li>1994-12-16 DIVA  Krogh  Fixed option 12 with K12 &lt; 0.</li>
<li>1994-11-11 DIVA  Krogh  Declared all vars.</li>
<li>1994-11-02 DIVA  Krogh  Changes to use M77CON</li>
<li>1994-09-08 DIVA  Krogh  Added CHGTYP code.</li>
<li>1994-07-11 DIVA  Krogh  Fix to get same state with/without var. eqs.</li>
<li>1994-03-07 DIVA  Krogh  Allow larger order in single precision.</li>
<li>1994-01-14 DIVA  Krogh  Minor change to allow changing TFINAL.</li>
<li>1993-04-27 DIVA  Krogh  Additions for Conversion to C.</li>
<li>1993-04-12 DIVA  Krogh  Converted to use slightly altered MESS.</li>
<li>1993-04-12 DIVA  Krogh  Fixed LSC so sol. saved when HMAX is small.</li>
<li>1992-10-13 DIVA  Krogh  Fixed G-Stop/discontinuity code interaction.</li>
<li>1992-09-21 DIVA  Krogh  Fixed bug in discontinuity code.</li>
<li>1992-09-09 DIVA  Krogh  Fixed bug - Var. Eqs. with discontinuities.</li>
<li>1992-08-07 DIVA  Krogh  Storage map printed only if option 10 /= 0</li>
<li>1992-07-16 DIVA  Krogh  Restored correct discontinuity code.</li>
<li>1992-06-16 DIVA  Krogh  Eliminate reuse of storage for option 12.</li>
<li>1992-04-08 DIVA  Krogh  Removed unused labels, 1020, 2120.</li>
<li>1992-03-30 DIVA  Krogh  Fixed bug in DIVAOP error message.</li>
<li>1992-03-12 DIVA  Krogh  Simplified DIVABU, more digits in B's.</li>
<li>1992-01-16 DIVA  Krogh  Fixed minor bug in error messages.</li>
<li>1991-12-03 DIVA  Krogh  Major change for improved error checks.</li>
<li>1991-06-17 DIVA  Krogh  Fixed bug in checking storage allocation.</li>
<li>1991-04-11 DIVA  Krogh  Fixed minor bug re. option 12 in DIVAOP.</li>
<li>1991-03-28 DIVA  Krogh  Removed check at label 650 for KORD2I&lt;0.</li>
<li>1991-02-08 DIVA  Krogh  Changed some floats to generics</li>
<li>1990-11-08 DIVA  Krogh  Fixed bug on TSPECS on discon.</li>
<li>1990-09-14 DIVA  Krogh  Fixed bug when discon. and sol. save.</li>
<li>1990-09-13 DIVA  Krogh  Increased dimension of BETA by 1.</li>
<li>1990-09-13 DIVA  Krogh  Added one more poss. on rel. error test.</li>
<li>1990-09-11 DIVA  Krogh  Recent change messed up getting dump output.</li>
<li>1990-06-05 DIVA  Krogh  Fixed bug in noise test, comments in IVACOM.</li>
<li>1990-05-08 DIVA  Krogh  Fixed new bug when TMARK hit in DIVAG.</li>
<li>1990-04-17 DIVA  Krogh  Fixed minor problem in DIVAIN error msg.</li>
<li>1990-04-10 DIVA  Krogh  Fixed interaction between discon. &amp; dump.</li>
<li>1990-03-23 DIVA  Krogh  Fixed bug on option "-2", see 1989-12-07.</li>
<li>1990-03-20 DIVA  Krogh  Fixed rarely occuring loop.</li>
<li>1990-01-29 DIVA  Krogh  Removed unneeded labels.</li>
<li>1989-12-14 DIVA  Krogh  Saved common block DIVAEV.</li>
<li>1989-12-07 DIVA  Krogh  Added option "2" to DIVAOP.</li>
<li>1989-11-09 DIVA  Krogh  Made GG a save var. in DIVAHC</li>
<li>1989-08-21 DIVA  Krogh  Fix out of bounds ref. to V in DIVABU</li>
<li>1989-07-26 DIVA  Krogh  Fix bug in initial dim. check</li>
<li>1989-07-21 DIVA  Krogh  Code for integrating discontinuities</li>
<li>1987-12-07 DIVA  Krogh  Initial code.</li>
</ul>
<h3>Common variables and local variables</h3>
<p>ALPHA  (DIVAMC) Array with I-th entry = (current step size) / XI(I).
   Used in computing integration coefficients.
 B      (DIVAHC) Array used to get started on computing integration
   coefficients.  B(K) = 1. / (K<em>(K+1))
 BAKMIN (DIVADE) The largest delay at the initial point.
 BETA   (DIVAMC) Array with I-th entry = product (K=1,I-1) of
   (current (XI(K)) / XI(K) from previous step),  BETA(1)=1.  Used in
    updating the difference tables.
 C      (DIVAIN) Array used to hold integration/interpolation coeffs.
 C0     Parameter = 0. (in DIVAA,DE,CR,A,G,HC,IN,OP,PR)
 C1     Parameter = 1. (in DIVA,A,CR,DA,HC,IN,OP)
 C10    Parameter = 10. (in DIVAA,CR,OP)
 C1000  Parameter = 1000. (in DIVACR)
 C16    Parameter = 16. (in DIVAA,OP)
 C1M3   Parameter = .001 (in DIVAA)
 C1M5   Parameter = .00001 (in DIVAA)
 C1P125 Parameter = 1.125 (in DIVAA,HC,OP)
 C1P3   Parameter = 1.3 (in DIVAA)
 C1P4   Parameter = 1.4 (in DIVACR)
 C2     Parameter = 2. (in DIVAA,DE,BU,CR,IN,OP)
 C20    Parameter = 20. (in DIVACR)
 C2P5M3 Parameter = .0025 (in DIVAA)
 C4     Parameter = 4. (in DIVACR,OP)
 C40    Parameter = 40. (in DIVACR)
 C4096  Parameter = 4096. (in DIVAA)
 C6     Parameter = 6. (in DIVAA)
 C8M3   Parameter = .008 (in DIVAA)
 CM2    Parameter = -2. (in DIVACR)
 CM8    Parameter = -8. (in DIVACR)
 CMP5   Parameter = -.5 (in DIVACR)
 CMP75  Parameter = -.75 (in DIVAOP)
 CP0625 Parameter = .0625 (in DIVAA)
 CP1    Parameter = .1 (in DIVAA,CR,DA,HC)
 CP125  Parameter = .125 (in DIVACR)
 CP25   Parameter = .25 (in DIVAA,CR,DE,OP)
 CP3    Parameter = .3 (in DIVAA,OP)
 CP4    Parameter = .4 (in DIVAA)
 CP5    Parameter = .5 (in DIVAA,CR,DA,DE,HC,OP)
 CP5625 Parameter = .5625 (in DIVAHC)
 CP625  Parameter = .625 (in DIVAOP)
 CP75   Parameter = .75 (in DIVACR,OP)
 CP8    Parameter = .8 (in DIVACR)
 CP875  Parameter = .875 (in DIVAA, OP)
 CP9    Parameter = .9 (in DIVAOP)
 CP9375 Parameter = .9375 (in DIVACR)
 CQ3125 Parameter = .03125 (in DIVACR)
 CRBQI  Parameter = .421875 (in DIVAHC)  Initial val for computing RBQ.
 CSUM   (DIVAIN) Array used to contain partial sums of the integration
   coefficients.  This is used to corrrect for a difference table that
   has not yet been updated.
 D      (DIVAMC) Array to be used later to store coefficients for
   integrating stiff equations.
   derivatives.  Not used if option 13 is set.
 DISADJ (DIVAA) Value of stepsize when discontinuity is indicated.
 DNOISE (DIVAMC) Used in determining if noise is limiting the
   precision.  It is usually |highest difference used in correcting|
   of the equation with the largest error estimate.
 DS     (DIVAMC) Array to be used later to store coefficients for
   estimating errors when integrating stiff equations.
 DVC2   (DIVADB) Array used for output of variables HC to TOUT in
   common block DIVAMC.
 E      (DIVACR) (Estimated error) / (Requested accuracy)
 EAVE   (DIVAMC) This is a weighted average of past values of EIMAX.
   It is adjusted to account for expected changes due to step changes.
 EEPS10 (DIVAEV) = 10. * (machine epsilon).
 EEPS16 (DIVAEV) = 16. * (machine epsilon).
 EEPS2  (DIVAEV) =  2. * (machine epsilon).
 EEPT75 (DIVAEV) = (machine epsilon) </em>* (.75)
 EI     (DIVACR) Estimate for what E would be if step size increased.
 EIBND  (DIVACR) Array containing limits on the estimated error with
   the stepsize increased.  This array tends to make the code a little
   more conservative on step size increases at low order.
 EIMAX  (DIVAMC) Estimate of (error estimate / error requested) if the
   step size should be increased.
 EIMIN  (DIVAMC) An error estimate is small enough to allow a step
   increase if the estimate of ((error with the step size increased) /
   (error requested)) is less than EIMIN.
 EIMINO (DIVAA) Set to C8M3 and never changed.  When step size is being
   reduced if EIMIN &lt;= EIMINO then the reduction factor is set to
   CP875.  This variable could be a parameter.
 EMAX   (DIVAMC) Largest value computed for (error estimate) / (error
   requested).
 EOVEP2 (DIVAEV) = EEPS2 * (largest floating point number).
 EPS    (DIVACR) Current absolute error tolerance.  Also used for
   temporary storage when computing the desired value of EPS.
 ERCOEF (DIVACR) (Error coefficient from formula) / EPS
 EREP   (DIVAMC) If EMAX &gt; EREP, a step is repeated.  Ordinarily
   this has the value .3.  This is set &lt; 0 if the error tolerance is
   specified improperly, and is set to a large value if the user
   requests complete control over the step size.  EREP is also set
   &lt; 0 after a user specified discontinuity.
 EROV10 (DIVAEV) = 10. / (largest floating point number).
 ETA    (DIVAIN) Array used in computing integration/interp. coeffs.
 EVC    (DIVADB) Array used for output of variables EEPS2 to EROV10 in
   common block DIVAEV.
 EXR    (DIVAA) Set to CP1 and never changed.  If it is estimated the
   the (error estimate) / (error requested) on the next step will be</p>
<blockquote>
<p>= EXR then the step size is reduced.  Could be a parameter.
 F      (formal) Array used to store derivative values, the difference
   tables, error tolerance requests, and values used by some other
   options. (in DIVA,A,BU,CR,DA,DB,G,IN,PR)
 FDAT  (DIVAMC) Used to store data for error messages.  (Local array in
   DIVAIN.)
 FOPT  (formal) in DIVAOP.  Passed as place to save floating point data
   for options.  This package passes F in for FOPT when calling DIVAOP.
 G      (DIVAMC) Integration coefficients used for predicting solution.
   G(I, J) gives the I-th coefficient for integrating a J-th order
   differential equation.  G(1, 1) is equal to the step size.
 GAMMA  (DIVAIN) Array used in computing integration/interp. coeffs.
 GG     (DIVAHC) Array of length = max. differential equation order
   allowed by code - 1.  GG(K) = (HH<strong>(K+1)) / K!
 GNEW   (formal) in DIVAG.  Current value for vector function g, whose
   zeroes are to be found.
 GOINT  (DIVACR) Used for assigned go to used in computing integration
   coefficients.
 GOLD   (DIVAG) Previous value for element of G whose zero search is
   active.
 GS     (DIVAMC) Integration coefficients used in estimating errors.
 GT     (formal) in DIVAG.  Previous value of GNEW.
 HC     (DIVAMC) Ratio of (new step size) / (old step size)
 HDEC   (DIVAMC) Default value to use for HC when reducing the step
   size.  (Values closer to 1 may be used some of the time.)
 HH     Equivalenced to G(1,1) = current step size in DIVAA,CR,DA,G,HC.
 HI     (DIVAIN) Step length from the base value of the independent
   variable for the interpolation.
 HINC   (DIVAMC) Default value to use for HC when increasing the step
   size.  (Values closer to 1 may be used some of the time.)
 HINCC  (DIVAMC) Actual value used for default value of HC when
   increasing the step size.  Set to HINC after start is considered
   complete.  During the start HINCC is set to 1.125.
 HMAX   (DIVAMC) Largest value allowed for abs(step size).  Default
   value is a very large number.
 HMAXP9 (DIVAMC) .9 * HMAX.
 HMIN   (DIVAMC) Smallest value allowed for abs(step size).  Default
   value is 0.
 HNEW   (DIVADE) Value of step size when iterating at initial point
   for delay differential equations.
 I      Used for temporary storage. (DIVAA,BU,CR,DA,DE,G,IN,OP,PR)
 IA     (DIVAOP) absolute value of first integer stored for an option.
 ICF    (DIVAMC) Final index for current loop in DIVACR.  Required by
   option 18.
 ICI    (DIVAIN) Temporary index, = 0 for interpolation, 1 or 0 for
   differentiation, and d-1, d-2, ... 0 for integration, where d is the
   order of the differential equation.  Index of first location
   in C() used is ICI + an offset.
 ICS    (DIVAMC) Starting index for current loop in DIVACR.
 ID     (formal) Array use to contain integer data from common.  Values
   are returned in locations 1 to 5 as follows.
   1    KEMAX = Index of equation with largest error estimate
   2    KSTEP = Current step number
   3    NUMDT = Number of differences used for each equation
   4            Reserved for future use
   5            Reserved for future use
 IDAT   (DIVAMC) Used to store integer for error messages.  (Also used
   in DIVAA for temporary storage of KORD(2).  (Local array in DIVAIN.)
 IDE    (DIVADE - formal) Array used to contain past information so
   that delays can stretch back indefinitely.  If the first location is
   0, then any interpolations requested must be in the range of the
   current difference tables.  At present, only the value 0 is allowed
   in IDE(1).  This array is intended for the support of saving long
   past histories.  IDE(2) must contain the declared dimension of WDE.
 IDEF   (DIVADE -- formal) Flag giving indicaion of what is going on.
   = 0  User should compute derivatives and return to the main
        integrator.
   = 1  Code is computing additional values in order to get past data
        necessary for starting.  User should compute derivatives and
        call DIVADE.
   &lt; 0  Indicates an error condition.  If DIVADE is called without
        changing the value of IDEF, the integration is stopped and an
        error message printed.  Possible error flags are:
    -1  Difference tables do not span back far enough to compute the
        past values of Y needed.
    -2  There is not enough space in WDE to get the required starting
        values.
 IDIMF  (formal) Declared dimension of F().
 IDIMK  (formal) Declared dimension of KORD().
 IDIMT  (formal) Declared dimension of TSPECS().
 IDIMY  (formal) Declared dimension of Y().
 IDT    (DIVAIN) Used as a base index into the difference table.
 IFLAG  (formal in DIVAG) Used for communication with user.
   = 1  Continue as if DIVAG was not called.
   = 2  Check KORD(1) as one would do at start of OUTPUT if no G-Stops
        were present. (Exit if in DERIVS.)
   = 3  Return to the integrator.
   = 4  Compute G and return to DIVAG.
   = 5  A G-Stop has been found, and NSTOP gives its index.  (If NSTOP
        &lt; 0, the stop was an extrapolating stop.)
   = 6  Same as 5, but requested accuracy was not met.
   = 7  Same as 5, but there is a probable error in computing G.
   = 8  Fatal error of some type.  (An error message has been printed.)
 IG     (DIVAG)  IG = KORD(2) on the initial entry (0 for extrapolating
   G-Stops, and 1 for interpolating).
 IGFLG  (DIVAMC) Used primarily in DIVAg, but also used in DIVA to keep
   track of the state of GSTOP calculations.
   = -2 Extrapolatory G's initialized, but not the interpolatory.
   = -1 Interpolatory G's initialized, but not the extrapolatory.
   =  0 Set when integration is started or restarted, or option setting
        GSTOP is set.
   =  1 Iterating to find a GSTOP.
   =  2 User told that a GSTOP was found.
   =  3 Checking G's at point where a GSTOP was located.
   =  4 Checking G's at a T output point.
   =  5 Usual case, no sign change detected.
 IGSTOP (DIVAMC) IGSTOP(k) is set in DIVAg to the index of the last G
   with a 0, where k is one for an interpolatory G-Stop, and k is two
   for an extrapolatory G-Stop.
 IGTYPE (DIVAMC) Array with two elements as for IGSTOP, but this saves
   a flag giving the nature of convergence to the stop.
   = 0  All known G-stops completely processed.
   = 4  Need to compute next value while iterating.
   = 5  Got good convergence.
   = 6  Got convergence, but not to desired accuracy.
   = 7  Problem in getting convergence.
   = 8  A fatal error of some type.
 IHI    (DIVA) Last location used by the current option.
 ILGREP (DIVAMC) Used when correction to keep track of equations that
   are to use a certain error tolerance.
 ILGROR (DIVACR) Index of last equation in the current group of
   equations grouped for selecting integration order.
 ILOW   (DIVA) First location used by the current option.
 INCOM  (DIVADE) Array equivalenced to LDT in the common block DIVASC.
   Used to simplify saving information in the common block.
 INCOP  (DIVAOP) Array containing data giving the amount of space in
   IOPT used for each of the options.
 INGS   Current index for G-stop being examined in DIVAG.
 INICAS (DIVADE) Used to track the initialization for a delay equation.
   = 1  Very beginning.
   = 2  Getting derivative at the very beginning.
   = 3  Getting derivatives at points prior to the initial point.
   = 4  Getting derivative at initial point after iteration is started.
 INTCHK (DIVA) Array passed to OPTCHK containing information on storage
   allocation.  See comments in OPTCHK for details.
 INTEG  (DIVAIN) Number of integrations being done. (&lt;0 for
   differentiations and =0 for interpolation.)  Also used as counter
   when computing integration coefficients.
        (DIVAPR) Number of integrations being done.
 INTEGS (DIVAPR) = -1 for equations that are not stiff, 0 for those
   that are stiff.
 INTEGZ (DIVAIN) min(INTEG, 0)
 INTERP (DIVAIN) added to the usual integration order to get the order
   to be used when interpolating: 3-KQMAXI, if HI=0; 1, if
   |HI| &gt; |XI(1)| and HI * XI(1) &lt; 0; 0, otherwise -- the usual case.
 IOP10  (DIVAMC) Number of times diagnostic output is to be given when
   leaving DIVAcr (the corrector).
 IOP11  (DIVAMC) Gives current step number of the method.  Tells how
   many of certain coefficients must be computed. (Has nothing to do
   with options.) = min(max integ order + 1, KDIM).  Also set when
   starting to flag that certain memory locations must be set to 0.
 IOP12  (DIVAMC) Points to location in F() where user supplied values
   of HINC, HDEC, HMIN, and HMAX.  (0 if option 12 not used.)
 IOP13  (DIVAMC) If not zero, reverse communication will be used for
   getting the values of derivatives.  Associated with option 13.
 IOP14  (DIVAMC) If not zero, reverse communication will be used in
   place of calls to the output routine.  Associated with option 14.
 IOP15  (DIVAMC) If not zero, a return will be made to the user after
   the initialization.  Associated with option 15.  This might be used
   to overlay DIVA, some of the user's code, and perhaps DIVAop.
 IOP16  (DIVAMC) Points to location in KORD() where information for
   specifying the error tolerance is specified.  See option 16.
 IOP17  (DIVAMC) Used in initialization for option 17, afterwards this
   cell is used by KEXIT which is equivalenced to IOP17.
 IOP18  (DIVAMC) Points to location in KORD() where information for
   specifying a grouping of equations for derivative evaluation is
   stored.  See option 18.
 IOP19  (DIVAMC) Points to location in KORD() where information for
   specifying a grouping of equations for integration order control
   is stored.  See option 19.
 IOP20  (DIVAMC) Used for option 20, gives first location in F where
   estimated errors are to be stored.  Expected to be useful in a
   program for solving boundary value problems using multiple shooting.
 IOP21  (DIVAMC) Was used for stiff equations option (never completely
   coded).  The optional code still uses this (don't activate it!).
   Now used to flag the location if F where the user has stored the
    tolerance to use in finding G-Stops.
 IOP21S (DIVAMC) Was used for stiff equations see above.
 IOP22  (DIVAMC) Set aside for possible option for stiff equations.
 IOP3   (DIVAMC) Value set by option 3.
   =  0 Interpolate to final point. (The default)
   =  1 Integrate to final point.
   = -1 Extrapolate to final point.
 IOP4   (DIVAMC) Value set by option 4.  The output routine is called
   with KORD(1) = 4, every IOP4 steps.  (Default value for IOP4 is a
   very large number.
 IOP5   (DIVAMC) Value provided by option 5, used to specify extra
   output points.
 IOP6   (DIVAMC) Value provided by option 6.  If nonzero, the output
   routine is called at the end of every step.  If &gt; 0, there are
   IOP6 interpolating G-Stops.
 IOP7   (DIVAMC) Value provided by option 7.  If &gt; 0, there are K7
   extrapolating G-Stops.
 IOP8   (DIVAMC) Value provided by option 8.  If nonzero, the output
   routine is called with KORD(1)=8 whenever the step size is changed.
 IOP9   (DIVAMC) Value provided by option 9.  Used to specify that the
   user wishes to save the solution.
 IOPIVA (DIVA) Used to save length of IOPT vector for error messages.
 IOPST  (DIVASC) Intended for possible use in stiff equations.
 IOPT   (formal DIVA and IVAOP) Used to specify options.
 IOPTC  (DIVAOP) In DIVAOP equivalenced so that IOPTC(3) is equivalent
   to IOP3.
 IOPTS  (DIVAOP) Array containing the current default values to be
   stored into IOPTC.
 IORD   (DIVACR) Index of first equation in the current group of
   equations grouped for selecting integration order.
 IOUTKO (DIVADC) Used in DIVADI to point to KORD to keep track of
   equation grouping for diagnostic output.
 ISVCOM (DIVADE) Used to save info. in the common block DIVASC.
 ITERS  (DIVADE) Counts iterations in starting delay differential
   equations.  Max. value for this is arbitrarily 100.
 ITOLEP (DIVAMC) Used for temporary storage, and for the index of a
   tolerance relative to the start of tolerances.
 IVC1   (DIVADB) Array used for output of variables IOPST to NUMDT in
   common block DIVASC.
 IVC2   (DIVADB) Array used for output of variables ICF to NY in
   common block DIVAMC.
 IWB    (DIVADE) Current base index for saving F values in WDE when
   starting delay differential equations.
 IY     (DIVAMC) Used for the current index to the Y() array.  (Local
   variable in DIVAIN used in computing IYI.)  Equivalenced to
   IZFLAG in DIVAG.
 IYI    (DIVAIN) Y(IYI) is currently being computed.
 IYN    (DIVAIN) Y(IYN) is base Y() corresponding to Y(IYI).
 IYNI   (DIVAIN) Used as base index for computing IYN as IY is for INI.
 IYO    (DIVADE) Points to first base value of Y for current
   interpolation when getting values for a delay differential equation.
 IZFLAG (DIVAG)  Equivalenced to IY.  Set to 0 initially, and later
   set to the value returned by <em>ZERO.
    = 0  Value set on entry at start of search.
    = 1  Compute next g again.
    = 2  Normal terminiation.
    = 3  Normal termination -- error criterion not satisfied.
    = 4  Apparent discontinuity -- no zero found.
    = 5  Couldn't find a sign change.
    = 6  </em>ZERO was called with a bad value in IZFLAG.
 J      For temporary storage. (In DIVA,A,BU,CR,DA,DB,DE,HC,IN,OP,PR)
 J1     (DIVAA &amp; DA) Used for temporary storage.
 J2     (DIVAA) Used for temporary storage.
 JL     (DIVA) Used for checking storage.
 JLGREP (DIVACR) Contents of first location of KORD (called LGROUP in
   DIVACR) for the current error tolerance rule.
 JLGROR (DIVACR) Contents of first location of KORD for the current
   integration order control.
 JLIM   (DIVA) Used for checking second item in KORD list for options
   16 and 19.
 K      For temporary storage.  (In DIVA,A,BU,CR,DA,DB,DE,HC,IN,OP,PR)
 KDIM   Parameter giving the largest number of differences supported.
        Used in all the routines.
 KEMAX  (DIVAMC) Index associated with equation giving the largest
   value for (estimated error) / (requested error).
 KEXIT  (DIVAMC) Equivalenced to IOP17 which is not used after
   initialization.  Defines actions when KORD2I = -7.  (Referenced in
   (DIVAA,DA,G).)
   =  1  Take the step over with reduced H.
   =  2  Take the step over.
   =  3  Do the end of step call to OUTPUT.
   =  4  Reset TMARK, then do same as for KEXIT = 2.
   =  5  Reset TMARK, then do same as for KEXIT = 3.
   =  6  Give the fatal error diagnostic.
 KFERR  (DIVA)  Temporary storage in checking for option 16.
 KGO    (DIVA)  Used to tell from whence a check is being done or an
   error message is being written.
   = 1 Checking an equation group for variational equations.
   = 2 Checking an equation group for diagnostic print.
   = 3 Checking an equation group for integration order control.
   = 4 Checking an equation group for error control.
   = 5 Checking an equation group for specifying ODE orders.
   = 6 Found a problem with output type for printing.
   = 7 Found a problem with an output group for printing.
   = 8 Found a problem with input NEQ.
   = 9 Order specified for the ODE's in the system is out of range.
   =10 Option 16 was not used (an error).
   =11 Error tolerance of 0 specified without proper flags.
 KIS    (DIVAMC) Used to check if it is time to dump the solution.
   The check involves incrementing KIS at the end of the step, and
   dumping the solution if KIS is 0.
   = -1  Set in DIVAcr when it is time to dump solution
   =  0  When starting
   =  2  After being dumped.
   This is set to 1000 just after a user specified discontinuity, and
   counted up from that point.
 KMARK  (DIVAMC) Identifies the type of output associated with the next
   output point specified by TSPECS.
 KONV   (DIVADE) Counts iterations.  Test for convergence if KONV &gt; 1.
 KORD   (formal in DIVA,A,BU,CR,DA,DB,DE,G,IN,PR) KORD(1) is used to
   return flags for the user to test, and KORD(2) tells what routine
   the flag is associated with.  See KORD1I and KORD2I below and the
   write up for the program.  KORD(3) is used for communicating extra
   information to the user in some cases.  KORD(4) to KORD(NTE+3) are
   used for integration order for the equations, and the rest of KORD()
   is available for user options.
 KORD1I (DIVAMC) Helps in defining the state of the integrator.
   Frequently has the same value as KORD(1).  Meaning depends on the
   value of KORD(2), or the value about to be assigned to KORD(2).
   &lt;  0  Happens when preparing to give output with extrapolation.
   =  0  Happens when checking F at points for noise test.
   =  1  (KORD(2)=-1)  End of integration has been reached.
   =  1  (KORD(2)= 0)  Computing first predicted derivative.
   =  1  (KORD(2)= 1)  Output for initial point.
   =  2  (KORD(2)=-1)  Giving diagnostic for noise limiting precision.
   =  2  (KORD(2)= 0)  Computing corrected derivative.
   =  2  (KORD(2)= 1)  Output for TSPECS(3).
   =  3  (KORD(2)=-1)  Diagnostic for step size reduction too fast.
   =  3  (KORD(2)= 0)  Computing variational derivative.
   =  3  (KORD(2)= 1)  Output for TSPECS(4).
   =  4  (KORD(2)=-1)  Error, discontinuity.
   =  4  (KORD(2)= 1)  Output for certain number of steps.
   =  5  (KORD(2)= 0)  Get initial derivatives for stiff equations.
   =  5  (KORD(2)= 1)  Extra output from TSPECS.
   =  6  (KORD(2)= 1)  End of step output.
   =  7  (KORD(2)= 0)  Evaluate G before extrapolated output point.
   =  7  (KORD(2)= 1)  Evaluate G before extrapolated output point.
                       (Also used when checking for other G's after
                        finding one.)
   =  8  (KORD(2)= 1)  Tell user step size has changed.
   =  9  (KORD(2)= 1)  Request for user to save solution.
   = 11  (KORD(2)=-1)  Error, step size too small at end of start.
   = 12  (KORD(2)=-1)  Error, step size is too small.
   = 13  (KORD(2)=-1)  Error, output points specified badly.
   = 21  (KORD(2)=-1)  H too small to give reasonable change when added
                       to T.
   = 22  (KORD(2)=-1)  Error, bad tolerance.
   = 23  (KORD(2)=-1)  Set after message for a fatal error.
   = 24  Set on error message in DIVA, along with KORD2I = -4.
   Also used as an index into MLOC in DIVAA when an error is being
   processsed, see MLOC below.
 KORD2I (DIVAMC) Helps in defining the state of the integrator.
   Frequently has the same value as KORD(2).
   = -3  Set in DIVAg, to get a derivative evaluation.
   = -2  Set in DIVAg, to get another entry to OUTPUT.
   = -1  Return to calling program, done, interrupt, or got an error.
   =  1  Calling OUTPUT or returning to user for OUTPUT type action.
   =  0  Calling DERIVS or returning to user for DERIVS type action.
   = -4  Error message in DIVA and in DIVAop, along with KORD1I = 24.
   = -5  Starting
   = -6  Starting, getting the initial derivative value or derivatives
         for the noise test.
   = -7  Done some extrapolation, KEXIT defines the action to take.
         Set in DIVAg to activate KEXIT action in DIVA.
   = -8  Set when user has requested adjustment of the difference
         tables for a discontinutiy.
 KORDI  (DIVASC) Order of differential equation being integrated.  If
   all orders are the same, this set once at the beginning.
 KOUNT   (DIVADE) Count of number of points back from the initial point
   when solving a delay differential equation.
 KOUNTM  (DIVADE) Largest value currrently allowed for KOUNT.
 KOUNTX  (DIVADE) Largest value allowed for KOUNTM.
 KOUTKO  Used in DIVACR to track where output is wanted.
 KPRED  (DIVAMC) Value assigned to KORD1I when getting a predicted
   derivative.  (1 used now, 5 planned for use with stiff equations.)
 KQD    (DIVACR) = max(2, integration order)
 KQDCON (DIVAMC) Number of coefficients computed with constant step
   size for stiff equations.
 KQICON (DIVAMC) Number of coefficients computed with constant step
   size for nonstiff equations.
 KQL    (DIVACR) Integration order at start of (DIVACR)
 KQLORD (DIVACR) Saved value of KQL when equations are grouped for
   controlling the integration order.
 KQMAXD (DIVASC) Maximum integration order used for stiff equations.
 KQMAXI (DIVASC) Maximum integration order used for nonstiff equations.
 KQMAXS (DIVAMC) Maximum integration order for equations that have
   some limit on the error that can be committed.
 KQMXDS (DIVAMC) Used to save KQMAXD in case step is repeated and the
   solution must be dumped.
 KQMXI  (DIVAIN) Maximum integration order used for integration or
   interpolation, = KQMAXI+INTERP-1.
 KQMXS  (DIVAIN) Maximum step number, = max(KQMXI, KQMAXD).
 KQMXIL (DIVAMC) Value of KQMAXI the last time integration coefficients
   were computed.
 KQMXIP (DIVAMC) = KQMAXI + MAXINT, for computing integration coeffs.
 KQMXIS (DIVAMC) Used to save KQMAXI in case step is repeated and the
   solution must be dumped.
 KQN    (DIVACR) Value of integration order at end of DIVACR.
 KQQ    Used for the integration order for current equation.  (Values
   &lt; 0 are intended for stiff equations.)  (In DIVA,BU,DA,IN,PR)
 KSC    (DIVAMC) Number of steps that have been taken with a constant
   step size.
 KSOUT  (DIVAMC) When KSTEP reaches this value, the output routine is
   called with KORD(1) = 4.  The default value is a very large number.
 KSSTRT (DIVAMC) Set when ending one derivative per step to KSTEP + 2.
   Checked later in DIVAHC to decide whether to set the step changing
   factors to their nominal values.
 KSTEP  (DIVAMC) Number of steps taken since the start of integration.
 L      Used for temporary storage.  In DIVAIN, L is the initial value
   of LDT, except L=1 if LDT=-1, and MAXINT &gt;= 0.  (Used in DIVAA,BU
   CR,DA,DB,IN,PR.)
 LAHAG  (DIVADB) Used to get proper offset into an diagnostic message.
 LAIAG  (DIVADB) Used to get proper offset into an diagnostic message.
 LDIS   (DIVAA) Count of steps since user flagged a discontinuity.
 LDT    (DIVASC) Used to keep track of state of difference table.
   = -5  Used only on first step to indicate that an extra iteration
         is desired to get a firm estimate on the error.
   = -4  Set on initialization before there is any difference table.
   = -3  Set just after predicting, interpolation is not allowed when
         this value is set.
   = -2  Set when difference table is to be updated to the end of the
         current step, but no interpolation is to be done.  (For
         dumping the solution.)
   =  0  Calculations for current step are complete, it is not o.k. to
         update the difference table.
   =  1  Difference table has been updated to the end of the current
         step, e.g. by doing an interpolation.
   =  2  Set when doing a special interpolation during computation of
         derivatives.  (For delay equations.)
 LEX    (DIVAMC) Indicates how to get values at next output point:
   = -1  Extrapolate
   =  0  Interpolate (The usual case.)
   =  1  Integrate to the output point, integration is not continued.
 LGO    (DIVAIN) Used as an an assigned go to.  Result is to add in
   extra correction term when LDT has been set to 2.
 LGROUP (formal) This is a part of KORD passed into DIVACR.  The first
   location is the start of the information on the grouping of
   equations for error control.
 LINC   (DIVAMC) Used to indicate state of step size selection.
   = -10 After computed derivatives at base time, after computing other
         extra derivatives for the noise test.
   = -9  After computed second extra derivative for noise test.
   = -8  After computed first extra derivative for noise test.
   = -7  Dumping the solution and then doing a user initiated restart,
         or getting ready to compute extra derivatives for the noise
         test.
   = -6  Dumping the solution before a restart.
   = -5  Set on the first step, and also set when dumping the solution
         after a discontinuity.
   = -4  Repeat step with no change in the step size.
   = -3  Set when the error tolerance is set improperly.
   = -2  User has complete control of selecting the step size.
   = -1  Step is being repeated.
   =  0  Step size is not to be increased on this step.
   = k&gt;0 Step size can be increased by HINCC</strong>k.
 LINCD  (DIVAMC) Value of smallest k for which HINCC<strong>k &gt;= 2.
   (=-2 if user is specifying all step size changes.)
 LINCQ  (DIVAMC) Value of smallest k for which HINCC</strong>k &gt;= 4.
 LIOPT  (DIVAOP) Value of the last index in IOPT on the last call.
   Used so DIVA can print IOPT in error messages.
 LL     (DIVACR) Temporary variable used when equations are grouped
   for integration order control.
 LNOTM1 (DIVAIN) Logical variable = L /= -1.  If LNOTM1 is true,
   storage in Y() is different in some way lost to antiquity.  Such
   a case can only arise in the case of stiff equations.
 LOCF1  (DIVADB) Gives packed data needed for output of tables by the
   message processor MESS.  See comments there under METABL for defs.
 LOCF2  (DIVADB) As for LOCF1 above.
 LOCM   (DIVAA) Parameter = 32<em>256, used to unpack integers stored
   in MLOC for use in error message processing.
 LPRINT (formal, DIVADB) Defines how much printing is to be done in
   DIVADB.  Let |LPRINT| = 10</em>N1 + N2     (N1,N2 digits)
    N1=1   Do not print any variables external to the integrator.
    N1=2   Print  tspecs, current y, past y, current f, all pertinent
           contents of KORD, and TOL.
    N1=3   Above + difference tables up to highest difference used.
    N1=4   Same as N1=1 + all in storage allocated for differences.
    N2=1   Do not print any variables internal to the integrator.
    N2=2   Print all scalar variables in interpolation common block.
    N2=3   Above + all scalar variables in main integ. common block.
    N2=4   Same as N1=3 + all used in arrays XI,BETA,ALPHA, first
           column of G, GS,RBQ,SIGMA
    N2=5   Same as N1=4 + all used in arrays G,D,DS,V
 LSC    (DIVAMC) Indicates if starting or if noise may be present.
   =k&lt;0 -k steps have been taken for which noise appears to be limiting
        the precision.
   = 0  Usual case
   = 1  Doing 1 derivative per step after initial part of start.
   = 2  Used as flag that it is time to set LSC=0.
   = 3  Third step, hold the order constant.
   = 4  Second step, increase orders from 2 to 3.
   = 5  First step, third time through the first step (if required).
   = 6  First step, second time through.
   = 7  First step, first time through.
   = 8  Set on initialization.
 LTXT?? Names of this form are used in setting up data statements for
   error messages.  These names are generated automatically by PMESS,
   the program that makes up these messages.
 LX     (DIVAA) Used for temporary storage in computing TMARKA().
        ( formal DIVADE)  An integer array containing extra
   information, as follows.
  LX(1) Points to a location in Y beyond those already in use.  Values
        of Y requested are computed at TSPECS(1) - Y(LX(1)) and stored
        starting at Y(LX(1)+1).  If this index is 0, no more extra Y
        values are to be computed.
  LX(2) Index of the first equation for which the Y's above are to be
        computed.  Y(LX(1)+1) will correspond to this first equation
        index.
  LX(3) Index of the last equation for which the Y's above are to be
        computed.  Thus the Y's stored starting at Y(LX(1)+1) will
        require no more space than half the space ordinarily required
        for the array Y(), and may require significantly less.
  LX(4) Maximum number of times to integrate F to get Y.  This should
        be &gt; 0, and less than or equal to the order of the highest
        order differential equation.  (= 0 is allowed, but probably
        not what you want.  It would give a value only for F.)  Space
        must be set aside for all integrals of F, even if not all are
        requested.  For a first order system, all Y's are just the
        first integrals of the corresponding F's.  For higher order
        equations, the first Y associated with a given F is the d-th
        integral of the corresponding F, where d is the order of the
        equation, and the last Y corresponding to the F is the first
        integral of that F.
  LX(5) As for LX(4), but gives the index for the fewest number of
        times to integrate F.  Ordinarily this should be &gt; 0.  If 0 is
        requested, an estimate for the value of F at the delay point is
        computed.  This should not be 0 more than once, for equations
        covering the same index, since later such requests would write
        over the earlier results.
  LX(5i+k) , k = 1, 2, ... 5.  Treated as for the cases above.  If i
        different cases of delayed Y's are to be computed, then
        LX(5i+1) must be 0.
 LX2    (DIVADE) Value of LX(5i+2), when working on the i-th delay.
 MACT   Used in the programs which call the error message program.
   This array difines the actions to be taken by that program.  (In
   (DIVA,A,DA,DE,G,IN,OP)
 MACT0  (DIVADB) Used to call the message program, see MACT.
 MACT?  As for MACT, in (DIVA,CR,DB)
 MACTFV (DIVADB) As for MACT0.
 MAXDIF (DIVASC) Maximum differentiations required for stiff equations.
 MAXINT (DIVASC) Maximum integrations required.  (= max. order of
   differential equations if equations are not stiff.)
 MAXKQ  (DIVA, BU)e
 MAXKQD (DIVAMC) Largest integration order allowed for stiff equations.
 MAXKQI (DIVAMC) Largest integ. order allowed for nonstiff equations.
 ME???? Parameters defining constants used for interaction with the
   error message program MESS.  See comments there for definitions.
   (In DIVA,A,DA,DE,G,IN,OP)
 METHOD (DIVAMC) Defines kind of methods being used.
   = -1  Only stiff equations are being integrated.
   =  0  Only nonstiff equations are being integrated.
   =  1  Both kinds of methods are required.
 MLOC   (DIVA,A,DE) Contains locations in MTEXT for error messages.  In
   DIVAA this data is packed using MLOC??, see below.
 MLOC?? (DIVAA) Parameters constructed to aid in making up packed data
   for processing error messages.  Low two digits give the value of
   KORD1I to use for the error index and later processing, the next two
   give the error severity level, and the rest point to text used for
   the message.
 MODF2  (DIVADB) Used in constructing the same kind of packed data as
   described for LOCF1 above.
 MULTJ  Local to DIVAOP for calls not using F.
 MTEXT  (DIVA,A,CR,IN,OP) Text for error messages.
 MTXT?? (DIVA,A,CR,DA,DB,DE,G,IN,OP) Equivalenced into MTEXT.
 N      Used for temporary storage.  (In DIVAHC,IN,PR)
 NDTF   (DIVASC) Location in F() where difference table starts.
 NE     (DIVAMC) Number of equations in the first group.  (=NTE if
   option 18 is not used.)
 NEDDIG (DIVADB) Parameter = -MEDDIG.
 NEPTOL (DIVAMC) Used for temporary storage and to save the value of
   ITOLEP for error messages.
 NEQ    (formal) Total number of equations being integrated.
 NG     (DIVAMC) Used in DIVAg for the number of g's in the current
   context.
 NGSTOP (DIVAG) Dimension 2 array equivalenced to IOP6, and IOP7.  To
   get the number of interpolating and extrapolating G-Stops.
 NGTOT  (DIVAMC) NGTOT(1) gives the number of interpolating G-Stops,
   and NGTOT(2) gives the number of extrapolating G-Stops.
 NKDKO  (DIVASC) If this is nonzero (option 17), it gives the location
   in KORD() where a vector defining the order of each equation is
   specified.
 NLX    (DIVADE) Temporary index used to keep track of interpolations
   being done to get Y() values for a delay differential equation.
 NOISEQ (DIVAMC) max(2, order of equation for which (error estimate)/
   (error requested) is a maximum).
 NOUTKO (DIVAMC) If nonzero, gives the index in KORD where information
   on what equations are to be included in the diagnostic output is
   given.   See option 10.
 NSTOP  (formal) In DIVAG.  Index of the G-stop, see IFLAG.
 NTE    (DIVASC) Total number of equations being integrated = NEQ.
 NTEXT  (formao DIVADB) Character variable containing heading text.
 NTOLF  (DIVAMC) First location in F() where tolerance specifying
   accuracy desired is stored.
 NUMDT  (DIVASC) Maximum allowed number of differences available for
   doing an integration.
 NXTCHK (DIVA) Equivalenced to INTCHK(1), which gives the next
   available location in INTCHK for storing data on storage allocation.
 NY     (DIVAMC) Total order of the system.
 NYNY   (DIVASC) Location in Y() where the base value for Y() is saved.
 NYNYO  (DIVADE) Equivalenced to the saved value from common of NYNY.
 OUTPUT (formal) Name of subroutine to be called for the output of
   data or for computing G-Stops.  Not used if option 14 is set.
 OVD10  (DIVAEV) (largest floating point number) / 10.
 OVTM75 (DIVAEV) (largest floating point number) *<em> (-.75)
 RBQ    (DIVAMC) Array containing data for the preliminary noise test.
 RD     (formal DIVACO) Array use to contain floating point data from
   common.  Values are returned in locations 1 to 3 as follows.
   1    EMAX =  Max. ratio of estimated error to requested error
   2            Reserved for future use
   3            Reserved for future use
 REF    (DIVACR) Array of length 3 used for translating error tolerance
   type into the factor used for exponential averaging for that type.
 RND    (DIVACR) Usually the current estimated error.  Used in deciding
   if noise is limiting precision.
 RNOISE (DIVACR) Value used in comparison with RBQ() for preliminary
   noise test.
 ROBND  (DIVAMC) Used to influence the selection of integration order.
   The larger ROBND, the harder it is to increase the order and the
   easier it is to decrease it.
 RVC2   (DIVADB) Array used for output of variables DNOISE to SNOISE in
   common block DIVAMC.  These are variables that don't require a great
   deal of precision.
 S      (DIVACR) Estimate of (step size) * eigenvalue of Jacobian.
 SIGMA  (DIVAMC) The k-th entry of this array contains a factor that
   gives the amount the k-th difference is expected to increase if the
   step size in increased.  These numbers get bigger it there is a past
   history of increasing the step size.
 SIGMAS (DIVAA) Saved value of SIGMA(k) from the last step, where k =
   integration order for equation with index KEMAX.
 SNOISE (DIVAMC) Value used in comparison with RBQ() on equation with
   largest value for (error estimate) / (error requested).
 T      (formal) in DIVAIN. T(1) contains the point to be interpolated
   to, and T(2) is used in a check that |HI| &lt;= |T(2)|.  When used by
   other routines in this package, TSPECS is passed in for T.
 TB      (DIVADE) Base time for current interpolation.
 TC      (DIVADE) Original value of TN when getting past Y's for a
   delay differential equation.
 TEMP   Used for temporary storage, in DIVAHC,PR
 TEMPA  (DIVACR) Array equivalenced to (TPS1,TPS2,TPS3,TPS4).
 TEMPAO (DIVACR) Array used to accumulate values in TEMPA.
 TG     (DIVAMC) TG(1) gives the last value of TSPECS(1) for which an
   interpolatory G-Stop has been computed.  TG(2) is defined similarly
   for extrapolatory G-Stops.
 TGSTOP (DIVAMC) TGSTOP(1) gives the value of TSPECS(1) where the last
   0 for an interpolatory G-Stop was found.  TGSTOP(2) is defined
   similarly for extrapolatory G-Stops.
 TMARK  (DIVAMC) Location of the next output point.
 TMARKA (DIVAA)  Array of length 2 equivalenced to TMARK (and TMARKX).
 TMARKX (DIVAMC) Location of the next output point to be found using
   integration or extrapolation.  This variable must follow immediately
   after TMARK in the common block.
 TN     (DIVASC) The value of TSPECS(1) at the conclusion of the last
   step.
 TNEQ   (DIVADB) Array of dimension 1 equivalenced to TN so that an
   array can be passed to </em>MESS.
 TOL    (formal) This is a part of F passed into DIVACR.  The first
   location is the start of the information on the tolerances for error
   control.
 TOLD   (DIVAG) Value of TSPECS(1) on one side of a zero.
 TOLG   (DIVAMC) Tolerance to pass to dzero when locating G-Stops.
 TOUT   (DIVAMC) Location of next output point defined by value of
   TSPECS(3).  Such output is given with KORD(1) = 2.
 TP     (DIVA,A,DA,DE,HC) Used for temporary storage.
 TP1    (DIVAA,DA,HC,IN,PR) Used for temporary storage.
 TP2    (DIVAA,DA,HC,PR) Used for temporary storage.
 TP3    (DIVAA) Used for temporary storage.
 TPD    (DIVABU) Used for temporary storage.
 TPP    (DIVACR) Used for temporary storage.  Usually same as TPS3.
 TPS1   (DIVAA,CR) Used for temporary storage.  (In DIVACR is the
   difference of order KQQ-2)
 TPS2   (DIVAA,CR) Used for temporary storage.  (In DIVACR is the
   difference of order KQQ-1)
 TPS3   (DIVACR) Contains the difference of order KQQ.  This is the
   last difference used in the corrector.
 TPS4   (DIVACR) Contains the difference of order KQQ+1.
 TPS5   (DIVACR) Temporary storage.
 TPS6   (DIVACR) Temporary storage.
 TPS7   (DIVACR) Temporary storage.
 TSAVE  (DIVAG) Value of TSPECS(1) before starting the search for a 0.
 TSPECS (formal DIVA,A,DB,DE,G)
   TSPECS(1) is the current value of the independent variable.
   TSPECS(2) is the current value of the step size.
   TSPECS(3) is the increment to use between output points that give
             output with KORD(1) = 2.
   TSPECS(4) is the "final" output point.
 V      (DIVAMC) Array used in computing integration coefficients.
 XI     (DIVASC) XI(K) = TSPECS(1) - value of TSPECS(1) K steps
   previous.
 W      (DIVAHC) Array used in computing integration coefficients.
 WDE    (formal, DIVADE)  Array used for working storage.  This storage
   is used to save derivative values when iterating to get started.  To
   be safe one should allow as much space as is allowed for differences
   in F.  In most cases the start will not require this much space
   however.  This array is also intended for the support of saving long
   past histories.
 Y      (formal, DIVA,A,CR,DA,DB,DE,G,IN,PR) Array containing the
   independent variable and all derivatives up to order one less than
   the order of the differential equation.  Also use to save these
   values at the beginning of the current step, the base values.
 YN     (formal, in DIVAPR)  Base values of y, these follow the
   current values of the dependent variable, y, in Y().</p>
</blockquote>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tspecs"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>TSPECS</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Y</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kord"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>KORD</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-neq"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>NEQ</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-divaf"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DIVAF</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-divao"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DIVAO</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idimt"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IDIMT</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idimy"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IDIMY</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idimf"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IDIMF</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idimk"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IDIMK</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iopt"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IOPT</strong>(*)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~diva~~CallsGraph Pages: 1 -->
<svg id="procdivaCallsGraph" width="428pt" height="236pt"
 viewBox="0.00 0.00 428.00 236.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~diva~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 232)">
<title>proc~~diva~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-232 424,-232 424,4 -4,4"/>
<!-- proc~diva -->
<g id="proc~~diva~~CallsGraph_node1" class="node">
<title>proc~diva</title>
<polygon fill="none" stroke="black" points="54,-83 0,-83 0,-59 54,-59 54,-83"/>
<text text-anchor="middle" x="27" y="-68.6" font-family="Helvetica,sans-Serif" font-size="10.50">DIVA</text>
</g>
<!-- proc~divaop -->
<g id="proc~~diva~~CallsGraph_node2" class="node">
<title>proc~divaop</title>
<g id="a_proc~~diva~~CallsGraph_node2"><a xlink:href=".././proc/divaop.html" xlink:title="DIVAOP">
<polygon fill="#d9534f" stroke="#d9534f" points="144.5,-145 90.5,-145 90.5,-121 144.5,-121 144.5,-145"/>
<text text-anchor="middle" x="117.5" y="-130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVAOP</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;proc~divaop -->
<g id="proc~~diva~~CallsGraph_edge1" class="edge">
<title>proc~diva&#45;&gt;proc~divaop</title>
<path fill="none" stroke="#000000" d="M45.48,-83.25C58.42,-92.31 76.23,-104.79 90.79,-114.99"/>
<polygon fill="#000000" stroke="#000000" points="89.15,-118.12 99.35,-120.99 93.17,-112.38 89.15,-118.12"/>
</g>
<!-- proc~optchk -->
<g id="proc~~diva~~CallsGraph_node3" class="node">
<title>proc~optchk</title>
<g id="a_proc~~diva~~CallsGraph_node3"><a xlink:href=".././proc/optchk.html" xlink:title="OPTCHK">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-103 90,-103 90,-79 145,-79 145,-103"/>
<text text-anchor="middle" x="117.5" y="-88.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">OPTCHK</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;proc~optchk -->
<g id="proc~~diva~~CallsGraph_edge2" class="edge">
<title>proc~diva&#45;&gt;proc~optchk</title>
<path fill="none" stroke="#000000" d="M54.07,-76.89C62.21,-78.73 71.34,-80.79 80.05,-82.76"/>
<polygon fill="#000000" stroke="#000000" points="79.47,-86.22 90,-85.01 81.02,-79.39 79.47,-86.22"/>
</g>
<!-- proc~mess -->
<g id="proc~~diva~~CallsGraph_node4" class="node">
<title>proc~mess</title>
<g id="a_proc~~diva~~CallsGraph_node4"><a xlink:href=".././proc/mess.html" xlink:title="MESS">
<polygon fill="#d9534f" stroke="#d9534f" points="235,-145 181,-145 181,-121 235,-121 235,-145"/>
<text text-anchor="middle" x="208" y="-130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESS</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;proc~mess -->
<g id="proc~~diva~~CallsGraph_edge3" class="edge">
<title>proc~diva&#45;&gt;proc~mess</title>
<path fill="none" stroke="#000000" d="M54.23,-65.06C78.72,-60.81 115.77,-57.76 145,-70 165.59,-78.62 182.8,-97.79 193.82,-112.73"/>
<polygon fill="#000000" stroke="#000000" points="190.96,-114.75 199.57,-120.92 196.69,-110.73 190.96,-114.75"/>
</g>
<!-- proc~dmess -->
<g id="proc~~diva~~CallsGraph_node5" class="node">
<title>proc~dmess</title>
<g id="a_proc~~diva~~CallsGraph_node5"><a xlink:href=".././proc/dmess.html" xlink:title="DMESS">
<polygon fill="#d9534f" stroke="#d9534f" points="235,-24 181,-24 181,0 235,0 235,-24"/>
<text text-anchor="middle" x="208" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DMESS</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;proc~dmess -->
<g id="proc~~diva~~CallsGraph_edge4" class="edge">
<title>proc~diva&#45;&gt;proc~dmess</title>
<path fill="none" stroke="#000000" d="M46.59,-58.94C58.56,-51.65 74.7,-42.69 90,-37 116.29,-27.22 147.39,-20.81 170.92,-16.92"/>
<polygon fill="#000000" stroke="#000000" points="171.49,-20.38 180.83,-15.36 170.4,-13.46 171.49,-20.38"/>
</g>
<!-- proc~divaop&#45;&gt;proc~mess -->
<g id="proc~~diva~~CallsGraph_edge5" class="edge">
<title>proc~divaop&#45;&gt;proc~mess</title>
<path fill="none" stroke="#000000" d="M144.57,-133C152.78,-133 162,-133 170.78,-133"/>
<polygon fill="#000000" stroke="#000000" points="170.81,-136.5 180.81,-133 170.81,-129.5 170.81,-136.5"/>
</g>
<!-- proc~messgs -->
<g id="proc~~diva~~CallsGraph_node6" class="node">
<title>proc~messgs</title>
<g id="a_proc~~diva~~CallsGraph_node6"><a xlink:href=".././proc/messgs.html" xlink:title="messgs">
<polygon fill="#d94e8f" stroke="#d94e8f" points="327.5,-228 273.5,-228 273.5,-204 327.5,-204 327.5,-228"/>
<text text-anchor="middle" x="300.5" y="-213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">messgs</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messgs -->
<g id="proc~~diva~~CallsGraph_edge6" class="edge">
<title>proc~mess&#45;&gt;proc~messgs</title>
<path fill="none" stroke="#000000" d="M220.38,-145.44C232.44,-158.36 252.3,-178.92 271,-195 272,-195.86 273.02,-196.72 274.07,-197.57"/>
<polygon fill="#000000" stroke="#000000" points="272.25,-200.59 282.3,-203.97 276.55,-195.07 272.25,-200.59"/>
</g>
<!-- proc~messpr -->
<g id="proc~~diva~~CallsGraph_node7" class="node">
<title>proc~messpr</title>
<g id="a_proc~~diva~~CallsGraph_node7"><a xlink:href=".././proc/messpr.html" xlink:title="MESSPR">
<polygon fill="#d9534f" stroke="#d9534f" points="328,-186 273,-186 273,-162 328,-162 328,-186"/>
<text text-anchor="middle" x="300.5" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSPR</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messpr -->
<g id="proc~~diva~~CallsGraph_edge7" class="edge">
<title>proc~mess&#45;&gt;proc~messpr</title>
<path fill="none" stroke="#000000" d="M235.18,-144.86C244.02,-148.87 254.06,-153.42 263.54,-157.71"/>
<polygon fill="#000000" stroke="#000000" points="262.2,-160.94 272.75,-161.88 265.09,-154.57 262.2,-160.94"/>
</g>
<!-- proc~messfi -->
<g id="proc~~diva~~CallsGraph_node8" class="node">
<title>proc~messfi</title>
<g id="a_proc~~diva~~CallsGraph_node8"><a xlink:href=".././proc/messfi.html" xlink:title="MESSFI">
<polygon fill="#d9534f" stroke="#d9534f" points="420,-106 366,-106 366,-82 420,-82 420,-106"/>
<text text-anchor="middle" x="393" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFI</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messfi -->
<g id="proc~~diva~~CallsGraph_edge8" class="edge">
<title>proc~mess&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M235.22,-130.47C259.91,-127.76 297.8,-122.78 330,-115 338.57,-112.93 347.65,-110.18 356.13,-107.36"/>
<polygon fill="#000000" stroke="#000000" points="357.44,-110.61 365.76,-104.05 355.16,-103.99 357.44,-110.61"/>
</g>
<!-- proc~messfd -->
<g id="proc~~diva~~CallsGraph_node9" class="node">
<title>proc~messfd</title>
<g id="a_proc~~diva~~CallsGraph_node9"><a xlink:href=".././proc/messfd.html" xlink:title="MESSFD">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-106 272.5,-106 272.5,-82 328.5,-82 328.5,-106"/>
<text text-anchor="middle" x="300.5" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFD</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messfd -->
<g id="proc~~diva~~CallsGraph_edge9" class="edge">
<title>proc~mess&#45;&gt;proc~messfd</title>
<path fill="none" stroke="#000000" d="M235.18,-121.72C243.86,-117.98 253.68,-113.75 262.99,-109.73"/>
<polygon fill="#000000" stroke="#000000" points="264.64,-112.83 272.44,-105.66 261.87,-106.41 264.64,-112.83"/>
</g>
<!-- proc~messmh -->
<g id="proc~~diva~~CallsGraph_node10" class="node">
<title>proc~messmh</title>
<g id="a_proc~~diva~~CallsGraph_node10"><a xlink:href=".././proc/messmh.html" xlink:title="MESSMH">
<polygon fill="#d9534f" stroke="#d9534f" points="330,-64 271,-64 271,-40 330,-40 330,-64"/>
<text text-anchor="middle" x="300.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSMH</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messmh -->
<g id="proc~~diva~~CallsGraph_edge10" class="edge">
<title>proc~mess&#45;&gt;proc~messmh</title>
<path fill="none" stroke="#000000" d="M220.9,-120.54C233.06,-108.04 252.7,-88.48 271,-73 272,-72.15 273.04,-71.3 274.09,-70.45"/>
<polygon fill="#000000" stroke="#000000" points="276.56,-72.96 282.33,-64.07 272.28,-67.42 276.56,-72.96"/>
</g>
<!-- proc~dmess&#45;&gt;proc~messfi -->
<g id="proc~~diva~~CallsGraph_edge11" class="edge">
<title>proc~dmess&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M235.48,-11.47C261.03,-12.01 300.12,-15.65 330,-31 349.44,-40.99 366.44,-59.37 377.7,-73.7"/>
<polygon fill="#000000" stroke="#000000" points="375.13,-76.11 383.94,-82 380.73,-71.9 375.13,-76.11"/>
</g>
<!-- proc~messfd&#45;&gt;proc~messfi -->
<g id="proc~~diva~~CallsGraph_edge12" class="edge">
<title>proc~messfd&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M328.65,-94C337.11,-94 346.58,-94 355.56,-94"/>
<polygon fill="#000000" stroke="#000000" points="355.8,-97.5 365.8,-94 355.8,-90.5 355.8,-97.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/diva.html#src">DIVA</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">DIVA</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">,</span> <span class="n">NEQ</span><span class="p">,</span> <span class="n">DIVAF</span><span class="p">,</span> <span class="n">DIVAO</span><span class="p">,</span> <span class="n">IDIMT</span><span class="p">,</span>     <span class="p">&amp;</span>
                    <span class="n">IDIMY</span><span class="p">,</span> <span class="n">IDIMF</span><span class="p">,</span> <span class="n">IDIMK</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">)</span>

      <span class="k">use </span><span class="n">divaev_module</span>
      <span class="k">use </span><span class="n">diva_constants</span>
      <span class="k">use </span><span class="n">divasc_module</span>
      <span class="k">use </span><span class="n">divamc_module</span>

      <span class="kt">integer </span><span class="n">NEQ</span><span class="p">,</span> <span class="n">IDIMT</span><span class="p">,</span> <span class="n">IDIMY</span><span class="p">,</span> <span class="n">IDIMF</span><span class="p">,</span> <span class="n">IDIMK</span>
      <span class="kt">integer </span><span class="n">KORD</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">IOPT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="kt">double precision </span><span class="n">TSPECS</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">Y</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="kt">double precision </span><span class="n">F</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="k">external </span><span class="n">DIVAF</span><span class="p">,</span> <span class="n">DIVAO</span>

      <span class="kt">integer </span><span class="n">KGO</span><span class="p">,</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">30</span><span class="p">),</span> <span class="n">NXTCHK</span>
      <span class="kt">integer </span><span class="n">IHI</span><span class="p">,</span> <span class="n">JL</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">ILOW</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">KQQ</span><span class="p">,</span> <span class="n">JLIM</span><span class="p">,</span> <span class="n">KFERR</span>
<span class="c">!</span>
      <span class="k">equivalence</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">NXTCHK</span><span class="p">)</span>

      <span class="kt">double precision</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">CM1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.D0</span>

      <span class="kt">integer </span><span class="n">IOPIVA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">save </span><span class="n">IOPIVA</span>
<span class="c">!</span>
<span class="c">!                      Declarations for error message processing.</span>
<span class="c">!</span>
      <span class="kt">character </span><span class="n">TEXT1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>

      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MENTXT</span> <span class="o">=</span> <span class="mi">23</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIDAT</span> <span class="o">=</span> <span class="mi">24</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDA1</span> <span class="o">=</span> <span class="mi">27</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MECONT</span> <span class="o">=</span> <span class="mi">50</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MERET</span>  <span class="o">=</span> <span class="mi">51</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEEMES</span> <span class="o">=</span> <span class="mi">52</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">METEXT</span> <span class="o">=</span> <span class="mi">53</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIVEC</span> <span class="o">=</span> <span class="mi">57</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">MACT</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">MLOC</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">MACT1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">! ********* Error message text ***************</span>
<span class="c">![Last 2 letters of Param. name]  [Text generating message.]</span>
<span class="c">!AA DIVA$B</span>
<span class="c">!AB The interval [1, 10**6], bounds the allowed values for NTE=$I.$E</span>
<span class="c">!AC For option $I, the interval [$I, $I], bounds the allowed $C</span>
<span class="c">!   values for the integration order which is set to $I.$E</span>
<span class="c">!AD Option 16 must be used for error control.$E</span>
<span class="c">!AE F($I) = $F, but it must be -1.0 when skipping the error check.$E</span>
<span class="c">!AF For option $I, the interval [$I, $I] bounds the allowed $C</span>
<span class="c">!   values for KORD($I)=$I, which is used to specify an $B</span>
<span class="c">!AG output type for printing.$E</span>
<span class="c">!AH output group for printing.$E</span>
<span class="c">!AI equation group for variational equations.$E</span>
<span class="c">!AJ order for a differential equation.$E</span>
<span class="c">!AK equation group for diagnostic print.$E</span>
<span class="c">!AL equation group for integration order control.$E</span>
<span class="c">!AM equation group for error control.$E</span>
<span class="c">!AN Option 5 argument must be &lt;= 0 or &gt; 4.$E</span>
<span class="c">!   $</span>
<span class="c">!AO KORD values for this option starting at KORD($M) are:$E</span>

     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAA</span> <span class="o">=</span>   <span class="mi">1</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAB</span> <span class="o">=</span>   <span class="mi">7</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAC</span> <span class="o">=</span>  <span class="mi">71</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAD</span> <span class="o">=</span> <span class="mi">183</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAE</span> <span class="o">=</span> <span class="mi">226</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAF</span> <span class="o">=</span> <span class="mi">290</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAG</span> <span class="o">=</span> <span class="mi">400</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAH</span> <span class="o">=</span> <span class="mi">427</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAI</span> <span class="o">=</span> <span class="mi">455</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAJ</span> <span class="o">=</span> <span class="mi">498</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAK</span> <span class="o">=</span> <span class="mi">535</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAL</span> <span class="o">=</span> <span class="mi">573</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAM</span> <span class="o">=</span> <span class="mi">620</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAN</span> <span class="o">=</span> <span class="mi">655</span>
     <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LTXTAO</span> <span class="o">=</span>   <span class="mi">1</span>

      <span class="kt">character </span><span class="n">MTXTAA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">233</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">MTXTAB</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">55</span><span class="p">)</span>
      <span class="k">data </span><span class="n">MTXTAA</span><span class="o">/</span><span class="s1">&#39;DIVA$BThe interval [1, 10**6], bounds the allowed val&amp;</span>
<span class="s1">     &amp;ues for NTE=$I.$EFor option $I, the interval [$I, $I], bounds the$&amp;</span>
<span class="s1">     &amp; allowed values for the integration order which is set to $I.$EOpt&amp;</span>
<span class="s1">     &amp;ion 16 must be used for error control.$EF($I) = &#39;</span><span class="p">,</span><span class="s1">&#39;$F, but it must&amp;</span>
<span class="s1">     &amp; be -1.0 when skipping the error check.$EFor option $I, the interv&amp;</span>
<span class="s1">     &amp;al [$I, $I] bounds the allowed values for KORD($I)=$I, which is us&amp;</span>
<span class="s1">     &amp;ed to specify an $Boutput type for printing.$Eoutput group for pri&amp;</span>
<span class="s1">     &amp;nting.$Eequation gro&#39;</span><span class="p">,</span><span class="s1">&#39;up for variational equations.$Eorder for a$&amp;</span>
<span class="s1">     &amp; differential equation.$Eequation group for diagnostic print.$Eequ&amp;</span>
<span class="s1">     &amp;ation group for integration order control.$Eequation group for err&amp;</span>
<span class="s1">     &amp;or control.$EOption 5 argument must be &lt;= 0 or &gt; 4.$E&#39;</span><span class="o">/</span>
      <span class="k">data </span><span class="n">MTXTAB</span><span class="o">/</span><span class="s1">&#39;KORD values for this option starting at KORD($M) are:&amp;</span>
<span class="s1">     &amp;$E&#39;</span><span class="o">/</span>

<span class="c">! End of automatically generated error message code.</span>
<span class="c">!</span>
<span class="c">!        for KGO =     1      2      3      4      5      6      7</span>
      <span class="k">data </span><span class="n">MLOC</span> <span class="o">/</span> <span class="n">LTXTAI</span><span class="p">,</span><span class="n">LTXTAK</span><span class="p">,</span><span class="n">LTXTAL</span><span class="p">,</span><span class="n">LTXTAM</span><span class="p">,</span><span class="n">LTXTAJ</span><span class="p">,</span><span class="n">LTXTAG</span><span class="p">,</span><span class="n">LTXTAH</span><span class="p">,</span>     <span class="p">&amp;</span>
     <span class="p">&amp;</span>            <span class="n">LTXTAB</span><span class="p">,</span><span class="n">LTXTAC</span><span class="p">,</span><span class="n">LTXTAD</span><span class="p">,</span><span class="n">LTXTAE</span><span class="p">,</span> <span class="n">LTXTAN</span> <span class="o">/</span>
<span class="c">!           KGO        8      9     10     11      12</span>
<span class="c">!</span>
<span class="c">!                      1  2  3 4       5  6       7       8       9 10</span>
      <span class="k">data </span><span class="n">MACT</span> <span class="o">/</span> <span class="n">MEEMES</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">MENTXT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">METEXT</span><span class="p">,</span> <span class="n">MECONT</span><span class="p">,</span> <span class="n">MEMDA1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>  <span class="n">METEXT</span><span class="p">,</span> <span class="n">MEIDAT</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">MEIVEC</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">MECONT</span> <span class="o">/</span>
<span class="c">!           11      12 13     14 15     16</span>
      <span class="k">data </span><span class="n">MACT1</span> <span class="o">/</span> <span class="n">METEXT</span><span class="p">,</span> <span class="n">MEIVEC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MERET</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">IOPIVA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1111</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">TEXT1</span> <span class="o">/</span> <span class="s1">&#39;IOPT()= $B&#39;</span> <span class="o">/</span>
<span class="c">!</span>
<span class="c">! ************** START OF EXECUTABLE CODE ******************</span>
<span class="c">!</span>
<span class="c">!     **** TEST IF CONTINUING AN INTEGRATION</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">330</span>
<span class="c">!     **** INITIALIZE VARIOUS SCALARS</span>
      <span class="n">KSTEP</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KQMXIS</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="n">NTE</span> <span class="o">=</span> <span class="n">NEQ</span>
      <span class="n">NE</span> <span class="o">=</span> <span class="n">NTE</span>
      <span class="n">TOLG</span> <span class="o">=</span> <span class="mf">0.D0</span>
<span class="c">!     **** SET UP OPTIONS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOPT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">DIVAOP</span><span class="p">(</span><span class="n">IOPT</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
      <span class="k">call </span><span class="n">DIVAOP</span><span class="p">(</span><span class="n">IOPIVA</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOPT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">IOPIVA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c">!</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">NE</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">NE</span> <span class="o">&gt;</span> <span class="mi">1000000</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         </span><span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NE</span>
         <span class="n">KGO</span> <span class="o">=</span> <span class="mi">8</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">650</span>
      <span class="k">end if</span>
<span class="c">!                         Set up diagnostic print on storage allocation.</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">245</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP10</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">INTCHK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">247</span>
<span class="c">!</span>
<span class="c">!     **** CHECK TSPECS STORAGE ALLOCATION</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDIMT</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP5</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">INTCHK</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">IOP5</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">INTCHK</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">IOP5</span> <span class="o">-</span> <span class="mi">4</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">IOP5</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">KGO</span> <span class="o">=</span> <span class="mi">12</span>
               <span class="n">go</span> <span class="n">to</span> <span class="mi">600</span>
            <span class="k">end if</span>
<span class="k">         else</span>
<span class="k">            </span><span class="n">IHI</span> <span class="o">=</span> <span class="o">-</span><span class="n">IOP5</span>
            <span class="n">JL</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">do </span><span class="mi">15</span> <span class="n">IHI</span> <span class="o">=</span> <span class="n">IHI</span><span class="p">,</span> <span class="n">IDIMK</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span>
               <span class="n">J</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="p">))</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">20</span>
               <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                  <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
                  <span class="n">KGO</span> <span class="o">=</span> <span class="mi">6</span>
                  <span class="n">go</span> <span class="n">to</span> <span class="mi">600</span>
               <span class="k">end if</span>
<span class="k">               if</span> <span class="p">((</span><span class="n">J</span> <span class="o">&lt;=</span> <span class="n">JL</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">J</span> <span class="o">&gt;</span> <span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">KGO</span> <span class="o">=</span> <span class="mi">7</span>
                  <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">JL</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                  <span class="n">go</span> <span class="n">to</span> <span class="mi">610</span>
               <span class="k">end if</span>
<span class="k">               </span><span class="n">JL</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
   <span class="mi">15</span>       <span class="k">continue</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">IHI</span> <span class="o">=</span> <span class="n">IHI</span> <span class="o">+</span> <span class="mi">3</span>
   <span class="mi">20</span>       <span class="n">INTCHK</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">JL</span> <span class="o">-</span> <span class="mi">4</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">7</span>
      <span class="k">end if</span>
<span class="k">   </span><span class="mi">25</span> <span class="k">call </span><span class="n">OPTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">,</span> <span class="s1">&#39;DIVA / TSPECS$E&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">NXTCHK</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="c">!</span>
<span class="c">!     **** CHECK KORD STORAGE ALLOCATION</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDIMK</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">NE</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP5</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">INTCHK</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">IOP5</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">IHI</span> <span class="o">+</span> <span class="n">IOP5</span>
         <span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">7</span>
      <span class="k">end if</span>
<span class="c">!</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP18</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">NE</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="n">IOP18</span><span class="p">))</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">18</span>
         <span class="n">ILOW</span> <span class="o">=</span> <span class="n">IOP18</span>
         <span class="n">KGO</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c">!.       **** CHECK OPTION FOR VALID INPUT</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
      <span class="k">end if</span>
<span class="c">!++  End</span>
   <span class="mi">30</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">NKDKO</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                        **** STORAGE ALLOCATED FOR ODE ORDERS</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">17</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NKDKO</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">NTE</span>
         <span class="n">NXTCHK</span> <span class="o">=</span> <span class="n">NXTCHK</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="k">end if</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      IF (IOPST /= 0) then</span>
<span class="c">!         INTCHK(NXTCHK) = 17</span>
<span class="c">!         INTCHK(NXTCHK+1) = IOPST</span>
<span class="c">!         INTCHK(NXTCHK+2) = NTE</span>
<span class="c">!         NXTCHK = NXTCHK + 3</span>
<span class="c">!      end if</span>
<span class="c">!++  End</span>
<span class="c">!</span>
<span class="c">! **** SET INITIAL INTEGRATION ORDERS, TEST ODE ORDERS ****</span>
<span class="c">!</span>
      <span class="n">MAXINT</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">MAXDIF</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">NY</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">do </span><span class="mi">80</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTE</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">NKDKO</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KORDI</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">NKDKO</span> <span class="o">+</span> <span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
         <span class="n">NY</span> <span class="o">=</span> <span class="n">NY</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">KORDI</span><span class="p">)</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      IF (IOPST == 0) GO TO 60</span>
<span class="c">!c.    **** CHECK FOR POTENTIAL STIFF EQUATION</span>
<span class="c">!      JS = abs(KORD(IOPST+K-1)) - 1</span>
<span class="c">!      IF ( JS ) 52,60,54</span>
<span class="c">!c.    **** EQUATION IS NOT ACTIVE</span>
<span class="c">!   52 KQQ = 0</span>
<span class="c">!      GO TO 56</span>
<span class="c">!c.    **** EQUATION USES IMPLICIT METHOD</span>
<span class="c">!   54 KQQ = -1</span>
<span class="c">!      IF (JS &gt; abs(KORDI)) then</span>
<span class="c">!        Set up an error message.</span>
<span class="c">!      end if</span>
<span class="c">!      MAXINT = max(MAXINT, abs(KORDI) - JS)</span>
<span class="c">!   56 IF (KORDI &gt;= 0) GO TO 70</span>
<span class="c">!      KORDI = -1 - KORDI</span>
<span class="c">!      JS = JS - 1</span>
<span class="c">!      MAXDIF = max(MAXDIF, JS, 1)</span>
<span class="c">!      GO TO 70</span>
<span class="c">!++  End</span>
<span class="c">!     **** EQUATION IS TO USE AN EXPLICIT METHOD</span>
   <span class="mi">60</span>    <span class="n">KQQ</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="n">MAXINT</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">MAXINT</span><span class="p">,</span> <span class="n">KORDI</span><span class="p">)</span>
   <span class="mi">70</span>    <span class="k">if</span> <span class="p">((</span><span class="n">KORDI</span> <span class="o">&gt;</span> <span class="n">MAXORD</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">KORDI</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<span class="c">!                    Set up error message.  KORDI is out of range.</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">17</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">MAXORD</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">NKDKO</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">KGO</span> <span class="o">=</span> <span class="mi">5</span>
               <span class="n">ILOW</span> <span class="o">=</span> <span class="n">NKDKO</span>
               <span class="n">IHI</span> <span class="o">=</span> <span class="n">NKDKO</span> <span class="o">+</span> <span class="n">K</span> <span class="o">-</span> <span class="mi">1</span>
               <span class="n">go</span> <span class="n">to</span> <span class="mi">640</span>
            <span class="k">else</span>
<span class="k">               </span><span class="n">KGO</span> <span class="o">=</span> <span class="mi">9</span>
               <span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORDI</span>
               <span class="n">go</span> <span class="n">to</span> <span class="mi">650</span>
            <span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">         </span><span class="n">KORD</span><span class="p">(</span><span class="n">K</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">KQQ</span>
   <span class="mi">80</span> <span class="k">continue</span>
<span class="c">!     **** SET FLAGS WHICH DEPEND ON METHOD USED</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      METHOD = 1</span>
<span class="c">!      IF (MAXINT &gt; 0) IF (MAXDIF) 85,90,85</span>
<span class="c">!      METHOD = -1</span>
<span class="c">!   85 CONTINUE</span>
<span class="c">!      KPRED = 5</span>
<span class="c">!      GO TO 100</span>
<span class="c">!++  End</span>
   <span class="mi">90</span> <span class="n">METHOD</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KPRED</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="mi">100</span> <span class="k">continue</span>
<span class="c">!</span>
<span class="c">! ******* CHECK KORD FOR DIAGNOSTIC OUTPUT CONTROL *********</span>
<span class="c">!</span>
<span class="c">!++  Code for OUTPUT is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP10</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">NOUTKO</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">ILOW</span> <span class="o">=</span> <span class="n">NOUTKO</span>
<span class="c">!.    **** Check option for valid input</span>
            <span class="n">KGO</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="c">!++  End</span>
  <span class="mi">110</span> <span class="k">continue</span>
<span class="c">!</span>
<span class="c">! ********** CHECK KORD FOR INTEGRATION ORDER CONTROL ******</span>
<span class="c">!</span>
<span class="c">!++  Code for INTEGO is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP19</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!.           **** Check option for valid input</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">19</span>
         <span class="n">ILOW</span> <span class="o">=</span> <span class="n">IOP19</span>
         <span class="n">JLIM</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
         <span class="n">KGO</span> <span class="o">=</span> <span class="mi">3</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
      <span class="k">end if</span>
<span class="c">!++  End</span>
  <span class="mi">120</span> <span class="k">continue</span>
<span class="c">!</span>
<span class="c">! ********** CHECK SET UP FOR ERROR TOLERANCES *************</span>
<span class="c">!</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">16</span>
      <span class="n">ILOW</span> <span class="o">=</span> <span class="n">IOP16</span>
      <span class="n">JLIM</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
      <span class="n">KGO</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP16</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
<span class="c">!.                      **** IN CURRENT CODE, IOP16=0 IS AN ERROR</span>
      <span class="n">KGO</span> <span class="o">=</span> <span class="mi">10</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">650</span>
  <span class="mi">150</span> <span class="k">continue</span>
<span class="c">!     **** CHECK KORD STORAGE ALLOCATION</span>
      <span class="k">call </span><span class="n">OPTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">,</span> <span class="s1">&#39;DIVA / KORD$E&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">NXTCHK</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="c">!</span>
<span class="c">!     ******** DONE CHECKING KORD STORAGE ALLOCATION *******</span>
<span class="c">!</span>
<span class="c">!     **** CHECK  Y  STORAGE ALLOCATION</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDIMY</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">NY</span> <span class="o">+</span> <span class="n">NY</span>
      <span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">NYNY</span> <span class="o">=</span> <span class="n">NY</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="k">call </span><span class="n">OPTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">,</span> <span class="s1">&#39;DIVA / Y$E&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">NXTCHK</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="c">!</span>
<span class="c">!     **** CHECK  F  STORAGE ALLOCATION</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDIMF</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">NTE</span>
      <span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP16</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                                Error tolerance info.</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">16</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">NTOLF</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">IHI</span> <span class="o">-</span> <span class="n">IOP16</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="n">NXTCHK</span> <span class="o">=</span> <span class="mi">7</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">IOP12</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">12</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">IOP12</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span>
         <span class="n">NXTCHK</span> <span class="o">=</span> <span class="n">NXTCHK</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">IOP21</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">21</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">IOP21</span>
         <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="n">NXTCHK</span> <span class="o">=</span> <span class="n">NXTCHK</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="k">end if</span>
<span class="c">!</span>
<span class="c">!++  Code for ERRSTO is inactive</span>
<span class="c">!      IF (IOP20 /= 0) then</span>
<span class="c">!c.                                Space for saving error estimates</span>
<span class="c">!         INTCHK(NXTCHK) = 20</span>
<span class="c">!         INTCHK(NXTCHK) = IOP20</span>
<span class="c">!         INTCHK(NXTCHK) = NTE</span>
<span class="c">!         NXTCHK = NXTCHK + 3</span>
<span class="c">!      end if</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      if (IOP21 &gt; 0) then</span>
<span class="c">!c.                               Info. for stiff equations</span>
<span class="c">!         INTCHK(NXTCHK) = 21</span>
<span class="c">!         INTCHK(NXTCHK+1) = IOP21</span>
<span class="c">!         INTCHK(NXTCHK+2) = IOP21S</span>
<span class="c">!         NXTCHK = NXTCHK + 3</span>
<span class="c">!      end if</span>
<span class="c">!      MAXKQD = min(MAXKQI, 6)</span>
<span class="c">!++  End</span>
<span class="c">!                          Set aside space for the difference tables.</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">KDIM</span> <span class="o">*</span> <span class="n">NTE</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">NXTCHK</span> <span class="o">=</span> <span class="n">NXTCHK</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">NTE</span>
      <span class="k">call </span><span class="n">OPTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">,</span> <span class="s1">&#39;DIVA / F$E&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">NXTCHK</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
      <span class="k">else if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">/=</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         do </span><span class="mi">290</span> <span class="n">K</span> <span class="o">=</span> <span class="n">NXTCHK</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">NDTF</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">NUMDT</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">KDIM</span><span class="p">,</span> <span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">INTCHK</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">NDTF</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">NTE</span><span class="p">)</span>
               <span class="n">MAXKQI</span> <span class="o">=</span> <span class="n">NUMDT</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">else</span>
<span class="c">!         Take a quick return if needed space was not specified by user.</span>
               <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
            <span class="k">end if</span>
<span class="k">  </span><span class="mi">290</span>    <span class="k">continue</span>
<span class="k">      end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">IOP9</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">IOP10</span><span class="p">)</span> <span class="o">+</span> <span class="n">IOP11</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="c">! Insure user doesn&#39;t get in trouble with F not iniitalized.</span>
         <span class="k">do </span><span class="mi">300</span> <span class="n">K</span> <span class="o">=</span> <span class="n">NDTF</span><span class="p">,</span> <span class="n">NDTF</span> <span class="o">+</span> <span class="n">NTE</span><span class="o">*</span><span class="n">NUMDT</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">F</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.D0</span>
  <span class="mi">300</span>    <span class="k">continue</span>
<span class="k">      end if</span>
<span class="k">  </span><span class="mi">320</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">((</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">IOP10</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         </span><span class="n">MACT1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">IOPIVA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
         <span class="k">call </span><span class="n">MESS</span><span class="p">(</span><span class="n">MACT1</span><span class="p">,</span> <span class="n">TEXT1</span><span class="p">,</span> <span class="n">IOPT</span><span class="p">)</span>
         <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">24</span>
         <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">24</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">TMARK</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">TMARKX</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!     **** DONE WITH INITIALIZATION AND CHECKING INPUTS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP13</span> <span class="o">+</span> <span class="n">IOP14</span> <span class="o">+</span> <span class="n">IOP15</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<span class="k">  </span><span class="mi">330</span> <span class="k">call </span><span class="n">DIVAA</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">,</span> <span class="n">DIVAF</span><span class="p">,</span> <span class="n">DIVAO</span><span class="p">)</span>
      <span class="k">return</span>
<span class="c">!</span>
<span class="c">! ************ LOOP TO CHECK OPTION SPECIFICATIONS *********</span>
<span class="c">!</span>
  <span class="mi">430</span> <span class="n">JL</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">do </span><span class="mi">560</span> <span class="n">IHI</span> <span class="o">=</span> <span class="n">ILOW</span><span class="p">,</span> <span class="n">IDIMK</span>
         <span class="n">J</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="p">)</span>
         <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">460</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">490</span><span class="p">,</span> <span class="mi">490</span><span class="p">),</span> <span class="n">KGO</span>
<span class="c">!     **** CHECK ON VARIATIONAL EQUATIONS</span>
  <span class="mi">460</span>    <span class="k">continue</span>
<span class="c">!++  Code for VAREQ is active</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">-</span> <span class="n">NTE</span><span class="p">)</span> <span class="mi">470</span><span class="p">,</span> <span class="mi">565</span><span class="p">,</span> <span class="mi">620</span>
  <span class="mi">470</span>    <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">560</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">&lt;=</span> <span class="n">JL</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">620</span>
<span class="c">!++  End</span>
<span class="c">!     **** Check on diagnostic output option</span>
  <span class="mi">480</span>    <span class="k">continue</span>
<span class="c">!++  Code for OUTPUT is active</span>
<span class="c">!.    **** CHECK IF DONE</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">&gt;=</span> <span class="n">NTE</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">565</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">&lt;=</span> <span class="n">JL</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">620</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">550</span>
<span class="c">!++  End</span>
  <span class="mi">490</span>    <span class="k">continue</span>
<span class="c">!     **** Check integration order control (KGO=3) and</span>
<span class="c">!     **** error tolerance equation grouping (KGO=4).</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">-</span> <span class="n">NTE</span><span class="p">)</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">565</span><span class="p">,</span> <span class="mi">620</span>
  <span class="mi">500</span>    <span class="k">if</span> <span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="mi">510</span><span class="p">,</span> <span class="mi">530</span><span class="p">,</span> <span class="mi">540</span>
  <span class="mi">510</span>    <span class="k">if</span> <span class="p">((</span><span class="n">JL</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">IHI</span> <span class="o">/=</span> <span class="n">ILOW</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">620</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">&lt;</span> <span class="n">JLIM</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                         Output an error message.</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">JLIM</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">go</span> <span class="n">to</span> <span class="mi">630</span>
         <span class="k">end if</span>
<span class="k">  </span><span class="mi">520</span>    <span class="n">JL</span> <span class="o">=</span> <span class="o">-</span><span class="n">JL</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">560</span>
  <span class="mi">530</span>    <span class="k">if</span> <span class="p">(</span><span class="n">KGO</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">520</span>
         <span class="n">KFERR</span> <span class="o">=</span> <span class="n">NTOLF</span> <span class="o">+</span> <span class="n">IHI</span> <span class="o">-</span> <span class="n">ILOW</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">KFERR</span><span class="p">)</span> <span class="o">==</span> <span class="n">CM1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">510</span>
<span class="c">!                         Set up error message, TOL must be -1.</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KFERR</span>
            <span class="n">KGO</span> <span class="o">=</span> <span class="mi">11</span>
            <span class="n">go</span> <span class="n">to</span> <span class="mi">650</span>
  <span class="mi">540</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">JL</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">J</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">620</span>
  <span class="mi">550</span>    <span class="n">JL</span> <span class="o">=</span> <span class="n">J</span>
  <span class="mi">560</span>    <span class="k">continue</span>
<span class="k">  </span><span class="mi">565</span> <span class="n">NXTCHK</span> <span class="o">=</span> <span class="n">NXTCHK</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ILOW</span>
      <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">IHI</span> <span class="o">-</span> <span class="n">ILOW</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="n">KGO</span>
<span class="c">!</span>
<span class="c">!     **** AN ERROR HAS BEEN MADE</span>
<span class="c">!                  Error in setting up TSPECS for extra output</span>
  <span class="mi">600</span> <span class="n">IHI</span> <span class="o">=</span> <span class="n">IHI</span> <span class="o">+</span> <span class="mi">2</span>
  <span class="mi">610</span> <span class="n">ILOW</span> <span class="o">=</span> <span class="o">-</span><span class="n">IOP5</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">630</span>
<span class="c">!                  Error in KORD indices</span>
  <span class="mi">620</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">JL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">NTE</span>
<span class="c">!                  Set up for print of message about KORD</span>
  <span class="mi">630</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">INTCHK</span><span class="p">(</span><span class="n">NXTCHK</span><span class="p">)</span>
  <span class="mi">640</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">IHI</span>
      <span class="n">IDAT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">IHI</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">! ***************** Process Errors *************************************</span>
<span class="c">!</span>
  <span class="mi">650</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">LTXTAF</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KGO</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">)</span> <span class="n">MACT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">MLOC</span><span class="p">(</span><span class="n">KGO</span><span class="p">)</span>
      <span class="k">CALL </span><span class="n">DMESS</span><span class="p">(</span><span class="n">MACT</span><span class="p">,</span> <span class="n">MTXTAA</span><span class="p">,</span> <span class="n">IDAT</span><span class="p">,</span> <span class="n">FDAT</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KGO</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">MACT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">ILOW</span>
         <span class="n">MACT</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="n">ILOW</span>
         <span class="n">MACT</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">IHI</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">IDIMK</span><span class="p">)</span>
         <span class="k">CALL </span><span class="n">MESS</span><span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">MTXTAB</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">KGO</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">565</span>
      <span class="k">end if</span>
<span class="c">!              5   6   7    8    9   10   11  12</span>
      <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">KGO</span> <span class="o">-</span> <span class="mi">4</span>
  <span class="mi">660</span> <span class="n">KGO</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">565</span>
    <span class="k">end subroutine </span><span class="n">diva</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> diva was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>