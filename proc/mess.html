<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Edition of DIVA">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>MESS &ndash; diva</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">diva </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>MESS
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="20.0% of total for procedures.">785 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/messages_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/messages_module.f90.html'>messages_module.f90</a></li>
    
     <li><a href='../module/messages_module.html'>messages_module</a></li>
    
  
     <li class="active">MESS</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-0">Common Blocks</a></h3></div>
  <div id="common-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/mess.html#common-cmessi~2">CMESSI</a>
      
      <a class="list-group-item" href="../proc/mess.html#common-cmessc~2">CMESSC</a>
      
    </div>
  </div>
</div>





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/mess.html#src">MESS</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine MESS(MACT, TEXT, IDAT)
    
    
   
</h2>
    
  


    
    <p>Processes Messages -- Actions are controlled by MACT().</p>
<p>This routine is intended for use primarily by other library routines.
 Users of library routines may want to use values of MACT from MERET-
 MESUNI, and may have an interest in using it to print messages
 from their own software.
 This routine has companion routines that are called with the same
 three arguments, plus one additional argument.  This argument is
 referred to here as FDAT since actions specified here can result
 in returns to print data from FDAT.  The name FDAT is used because
 this other routine will ordinarily print floating point data, but
 it could also print other kinds of data, e.g. logical.  At present
 only SMESS and DMESS are defined which are for single and double
 precision floating point data.
 MACT is a vector specifying sequentially the actions desired.
 Some of these actions require more than one location, in which
 case the next action follows the last datum required by the
 previous action.  Internal variables together with default
 values in parentheses which are used to keep track of locations
 are as follows:
  NTEXT  (1)   The next text output starts at TEXT(NTEXT).
  NIDAT  (1)   The next output from IDAT starts at IDAT(NIDAT).
  NFDAT  (1)   The next output from FDAT starts at FDAT(NFDAT).
  NMDAT  (1)   The next output from MDAT starts at MDAT(NMDAT), where
               MDAT is defined by actions MEMDA1-MEMDA5 below, and
               NMDAT is set to one at end of every text output.
 An action which uses data pointed to by one of the above will cause
 the pointer to be incremented to one past the last location used.  An
 exception is NMDAT which when it reaches 5 is not incremented and the
 value pointed to is incremented instead.
 Actions are encoded by values starting in MACT(1) as follows.
 (Arguments required are given in parentheses at the start of
 description.  These arguments follow the action index.  The next
 action follows the last argument for the preceding action.  Action
 indices have been selected so that it is easy to add new functionality
 without affecting codes using an earlier version.  Where bounds are
 indicated for an argument, if the argument is outside the bounds it is
 treated as if it had the value for the bound violated.)
 MESUNI=10  (0 &lt;= K10 &lt;= 99) Set the unit to use for a scratch
            file.  The default unit for a scratch file is 30.  If a
            scratch file is needed, (only needed here if a table
            exceeds the line length), and unit 30 can not be opened as
            a new scratch file, then units 29, 28, ..., will be tried
            until an acceptable unit is found.  Library routines may
            use this file but must be sure that the use does not
            conflict with the printing of tables here, or the use by
            any other library routines.  If K10 is 0, a scratch unit is
            assumed not to be available, and tables with long lines
            will be printed with each line on multiple lines.
 MEHEAD=11  (0 &lt;= K11 &lt;= 1) Defines the print that surrounds an
            error message.  K11=0 gives nothing, and 1 gives the first
            4 characters in TEXT repeated 18 times.  If this is not
            used, one gets 72 $'s.  (To get a blank line use 1 with
            TEXT = '    '.)
 MEDDIG=12  (-50 &lt;= K12 &lt;= 50) Set default digits to print for
            floating point.  If K12 &gt; 0 then K12 significant digits
            will be printed, if K12 &lt; 0, then -K12 digits will be
            printed after the decimal point, and if K12 = 0, the
            default will be used, which is the full machine precision.
            Setting or getting this value will only work properly if
            the action is taken by calling SMESS or DMESS as
            appropriate.
 MEMLIN=13  (39 &lt;= K13 &lt;= 500) Set message line length to K13.
            (Default is 128.)
 MEELIN=14  (39 &lt;= K14 &lt;= 500) Set error message line length to
            K14. (Default is 79)
 MEMUNI=15  (-99 &lt;= K15 &lt;= 99) Messages go to unit K15.  If K15 = 0
            (default), 'print' is used.  If K15 &lt; 0, messages go to
            both 'print' and to unit abs(K15).  If a write can not be
            done to unit abs(K15), this unit will be opened with file
            name MESS_Fxx.tmp, where xx is the value of abs(K15).
 MEEUNI=16  (-99 &lt;= K16 &lt;= 99) As for MEMUNI, except for Error
            Messages.
 MESCRN=17  (0 &lt;= K17 &lt;= 100000000) Set number of lines to print to
            standard output before pausing for "go" from user.  Default
            is 0, which never stops.
 MEDIAG=18  (0 &lt;= K18 &lt;= 1000000000) Set the diagnostic level
            desired.  This routine makes no use of K18.  It merely
            serves as a place to set it and to answer inquiries on its
            value.  It is intended to be set by users of library
            software.  Library packages that make use of this number
            are expected to use it as described below.  If K18 = 0 (the
            default), no diagnostic print is being requested.  Else m =
            mod(K18, 256) determines whether a package will do
            diagnostic printing.  Associated with a library package is
            a number L which must be a power of 2 &lt; 129, and which
            should be mentioned in the documentation for the package.
            If the bit logical or(m,L) = L then diagnostic output for
            the routine with the associated value of L is activated.
            The value of L should have been selected by the following
            somewhat vague rules.  Let base 2 log(L) = 2<em>i + j, where j
            is 0 or 1.  Select i = level of the library package, where
            the level is 0 if no other library routine that is likely
            to be used with the package could reasonably be expected to
            want any embedded diagnostics, and otherwise is
            min(4, I+1), where I is the maximum level for any library
            routine which is likely to be used with the package.
            Select j = 0 if the user is relatively unlikely to want
            diagnostics, and j = 1, if this is a routine for which
            considering its level the user is relatively likely to want
            diagnostic output.  The next 8 bits, mod(K18/256, 256), may
            be used by the library routine to select the actual output
            that is to be given.  These bits may be ignored,  but if
            they are used, the lowest order bits should correspond to
            less voluminous output that is more likely to be requested.
            Finally, K18 / (2</em><em>16) may be used to give a count on how
            many times to print the diagnostics that are given.  This
            count may be interpreted by library routines in slightly
            different ways, but when used it should serve to turn off
            all output after a certain limit is reached.  By
            convention, if this is 0 there is no upper bound on the
            count.
 MEMAXE=19  (0 &lt;= K19 &lt;= 1000000000) Set the maximum error value.
            When retrieving this value, it is the maximum value seen
            for 10000</em>s + 1000*p + i, where s, p, and i are the stop
            and print levels, and the index on the last error message
            processed, respectively.  See MEEMES below.
 MESTOP=20  (0 &lt;= K20 &lt;= 8) Set the stop level for error messages.
            If an error message has a stop index &gt; min(K20, 8), the
            program is stopped after processing the message.  The
            default value is K20=3.
 MEPRNT=21  (0 &lt;= K21 &lt;= 8) Set the print level for error messages.
            If an error message has a print index &gt; K21, or the message
            is going to stop when finished, information in an error
            message is processed, else all the actions including
            printing are skipped.  (MESTOP controls stopping.)  The
            default value is MEPRNT = 3.
 An action index of -i, for i &lt; METDIG, will return in the location
 ordinarily used for Ki the current default value for the internal
 variable set by Ki.  In the case of MESUNI, if the scratch unit has
 not been opened, it will be opened before returning the unit number.</p>
<p>METDIG=22  (-50 &lt;= K22 &lt;= 50) As for MEDDIG, except the value here
            is temporary, lasting until the return, or next use of this
            action.  If 0, the internal value for K12 is used instead.
 MENTXT=23  (1 &lt;= K23 &lt;= 10000000) Set value of NTEXT to K23.
 MEIDAT=24  (1 &lt;= K24 &lt;= 1000000000) Set value of NIDAT to K24.
 MEFDAT=25  (1 &lt;= K25 &lt;= 1000000000) Set value of NFDAT to K25.
 MEMDAT=26  (1 &lt;= K26 &lt;= 5) Set value of NMDAT to K26.
 MEMDA1=27  (K27) set MDAT(1) to K27.  See description of NMDAT above.
 MEMDA2=28  (K28) set MDAT(2) to K28.
 MEMDA3=29  (K29) set MDAT(3) to K29.
 MEMDA4=30  (K30) set MDAT(4) to K30.
 MEMDA5=31  (K31) set MDAT(5) to K31.
 METABS=32  (1 &lt;= K32 &lt;= 100) set spacing for tabs to K32.
 MECONT=50  Exit, but no print of current print buffer.  The error or
            diagnostic message is to be continued immediately.
 MERET=51   All done with diagnostic or error message, complete
            processing and return, or for some error messages stop.
 MEEMES=52  (K52, L52, M52) Start an error message with severity level
            K52,index for the error of L52, and message text starting
            at TEXT(M52).  If M52 is 0, message text starts at
            TEXT(NTEXT), and if M52 &lt; 0, no message text is
            printed as part of this action.  Library routines should
            set K52 = 10*s + p, where s is the stop level desired, and
            p the print level, and should have 10 &gt; p &gt;= s &gt;= 0.
            We offer the following guidelines as a yardstick for
            setting the value of s.
   = 9  User has ignored warning that program was going to be stopped.
   = 8  Program has no way to continue.
   = 7  User has given no indication of knowing that functionality of
        results is reduced.  (E.g. not enough space for some result.)
   = 6  Program could continue but with reduced functionality.
   = 5  Results far worse than user expected to want.
   = 4  User has given no indication of knowing that results do not
        meet requested or expected accuracy.
   = 3  Warning is given that program will be stopped without some
        kind of response from the calling program.
   = 2  Program is not delivering requested or expected accuracy.
   = 1  Some kind of problem that user could correct with more care in
        coding or in problem formulation.
   = 0  Message is for information of uncritical nature.
            Print levels might be counted down so that warnings given
            several times are no longer given, or be counted up so
            that a warning is only given after a certain threshold is
            reached.  Levels should be selected with the understanding
            that the default is to print only levels above 3.
 METEXT=53  Print TEXT, starting at TEXT(NTEXT).  Print ends
            with the last character preceding the first '$'.  Special
            actions are determined by the character following the '$'.
            Except as noted, the '$' and the single character which
            follows are not printed.  In the text below, "to continue",
            means to continue print of TEXT with the next character
            until the next "$".  Except for the one case noted, NTEXT
            is set to point to the second character after the "$".
            Note, letters must be in upper case.  Possibilities are:
      B  Break text, but don't start a new line.
      E  End of text and line.
      R  Break text, don't change the value of NTEXT.  Thus next
         text Repeats the current.
      N  Start a New line, and continue.
      I  Print IDAT(NIDAT), set NIDAT=NIDAT+1, and continue.
      J  As for I above, except use the last integer format
         defined by a "$(", see below.
      F  Print FDAT(NFDAT), set NFDAT=NFDAT+1, and continue.
      G  As for F above, except use the last floating format
         defined by a "$(", see below.
      M  Print MDAT(NMDAT), set NMDAT=NMDAT+1, and continue.
      H  Marks terminator for column and row Headings, see table,
         vector, and matrix output below.  This causes enough blanks to
         be generated to keep column headings centered over their
         columns.  After the blanks are generated, text is continued
         until the next '$'.  This is not to be used except inside
         column or row headings.  The last row or column should be
         terminated with a '$E' or if appropriate, a '$#' for a row or
         column label.
      (  Starts the definition of a format for integer or floating
         point output.  The format may not contain a "P" field, and
         must require no more than 12 characters for floating point
         (e.g. "(nnEww.ddEe)", where each of the lower case letters
         represents a single digit), and no more than 7 characters for
         integer output.  Following the ")" that ends the format, if
         the next character is not a "$" then "$J" or "$G" type output
         is done, see above.  In either case processing of TEXT then
         continues.
      T  Tab.
      #  Used in matrix row or column labels this prints the current
         row or column index, respectively, ends the text for the
         current row or column, and resets the text pointer to where
         it started.
      $  a single '$' is printed, continue till the next '$'.
      -  Start a negative number for skipping.
     0-9 Digits for skipping.
      C  Only used by PMESS which deletes it and the preceding '$'.
         Used at the end of a line to indicate continued text.
   other Don't use this -- the '$' is ignored, but new features may
         change the action.  (E.g. $P might be added to get a prompt.)
 ME????=54  Not used.
 METABL=55  (K55, L55, M55, N55)  Note this action automatically
            returns when done, further locations in MACT are not
            examined.  This action prints a heading and/or data that
            follows a heading.  If K55 is 1, then the heading text
            starting in TEXT(NTEXT) is printed.  This text
            should contain embedded "$H"'s to terminate columns of the
            heading.  If there is no heading on a column, use " $H".
            Note the leading blank.  If the heading is to continue
            over k columns, begin the text with "$H" repeated k-1
            times with no other embedded characters.  The very last
            column must be terminated with "$E" rather than "$H".
            After tabular data is printed, K55 is incremented by 1,
            and compared with L55.  If K55 &gt; L55, K55 is reset to 1,
            and if the data that was to be printed had lines that were
            too long, data saved in the scratch file is printed using
            the headings for the columns that would not fit on the
            first pass.  Note that only one line of tabular data can
            be printed on one call to this subroutine.
            M55 gives the number of columns of data associated with the
            heading.
            N55 is a vector containing M55 entries.  The k-th integer
            in N55 defines the printing action for the k-th column
            of the table.  Let such an integer have a value defined by
            rr + 100 * (t + 10 * (dd + 100 * ww)), i.e. wwddtrr, where
            0 &lt;= rr,dd,ww &lt; 100, and 0 &lt;= t &lt; 10.
      rr    The number of items to print.
      t     The type of output.
            1  Print text starting at TEXT(NTEXT), rr = 01.
            2  Print the value of K55, rr = 01.
            3  Print integers starting at IDAT(NIDAT).
            4  Print starting at FDAT(NFDAT), using an F format.
            5  Print starting at FDAT(NFDAT), using an E format.
            6  Print starting at FDAT(NFDAT), using an G format.
      dd    Number of digits after the decimal point.
      ww    The total number of column positions used by the column,
            including the space used to separate this column from the
            preceding one.  This must be big enough so that the column
            headings will fit without overlap.
 MEIVEC=57  (K57) Print IDAT as a vector with K57 entries.  The vector
            output starts on the current line even if the current line
            contains text.  This is useful for labeling the vector.
            The vector starts at IDAT(NIDAT).
            If K57 &lt; 0,  indices printed in the labels for the vector
            start at at NIDAT, and entries from NIDAT to -K57 are
            printed.
 MEIMAT=58  (K58, L58, M58, I58, J58) Print IDAT as a matrix with K58
            declared rows, L58 actual rows, and M58 columns.  If K58&lt;0,
            instead of using 1 for the increment between rows, and K58
            for the increment between columns, -K58 is used for the
            increment between rows, and 1 is used for the increment
            between columns.  If L58&lt;0, the number of actual rows is
            mod(-L58, 100000), and the starting row index is -L58 /
            100000.  Similarly for M58&lt;0. TEXT(I58) starts the text for
            printing row labels.  If I58 &lt; 0, no row labels are
            printed.  If I58 = 0, it is as if it pointed to text
            containing "Row $E".  Any "$" in a row or column label must
            be followed by "H" or "E" which terminates the text for the
            label.  In the case of $H, text for the next label follows
            immediately, in the case of $E the current row index is
            printed in place of the $E and the next label uses the same
            text.  J58 is treated similarly to I58, except for column
            labels, and with "Row $E" replaced with "Col $E".  The
            matrix starts at IDAT(NIDAT), and NIDAT points one past the
            end of the matrix when finished.
 MEJVEC=59  (K59) As for MEIVEC, except use format set with $(.
 MEJMAT=60  (K60, L60, M60, I60, J60) As for MEIMAT, except use the
            format set with $(.
 MEFVEC=61  (K61) As for MEIVEC, except print FDAT as a vector with
            K61 entries.  The vector starts at FDAT(NFDAT).
 MEFMAT=62  (K62, L62, M62, I62, J62) As for action MEIMAT, but
            instead print FDAT, and use NFDAT in place of NIDAT.
 MEGVEC=63  (K63) As for MEFVEC, except use format set with $(.
 MEGMAT=64  (K64, L64, M64, I64, J64) As for MEIMAT, except use the
            format set with $(.
 MEIVCI=65  (K65, L65) As for MEIVEC, except the vector entries have a
            spacing of K65, and there are L65 entries in the vector.
 MEJVCI=66  (K66) As for MEIVCI, except use format set with $(.
 MEFVCI=67  (K67, L67) As for MEFVEC, except the vector entries have a
            spacing of K67, and there are L67 entries in the vector.
 MEGVCI=68  (K68) As for MEFVCI, except use format set with $(.
 MEFSPV=69  (K69) Output IDAT, FDAT as a sparse vector.</p>
<h3>History</h3>
<ul>
<li>2010-02-22 MESS  Krogh  Moved NSKIP=0 to start of code.</li>
<li>2009-10-30 MESS  Krogh  Defined DSCRN.</li>
<li>2009-02-28 MESS  Krogh  Added FMTT = ' ' for NAG compiler.</li>
<li>2009-02-28 MESS  Krogh  Fixed "f" format for C code.</li>
<li>2007-09-08 MESS  Krogh  Fixed definitions of MEVLAS.</li>
<li>2006-07-27 MESS  Krogh  Fixed boundary case in printing long text.</li>
<li>2006-03-20 MESS  Krogh  Added code for output of sparse vector.</li>
<li>2005-04-07 MESS  Krogh  Declared LFLGDB integer in MESSMH.</li>
<li>2004-12-15 MESS  Krogh  Added " - 1" at end of line on label 410.</li>
<li>2002-05-17 MESS  Krogh  Added way for user to get error count.</li>
<li>2001-12-28 MESS  Krogh  Added NSKIP for more flexible output values.</li>
<li>2000-12-30 MESS  Krogh  Fixed some types/casts in C code.</li>
<li>1997-12-12 MESS  Krogh  Prefixed 0P edit descriptor to F format.</li>
<li>1996-07-11 MESS  Krogh  Transpose matrix output for C.</li>
<li>1996-06-27 MESS  Krogh  fprintf(stdout, =&gt; printf( &amp; memset now used</li>
<li>1996-06-18 MESS  Krogh  "Saved" NTEXTR.</li>
<li>1996-05-15 MESS  Krogh  Changes to use .C. and C%%.</li>
<li>1996-03-30 MESS  Krogh  Added external statement.</li>
<li>1996-01-24 MESS  Krogh  Fixed minor bug introduced with "$ " stuff.</li>
<li>1996-01-23 MESS  Krogh  Minor changes for C conversion.</li>
<li>1995-11-10 MESS  Krogh  Add code to change "$ " to " " in headings.</li>
<li>1995-08-11 MESS  Krogh  Made code default to not using UMESS.</li>
<li>1995-01-20 MESS  Krogh  Fixed unusual case in matrix output.</li>
<li>1994-12-15 MESS  Krogh  Removed block data for Cray T3D.</li>
<li>1994-11-11 MESS  Krogh  Declared all vars.</li>
<li>1994-09-14 MESS  Krogh  Fixed to get 1 more "$" in C output.</li>
<li>1994-09-08 MESS  Krogh  Added new matrix/vector capabilities.</li>
<li>1994-08-22 MESS  Krogh  Fix for conversion to C for new converter.</li>
<li>1994-07-05 MESS  Krogh  Fixed bug, KDI and FMTI could be inconsist.</li>
<li>1994-05-20 MESS  Krogh  Changes to MESSFT so line 1 can go to file.</li>
<li>1994-05-20 MESS  Krogh  Changes to setting output unit.</li>
<li>1994-05-09 MESS  Krogh  Integer vectors had overflow &amp; space probs.</li>
<li>1993-05-19 MESS  Krogh  Changed TEXT to array of character strings.</li>
<li>1993-04-14 MESS  Krogh  Fixes for conversion to C. (C%% comments.)</li>
<li>1993-03-10 MESS  Krogh  Broke into smaller pieces.</li>
<li>1992-12-02 MESS  Krogh  Added save statement to block data subpr.</li>
<li>1992-07-13 MESS  Krogh  Add checks in heading set up.</li>
<li>1992-07-12 MESS  Krogh  Fixed so $$ prints a single $ in TEXT.</li>
<li>1992-07-12 MESS  Krogh  Set out of bound inputs to limit values.</li>
<li>1992-07-12 MESS  Krogh  Fixed so output works to alternate files.</li>
<li>1992-07-12 MESS  Krogh  Added integer declarations for parameters.</li>
<li>1992-06-24 MESS  Krogh  More blanks allowed on break of long lines.</li>
<li>1992-06-10 MESS  Krogh  Minor fix to vector output.</li>
<li>1992-05-27 MESS  Krogh  Fixed bug on line width setting.</li>
<li>1992-05-14 MESS  Krogh  Put common blocks in save statement.</li>
<li>1992-05-11 MESS  Krogh  Added label to assigned go to &amp; a comment.</li>
<li>1992-04-08 MESS  Krogh  Unused labels 60, 220 and 320 removed.</li>
<li>1992-03-20 MESS  Krogh  Changed status on open to SCRATCH.</li>
<li>1992-03-10 MESS  Krogh  1 line below label 690 changed max to min.</li>
<li>1992-02-05 MESS  Krogh  Fixed bugs in printing matrix labels.</li>
<li>1992-01-29 MESS  Krogh  Added UMESS and multiple print option.</li>
<li>1991-12-09 MESS  Krogh  Fine tuning of vector output.</li>
<li>1991-10-10 MESS  Krogh  Insure no stop if stop level = 9.</li>
<li>1991-06-26 MESS  Krogh  Initial Code.
 <strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em> Internal Variables </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong>*</li>
</ul>
<p>BUF    Character string holding characters to be output.
 C      Used for temp. storage of a character.
 DOLS   A heading/trailing string of characters, default = $'s.
 ERMSG  Default part of error message.
 ERRCNT Used to keep a count of error messages.
 EUNIT  Unit number for output of error messages.
 FDAT   Formal array, containing floating point data to output.  Only
   appears external to this subroutine.
 FIRST  Set = .true. initially, then .false. after MESS is called.
 FMTC   Format for integer output of matrix column headings.
 FMTF   Format for floating point or other output.
 FMTG   Format set by user for floating point or other output.
 FMTI   Character string holding format for integer output.
 FMTIM  Equivalenced to FMTR, FMTC.
 FMTJ   Format set by user for integer output.
 FMTR   Value of FMTI for format of row indices.
 FMTT   Format to be stored in FMTJ or FMTG.
 GETW   Set true if still need to get width for a format.
 GOTFMT Set .true. if format has been set by user.  When printing
   tables, set true when heading has been output.
 I      Index of current action from MACT.
 ICHAR0 Value of ICHAR('0')
 ICOL   Current column index in matrix output.
 IDAT   Formal array, containing integer data to output.
 IMAG   Magnitude of integer to output, with negative sign if integer
   is &lt; 0.
 INC    Increment between successive elements in a vector or in the
    column of a matrix.
 INCM   Array giving amount of space used by the options.
 INERR  0 if not processing an error message, 1 if printing an error
   message, -1 if in an error message that is not being printed, and &gt;1
   if printing an error message that stops.  Set to -2 when the error
   message is supposed to stop.
 IOUT   Integer to be output.
 IRC    = 1 for rows, = 2 for columns when determining labels for
   matrix output.
 IROW   Row index for matrix output.  Also used in table output to
    count lines for printing line index on read from scratch unit.
 IROW1  Starting row index for matrix output.
 ITEXT  Index of the element of TEXT use for the next text output.
 ITXTSV Saved value of NTEXT when doing matrix output.
 IVAR   Integer array, that is equivalenced to a number of integer
   variables that can be set by the user.
 IWF    Width to be used in a floating pt. (or other) format.
 IWG    Value like IWF for user set format.
 J      Used as a temporary index.
 JJ      Used as a temporary index.
 K      Used as a temporary index.
 K      Used as a temporary index.
 K1     Used as a temporary index.
 K2     Used as a temporary index.
 KDF    Current number of digits to print for floating point.  See
   description of MACT(<em>) = METDIG above.
 KDFDEF Current default for KDF, see description of MACT(</em>) = MEDDIG.
 KDI    Number of digits used to print last integer.
 KDIAG  Not directly referenced.  Holds place in IVAR for reference
   from outside.  See comments above.
 KDILAB Length for printing index in vector output.
 KDJ    As for KDI, except for format set by user.
 KK     Temporary index.
 KLINE  Count of number of things to print on a line.  (In table print
   is the number to print for one spec field.)
 KNT    In vector output gives the current index for output.
 KOLWID Length to use for printing a column heading.  Equivalenced to
   MAXWID(2).
 KP     Index from error action input for the print action.
 KRES1  Holds place in common block for future use.
 KS     Index from error action input for the stop action.
 KSCRN  Number of lines to "print" before pausing.
 KSHIFT Amount to shift column heading before printing.
 KSPEC  Defines action after looking for character in TEXT.  (Also
   used as a temporary index.)
   1.  $B   Break the text here continue on same line.
   2.  $E   Break text, print what is in BUF.
   3.  $R   Break text, continue on same line, NTEXT set to repeat the
            current text.
   4.  $N   Print BUF, continue with following text.
   5.  $I   Print IDAT(NIDAT), continue TEXT.
   6.  $F   Print FDAT(NFDAT), continue TEXT.
   7.  $M   Print MDAT(NMDAT), continue TEXT.
   8.  $J   As for $I, but with user format.
   9.  $G   As for $F, but with user format.
  10.  $(   Set a user format.
  11.  $T   Tab.
  12.       Set when done with an action.
  13.       Set when done with boiler plate text for an error message.
   0. Other Ignore the "$", continue with TEXT.
 KT     Used for logic in output of headings.
        = 1 Output table headings.
        = 2 Get row/column widths for matrix output.
        = 3 Output column headings for matrix output.
 LASKNT In vector output value index for last element to print.
 LASTI  Last index for matrix output, or for finding values that
   determine format.
 LBUF   Position of characters in BUF, usually the last to print.
 LBUF1  Start of text to shift when shifting text in BUF to the left.
 LBUF2  End of text to shift when shifting text in BUF to the left.
 LENBUF Parameter giving the number of character in BUF.
 LENLIN Gives number of character in output lines.
 LENOUT Length of output for table or vector/matrix output.
 LENTXT Length of character array elements in TEXT.
 LENTRY Tells what to do on entry (and sometimes other places.)
   = 1  The value on first entry.
   = 2  A previous entry is to be continued.
   = 3  A non printing error message is to be continued
   = 4  Just done output from inside a METEXT action.
   = 5  Got "maximum" value for entries in a vector.
   = 6  Got "maximum" value for entries in a matrix.
   = 7  Vector (either print or get format for label indices.)
   = 8  Matrix (either print or get format for label indices.)
   = 9  Output of data in a table.
   =10  Get "maximum" valur for entries in a sparse vector.
   =11  Output a sparse vector.
 LHEAD  If = 0 no print of DOLS, else DOLS printed in error messages.
 LINERR Gives LENLIN for error messages.
 LINMSG Gives LENLIN for diagnostic messages.
 LINSTR Space at start of line for label in vector and matrix output.
   Equivalenced to MAXWID(1).
 LNERR  Parameter giving the default value for LENERR, only in XMESS.
 LNMSG  Parameter giving the default value for LINMSG, only in XMESS.
 LOCBEG Index of first item in vector and matrix output.
 LPRINT For error messages with a print level &lt;= LPRINT nothing is
   printed (unless the message would result in a stop).
 LSTOP  As for LPRINT, except with the stop level, and stopping.
 LSTRT  Starting character position in BUF for storing next characters.
 LTEXT  Length of heading text in TEXT.
 M      Index for the current action.
 MACT   Formal integer array specifying the actions, see above.
 MAXERR Value save in IVAR for user to get indication of last (really
   the maximum error seen so far = 1000 * (10*stop + print) + index.
 MAXWID Equivalenced to  LINSTR and KOLWID.
 MBNDHI Upper bounds for inputs to IVAR.
 MBNDLO Lower bounds for inputs to IVAR.
 MDAT   Array where user can store integers in IVAR for later output.
   Also used to store column indices when tables are saved on scratch
   unit.</p>
<p>The following parameter names starting with ME define actions
   which the user can request.  They have been documented in the
   description above, except for the ones defined just below.
 MEGBAS is 1 less than the smallest action that involves something
   other than just storing or retrieving a value.
 MEMAXI is the largest action which a user can request.
 MEVBAS is the smallest action index, used to set the starting index in
   IVAR.
 MEVLAS is the largest index for a variable in IVAR.
 MECONT,  MEDDI,  MEELI,  MEEME, MEEUNI, MEFDAT, MEFMAT, MEFSPV,
 MEFVCI, MEFVEC, MEGBAS, MEGMAT, MEGVCI, MEGVEC, MEHEAD, MEIDAT,
 MEIMAT, MEIVCI, MEIVEC, MEJMAT, MEJVCI, MEJVEC, MEMAXE, MEMAXI,
 MEMDA1, MEMDA2, MEMDA3, MEMDA4, MEMDA5, MEMDAT, MEMLIN, MEMUNI,
 MENTXT, MEPRNT, MESCRN, MERES1, MERES2, MERES3,  MERET, MESTOP,
 MESUNI,  METAB, METDIG, METEXT
 MPT  Current pointer to data for matrix or vector output.
 MTEXT  Equivalenced to MTEXTR and MTEXTC.
 MTEXTC TEXT(MTEXTC) starts text for printing column labels.
 MTEXTR TEXT(MTEXTR) starts text for printing row labels.
 MUNIT  Output unit used for messages that aren't in an error message.
 NCOL   Number of columns for matrix output, 0 for vector output,
   count of column left for table output.
 NDIM   Distance between columns for matrix output.
 NFDAT  Index of next item in FDAT to print.
 NIDAT  Index of next item in IDAT to print.
 NLINE  Maximum number of data items to print on a line for matrix and
   vector output.  If the scratch file is used for table output,
   NLINE gives the original end of the buffer.
 NMDAT  Pointer to next thing to print from MDAT.
 NROCO  Equivalenced to (NROW, NCOL).  Used in matrix output.
 NROW   Number of rows for matrix output.    When printing tables,
   MDAT(NROW) gives place where line was split.  (=0 if not split)
 NSKIP  The amount to skip ahead on the next floating or integer
   output.
 NTEXT  Index inside an element of TEXT for the next text output.
 NTEXTR Value of NTEXT to use if get a $R.
 NTXTSV Saved value of NTEXT when doing matrix output.
 OUNIT  Index of the current output unit.
 SC     Parameter for special character used to introduce actions.
   Default value is '$'.  If this is changed the "$"'s in comments
   should be changed to the new value of the character.  (Note that
   SC = '\' is not portable.)
 SCRNAM Name of file constructed for error output or message output.
 SUNIT  Index for the scratch unit, -1 if not yet assigned.
 TEXT   Formal argument giving the character string from which all text
   is taken.
 UMESS  Name of subroutine called that does nothing, but which may be
   modified by the user to cause different actions to be taken.
   The usual version of MESS has the call to UMESS commented out.
 XARG   If .true., output data is not integer, and a return is made to
   print data from FDAT.
 XARGOK Set .true. if call is from program that will print data from
   FDAT.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mact~2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>MACT</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-text~2"></span>character</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>TEXT</strong>(*)*(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idat~2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IDAT</strong>(*)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~mess~~CallsGraph Pages: 1 -->
<svg id="procmessCallsGraph" width="247pt" height="196pt"
 viewBox="0.00 0.00 247.00 196.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~mess~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 192)">
<title>proc~~mess~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-192 243,-192 243,4 -4,4"/>
<!-- proc~mess -->
<g id="proc~~mess~~CallsGraph_node1" class="node">
<title>proc~mess</title>
<polygon fill="none" stroke="black" points="54,-104 0,-104 0,-80 54,-80 54,-104"/>
<text text-anchor="middle" x="27" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50">MESS</text>
</g>
<!-- proc~messpr -->
<g id="proc~~mess~~CallsGraph_node2" class="node">
<title>proc~messpr</title>
<g id="a_proc~~mess~~CallsGraph_node2"><a xlink:href=".././proc/messpr.html" xlink:title="MESSPR">
<polygon fill="#d9534f" stroke="#d9534f" points="147,-188 92,-188 92,-164 147,-164 147,-188"/>
<text text-anchor="middle" x="119.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSPR</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messpr -->
<g id="proc~~mess~~CallsGraph_edge1" class="edge">
<title>proc~mess&#45;&gt;proc~messpr</title>
<path fill="none" stroke="#000000" d="M38.9,-104.17C50.89,-117.3 70.98,-138.52 90,-155 90.99,-155.86 92.02,-156.72 93.06,-157.58"/>
<polygon fill="#000000" stroke="#000000" points="91.24,-160.6 101.28,-163.99 95.55,-155.08 91.24,-160.6"/>
</g>
<!-- proc~messmh -->
<g id="proc~~mess~~CallsGraph_node3" class="node">
<title>proc~messmh</title>
<g id="a_proc~~mess~~CallsGraph_node3"><a xlink:href=".././proc/messmh.html" xlink:title="MESSMH">
<polygon fill="#d9534f" stroke="#d9534f" points="149,-146 90,-146 90,-122 149,-122 149,-146"/>
<text text-anchor="middle" x="119.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSMH</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messmh -->
<g id="proc~~mess~~CallsGraph_edge2" class="edge">
<title>proc~mess&#45;&gt;proc~messmh</title>
<path fill="none" stroke="#000000" d="M54.18,-104.15C63.18,-108.33 73.42,-113.08 83.04,-117.54"/>
<polygon fill="#000000" stroke="#000000" points="81.84,-120.84 92.38,-121.88 84.79,-114.49 81.84,-120.84"/>
</g>
<!-- proc~messgs -->
<g id="proc~~mess~~CallsGraph_node4" class="node">
<title>proc~messgs</title>
<g id="a_proc~~mess~~CallsGraph_node4"><a xlink:href=".././proc/messgs.html" xlink:title="messgs">
<polygon fill="#d94e8f" stroke="#d94e8f" points="146.5,-104 92.5,-104 92.5,-80 146.5,-80 146.5,-104"/>
<text text-anchor="middle" x="119.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">messgs</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messgs -->
<g id="proc~~mess~~CallsGraph_edge3" class="edge">
<title>proc~mess&#45;&gt;proc~messgs</title>
<path fill="none" stroke="#000000" d="M54.18,-92C62.9,-92 72.78,-92 82.14,-92"/>
<polygon fill="#000000" stroke="#000000" points="82.38,-95.5 92.38,-92 82.38,-88.5 82.38,-95.5"/>
</g>
<!-- proc~messfi -->
<g id="proc~~mess~~CallsGraph_node5" class="node">
<title>proc~messfi</title>
<g id="a_proc~~mess~~CallsGraph_node5"><a xlink:href=".././proc/messfi.html" xlink:title="MESSFI">
<polygon fill="#d9534f" stroke="#d9534f" points="239,-44 185,-44 185,-20 239,-20 239,-44"/>
<text text-anchor="middle" x="212" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFI</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messfi -->
<g id="proc~~mess~~CallsGraph_edge4" class="edge">
<title>proc~mess&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M54.22,-83.02C65.25,-79.27 78.24,-74.89 90,-71 118.42,-61.61 150.69,-51.22 174.75,-43.53"/>
<polygon fill="#000000" stroke="#000000" points="176.06,-46.78 184.53,-40.41 173.94,-40.12 176.06,-46.78"/>
</g>
<!-- proc~messfd -->
<g id="proc~~mess~~CallsGraph_node6" class="node">
<title>proc~messfd</title>
<g id="a_proc~~mess~~CallsGraph_node6"><a xlink:href=".././proc/messfd.html" xlink:title="MESSFD">
<polygon fill="#d9534f" stroke="#d9534f" points="147.5,-24 91.5,-24 91.5,0 147.5,0 147.5,-24"/>
<text text-anchor="middle" x="119.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFD</text>
</a>
</g>
</g>
<!-- proc~mess&#45;&gt;proc~messfd -->
<g id="proc~~mess~~CallsGraph_edge5" class="edge">
<title>proc~mess&#45;&gt;proc~messfd</title>
<path fill="none" stroke="#000000" d="M41.75,-79.85C56.45,-66.85 79.96,-46.07 97.09,-30.92"/>
<polygon fill="#000000" stroke="#000000" points="99.75,-33.25 104.92,-24 95.11,-28 99.75,-33.25"/>
</g>
<!-- proc~messfd&#45;&gt;proc~messfi -->
<g id="proc~~mess~~CallsGraph_edge6" class="edge">
<title>proc~messfd&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M147.65,-18C156.2,-19.89 165.78,-22.01 174.86,-24.01"/>
<polygon fill="#000000" stroke="#000000" points="174.28,-27.47 184.8,-26.21 175.79,-20.63 174.28,-27.47"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~mess~~CalledByGraph Pages: 1 -->
<svg id="procmessCalledByGraph" width="243pt" height="126pt"
 viewBox="0.00 0.00 243.00 125.87" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~mess~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 121.87)">
<title>proc~~mess~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-121.87 239,-121.87 239,4 -4,4"/>
<!-- proc~mess -->
<g id="proc~~mess~~CalledByGraph_node1" class="node">
<title>proc~mess</title>
<polygon fill="none" stroke="black" points="235,-84 181,-84 181,-60 235,-60 235,-84"/>
<text text-anchor="middle" x="208" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50">MESS</text>
</g>
<!-- proc~divaop -->
<g id="proc~~mess~~CalledByGraph_node2" class="node">
<title>proc~divaop</title>
<g id="a_proc~~mess~~CalledByGraph_node2"><a xlink:href=".././proc/divaop.html" xlink:title="DIVAOP">
<polygon fill="#d9534f" stroke="#d9534f" points="144.5,-104 90.5,-104 90.5,-80 144.5,-80 144.5,-104"/>
<text text-anchor="middle" x="117.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVAOP</text>
</a>
</g>
</g>
<!-- proc~divaop&#45;&gt;proc~mess -->
<g id="proc~~mess~~CalledByGraph_edge2" class="edge">
<title>proc~divaop&#45;&gt;proc~mess</title>
<path fill="none" stroke="#000000" d="M144.57,-86.11C152.78,-84.25 162,-82.17 170.78,-80.18"/>
<polygon fill="#000000" stroke="#000000" points="171.82,-83.54 180.81,-77.92 170.28,-76.71 171.82,-83.54"/>
</g>
<!-- proc~diva -->
<g id="proc~~mess~~CalledByGraph_node3" class="node">
<title>proc~diva</title>
<g id="a_proc~~mess~~CalledByGraph_node3"><a xlink:href=".././proc/diva.html" xlink:title="DIVA">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-114 0,-114 0,-90 54,-90 54,-114"/>
<text text-anchor="middle" x="27" y="-99.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVA</text>
</a>
</g>
</g>
<!-- proc~diva&#45;&gt;proc~mess -->
<g id="proc~~mess~~CalledByGraph_edge1" class="edge">
<title>proc~diva&#45;&gt;proc~mess</title>
<path fill="none" stroke="#000000" d="M54.12,-110.04C78.21,-116.15 114.72,-122.11 145,-113 159.97,-108.5 174.65,-99.08 185.97,-90.4"/>
<polygon fill="#000000" stroke="#000000" points="188.32,-93 193.92,-84 183.93,-87.55 188.32,-93"/>
</g>
<!-- proc~diva&#45;&gt;proc~divaop -->
<g id="proc~~mess~~CalledByGraph_edge5" class="edge">
<title>proc~diva&#45;&gt;proc~divaop</title>
<path fill="none" stroke="#000000" d="M54.07,-99.05C62.28,-98.13 71.5,-97.08 80.28,-96.09"/>
<polygon fill="#000000" stroke="#000000" points="80.76,-99.56 90.31,-94.96 79.98,-92.6 80.76,-99.56"/>
</g>
<!-- proc~divadb -->
<g id="proc~~mess~~CalledByGraph_node4" class="node">
<title>proc~divadb</title>
<g id="a_proc~~mess~~CalledByGraph_node4"><a xlink:href=".././proc/divadb.html" xlink:title="DIVADB">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-53 0,-53 0,-29 54,-29 54,-53"/>
<text text-anchor="middle" x="27" y="-38.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVADB</text>
</a>
</g>
</g>
<!-- proc~divadb&#45;&gt;proc~mess -->
<g id="proc~~mess~~CalledByGraph_edge4" class="edge">
<title>proc~divadb&#45;&gt;proc~mess</title>
<path fill="none" stroke="#000000" d="M54.03,-45.51C84.78,-50.83 136.14,-59.73 170.77,-65.73"/>
<polygon fill="#000000" stroke="#000000" points="170.49,-69.23 180.94,-67.49 171.68,-62.33 170.49,-69.23"/>
</g>
<!-- proc~messft -->
<g id="proc~~mess~~CalledByGraph_node5" class="node">
<title>proc~messft</title>
<g id="a_proc~~mess~~CalledByGraph_node5"><a xlink:href=".././proc/messft.html" xlink:title="MESSFT">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-24 90,-24 90,0 145,0 145,-24"/>
<text text-anchor="middle" x="117.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFT</text>
</a>
</g>
</g>
<!-- proc~divadb&#45;&gt;proc~messft -->
<g id="proc~~mess~~CalledByGraph_edge6" class="edge">
<title>proc~divadb&#45;&gt;proc~messft</title>
<path fill="none" stroke="#000000" d="M54.07,-32.46C62.3,-29.76 71.54,-26.73 80.33,-23.85"/>
<polygon fill="#000000" stroke="#000000" points="81.59,-27.12 90,-20.68 79.41,-20.47 81.59,-27.12"/>
</g>
<!-- proc~messft&#45;&gt;proc~mess -->
<g id="proc~~mess~~CalledByGraph_edge3" class="edge">
<title>proc~messft&#45;&gt;proc~mess</title>
<path fill="none" stroke="#000000" d="M136.41,-24.14C149.12,-32.76 166.4,-44.48 180.68,-54.16"/>
<polygon fill="#000000" stroke="#000000" points="178.88,-57.16 189.12,-59.88 182.8,-51.37 178.88,-57.16"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-1">Common Blocks</a></h3></div>
  <div id="common-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/mess.html#common-cmessi~2">CMESSI</a>
      
      <a class="list-group-item" href="../proc/mess.html#common-cmessc~2">CMESSC</a>
      
    </div>
  </div>
</div>





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/mess.html#src">MESS</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
      <h2>Common Blocks</h2>
      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-cmessi~2"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/dmess.html#common-cmessi'>DMESS</a> (subroutine)<br><a href='../proc/messfd.html#common-cmessi~3'>MESSFD</a> (subroutine)<br><a href='../proc/messfi.html#common-cmessi~4'>MESSFI</a> (subroutine)<br><a href='../proc/messmh.html#common-cmessi~5'>MESSMH</a> (subroutine)<br><a href='../proc/messpr.html#common-cmessi~6'>MESSPR</a> (subroutine)<br><a href='../proc/messft.html#common-cmessi~7'>MESSFT</a> (subroutine)<br>">common /CMESSI/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sunit~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>SUNIT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lhead~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LHEAD</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kdfdef~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KDFDEF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-linmsg~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LINMSG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-linerr~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LINERR</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-munit~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MUNIT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eunit~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EUNIT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kscrn~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSCRN</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kdiag~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KDIAG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxerr~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MAXERR</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lstop~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LSTOP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lprint~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LPRINT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kdf~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KDF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ntext~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NTEXT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nidat~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NIDAT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nfdat~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NFDAT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nmdat~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NMDAT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mdat~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MDAT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tabspa~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TABSPA</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-errcnt~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>ERRCNT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ichar0~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ICHAR0</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-imag~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IMAG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-inc~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>INC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-irc~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IRC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-itext~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ITEXT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iwf~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IWF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iwg~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IWG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kdi~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KDI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kdj~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KDJ</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kline~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KLINE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kshift~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSHIFT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kspec~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSPEC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lasti~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LASTI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lbuf~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LBUF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lenlin~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LENLIN</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lenout~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LENOUT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lentry~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LENTRY</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lentxt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LENTXT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-locbeg~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LOCBEG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lstrt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LSTRT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ltext~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LTEXT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxwid~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MAXWID</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mpt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MPT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nrow~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NROW</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ncol~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NCOL</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ndim~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NDIM</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ounit~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>OUNIT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-gotfmt~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>GOTFMT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xarg~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>XARG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xargok~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>XARGOK</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-cmessc~2"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/dmess.html#common-cmessc'>DMESS</a> (subroutine)<br><a href='../proc/messfd.html#common-cmessc~3'>MESSFD</a> (subroutine)<br><a href='../proc/messfi.html#common-cmessc~4'>MESSFI</a> (subroutine)<br><a href='../proc/messmh.html#common-cmessc~5'>MESSMH</a> (subroutine)<br><a href='../proc/messpr.html#common-cmessc~6'>MESSPR</a> (subroutine)<br><a href='../proc/messft.html#common-cmessc~7'>MESSFT</a> (subroutine)<br>">common /CMESSC/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-buf~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>BUF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dols~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>DOLS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmtf~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FMTF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmtg~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FMTG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmti~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FMTI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmtj~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FMTJ</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmtt~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FMTT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmtim~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FMTIM</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
    </section>
    <br>
    <script>
      $(function () {
      $('[data-toggle="popover"]').popover()
      })
    </script>
    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">MESS</span><span class="p">(</span><span class="n">MACT</span><span class="p">,</span> <span class="n">TEXT</span><span class="p">,</span> <span class="n">IDAT</span><span class="p">)</span>

        <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LNMSG</span> <span class="o">=</span> <span class="mi">128</span>
        <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LNERR</span> <span class="o">=</span> <span class="mi">79</span>
  <span class="c">!</span>
  <span class="c">! ************** Parameters Defining Actions (See Above) ***************</span>
  <span class="c">!</span>

  <span class="c">! Parameters for changing the environment.</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MESUNI</span><span class="o">=</span><span class="mi">10</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEHEAD</span><span class="o">=</span><span class="mi">11</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEDDIG</span><span class="o">=</span><span class="mi">12</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMLIN</span><span class="o">=</span><span class="mi">13</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEELIN</span><span class="o">=</span><span class="mi">14</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMUNI</span><span class="o">=</span><span class="mi">15</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEEUNI</span><span class="o">=</span><span class="mi">16</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MESCRN</span><span class="o">=</span><span class="mi">17</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEDIAG</span><span class="o">=</span><span class="mi">18</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMAXE</span><span class="o">=</span><span class="mi">19</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MESTOP</span><span class="o">=</span><span class="mi">20</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEPRNT</span><span class="o">=</span><span class="mi">21</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">METDIG</span><span class="o">=</span><span class="mi">22</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MENTXT</span><span class="o">=</span><span class="mi">23</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIDAT</span><span class="o">=</span><span class="mi">24</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEFDAT</span><span class="o">=</span><span class="mi">25</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDAT</span><span class="o">=</span><span class="mi">26</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDA1</span><span class="o">=</span><span class="mi">27</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDA2</span><span class="o">=</span><span class="mi">28</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDA3</span><span class="o">=</span><span class="mi">29</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDA4</span><span class="o">=</span><span class="mi">30</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMDA5</span><span class="o">=</span><span class="mi">31</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">METABS</span><span class="o">=</span><span class="mi">32</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEERRS</span><span class="o">=</span><span class="mi">33</span>

  <span class="c">! Parameters for actions.</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MECONT</span><span class="o">=</span><span class="mi">50</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span>  <span class="n">MERET</span><span class="o">=</span><span class="mi">51</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEEMES</span><span class="o">=</span><span class="mi">52</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">METEXT</span><span class="o">=</span><span class="mi">53</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEFSPV</span><span class="o">=</span><span class="mi">54</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">METABL</span><span class="o">=</span><span class="mi">55</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MERES3</span><span class="o">=</span><span class="mi">56</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIVEC</span><span class="o">=</span><span class="mi">57</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIMAT</span><span class="o">=</span><span class="mi">58</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEJVEC</span><span class="o">=</span><span class="mi">59</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEJMAT</span><span class="o">=</span><span class="mi">60</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEFVEC</span><span class="o">=</span><span class="mi">61</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEFMAT</span><span class="o">=</span><span class="mi">62</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEGVEC</span><span class="o">=</span><span class="mi">63</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEGMAT</span><span class="o">=</span><span class="mi">64</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEIVCI</span><span class="o">=</span><span class="mi">65</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEJVCI</span><span class="o">=</span><span class="mi">66</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEFVCI</span><span class="o">=</span><span class="mi">67</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEGVCI</span><span class="o">=</span><span class="mi">68</span>

  <span class="c">! Parameter derived from those above.</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEMAXI</span><span class="o">=</span><span class="mi">68</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEGBAS</span><span class="o">=</span><span class="mi">49</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEVBAS</span><span class="o">=</span><span class="mi">10</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">MEVLAS</span><span class="o">=</span><span class="mi">33</span>
  <span class="c">!</span>
  <span class="c">! ************************** Variable Declarations *********************</span>
  <span class="c">!</span>
        <span class="c">!external MESSGS</span>
        <span class="kt">integer    </span><span class="n">MACT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">IDAT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
        <span class="kt">character  </span><span class="n">TEXT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
  <span class="c">!</span>
        <span class="kt">integer    </span><span class="n">I</span><span class="p">,</span> <span class="n">ICOL</span><span class="p">,</span> <span class="n">INCM</span><span class="p">(</span><span class="n">MECONT</span><span class="p">:</span><span class="n">MEIMAT</span><span class="p">),</span> <span class="n">INERR</span><span class="p">,</span> <span class="n">IOUT</span><span class="p">,</span> <span class="n">IROW</span><span class="p">,</span> <span class="n">IROW1</span><span class="p">,&amp;</span>
       <span class="p">&amp;</span>    <span class="n">ITEXTR</span><span class="p">,</span> <span class="n">ITXTSV</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">JJ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">K1</span><span class="p">,</span> <span class="n">K2</span><span class="p">,</span> <span class="n">KDILAB</span><span class="p">,</span> <span class="n">KK</span><span class="p">,</span> <span class="n">KNT</span><span class="p">,</span> <span class="n">KOLWID</span><span class="p">,</span> <span class="n">KP</span><span class="p">,&amp;</span>
       <span class="p">&amp;</span>    <span class="n">KS</span><span class="p">,</span> <span class="n">LASKNT</span><span class="p">,</span> <span class="n">LBUF1</span><span class="p">,</span> <span class="n">LBUF2</span><span class="p">,</span> <span class="n">LINSTR</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span>                          <span class="p">&amp;</span>
       <span class="p">&amp;</span>    <span class="n">MBNDHI</span><span class="p">(</span><span class="n">MEVBAS</span><span class="p">:</span><span class="n">MEVLAS</span><span class="p">),</span> <span class="n">MBNDLO</span><span class="p">(</span><span class="n">MEVBAS</span><span class="p">:</span><span class="n">MEVLAS</span><span class="p">),</span> <span class="n">MTEXT</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>       <span class="p">&amp;</span>
       <span class="p">&amp;</span>    <span class="n">MTEXTC</span><span class="p">,</span> <span class="n">MTEXTR</span><span class="p">,</span> <span class="n">NLINE</span><span class="p">,</span> <span class="n">NROCO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">NSKIP</span><span class="p">,</span> <span class="n">NTEXTR</span><span class="p">,</span> <span class="n">NTXTSV</span>
        <span class="kt">logical   </span><span class="n">GETW</span><span class="p">,</span> <span class="n">FIRST</span>
        <span class="kt">character </span><span class="n">ERMSG</span><span class="o">*</span><span class="mi">63</span><span class="p">,</span> <span class="n">ERMSG1</span><span class="o">*</span><span class="mi">27</span>
        <span class="kt">character </span><span class="n">C</span>

        <span class="kt">character</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">SC</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span>

        <span class="k">save  </span><span class="n">FIRST</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">ICOL</span><span class="p">,</span> <span class="n">INERR</span><span class="p">,</span> <span class="n">IROW</span><span class="p">,</span> <span class="n">IROW1</span><span class="p">,</span> <span class="n">ITXTSV</span><span class="p">,</span> <span class="n">KDILAB</span><span class="p">,</span> <span class="n">KNT</span><span class="p">,</span>    <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">LASKNT</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">MTEXT</span><span class="p">,</span> <span class="n">NLINE</span><span class="p">,</span> <span class="n">NSKIP</span><span class="p">,</span> <span class="n">NTEXTR</span><span class="p">,</span> <span class="n">NTXTSV</span>
        <span class="k">save</span> <span class="o">/</span><span class="n">CMESSI</span><span class="o">/</span><span class="p">,</span> <span class="o">/</span><span class="n">CMESSC</span><span class="o">/</span>
        <span class="k">equivalence</span> <span class="p">(</span><span class="n">MTEXT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">MTEXTR</span><span class="p">),</span> <span class="p">(</span><span class="n">MTEXT</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">MTEXTC</span><span class="p">)</span>
  <span class="c">!</span>
  <span class="c">! ************************** Data from common block ********************</span>
  <span class="c">!</span>
        <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LENBUF</span> <span class="o">=</span> <span class="mi">250</span>

        <span class="kt">logical          </span><span class="n">XARG</span><span class="p">,</span> <span class="n">GOTFMT</span><span class="p">,</span> <span class="n">XARGOK</span>
        <span class="kt">integer          </span><span class="n">ERRCNT</span><span class="p">,</span> <span class="n">EUNIT</span><span class="p">,</span> <span class="n">ICHAR0</span><span class="p">,</span> <span class="n">IRC</span><span class="p">,</span> <span class="n">IVAR</span><span class="p">(</span><span class="n">MEVBAS</span><span class="p">:</span><span class="n">MEVLAS</span><span class="p">),</span> <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="nb">IMAG</span><span class="p">,</span> <span class="n">INC</span><span class="p">,</span> <span class="n">ITEXT</span><span class="p">,</span> <span class="n">IWF</span><span class="p">,</span> <span class="n">IWG</span><span class="p">,</span> <span class="n">KDF</span><span class="p">,</span> <span class="n">KDFDEF</span><span class="p">,</span> <span class="n">KDI</span><span class="p">,</span> <span class="n">KDIAG</span><span class="p">,</span> <span class="n">KDJ</span><span class="p">,</span>      <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">KLINE</span><span class="p">,</span> <span class="n">KSCRN</span><span class="p">,</span> <span class="n">KSHIFT</span><span class="p">,</span> <span class="n">KSPEC</span><span class="p">,</span> <span class="n">KT</span><span class="p">,</span> <span class="n">MAXERR</span><span class="p">,</span> <span class="n">LASTI</span><span class="p">,</span> <span class="n">LBUF</span><span class="p">,</span> <span class="n">LENLIN</span><span class="p">,</span>  <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">LENOUT</span><span class="p">,</span> <span class="n">LENTRY</span><span class="p">,</span> <span class="n">LENTXT</span><span class="p">,</span> <span class="n">LHEAD</span><span class="p">,</span> <span class="n">LINERR</span><span class="p">,</span> <span class="n">LINMSG</span><span class="p">,</span> <span class="n">LOCBEG</span><span class="p">,</span> <span class="n">LPRINT</span><span class="p">,</span> <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">LSTOP</span><span class="p">,</span> <span class="n">LSTRT</span><span class="p">,</span> <span class="n">LTEXT</span><span class="p">,</span> <span class="n">MAXWID</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">MDAT</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">MPT</span><span class="p">,</span> <span class="n">MUNIT</span><span class="p">,</span> <span class="n">NCOL</span><span class="p">,</span>     <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">NDIM</span><span class="p">,</span> <span class="n">NFDAT</span><span class="p">,</span> <span class="n">NIDAT</span><span class="p">,</span> <span class="n">NMDAT</span><span class="p">,</span> <span class="n">NROW</span><span class="p">,</span> <span class="n">NTEXT</span><span class="p">,</span> <span class="n">OUNIT</span><span class="p">,</span> <span class="n">SUNIT</span><span class="p">,</span> <span class="n">TABSPA</span>
  <span class="c">!</span>
        <span class="kt">character </span><span class="n">BUF</span><span class="o">*</span><span class="p">(</span><span class="n">LENBUF</span><span class="p">),</span> <span class="n">DOLS</span><span class="o">*</span><span class="mi">72</span><span class="p">,</span> <span class="n">FMTC</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="n">FMTF</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span> <span class="n">FMTG</span><span class="o">*</span><span class="mi">15</span><span class="p">,</span>        <span class="p">&amp;</span>
       <span class="p">&amp;</span>  <span class="n">FMTI</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="n">FMTIM</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="n">FMTJ</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="n">FMTR</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="n">FMTT</span><span class="o">*</span><span class="mi">15</span>
        <span class="k">common</span> <span class="o">/</span><span class="n">CMESSI</span><span class="o">/</span> <span class="n">SUNIT</span><span class="p">,</span> <span class="n">LHEAD</span><span class="p">,</span> <span class="n">KDFDEF</span><span class="p">,</span> <span class="n">LINMSG</span><span class="p">,</span> <span class="n">LINERR</span><span class="p">,</span> <span class="n">MUNIT</span><span class="p">,</span>      <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">EUNIT</span><span class="p">,</span> <span class="n">KSCRN</span><span class="p">,</span> <span class="n">KDIAG</span><span class="p">,</span> <span class="n">MAXERR</span><span class="p">,</span> <span class="n">LSTOP</span><span class="p">,</span> <span class="n">LPRINT</span><span class="p">,</span> <span class="n">KDF</span><span class="p">,</span> <span class="n">NTEXT</span><span class="p">,</span> <span class="n">NIDAT</span><span class="p">,</span> <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">NFDAT</span><span class="p">,</span> <span class="n">NMDAT</span><span class="p">,</span> <span class="n">MDAT</span><span class="p">,</span> <span class="n">TABSPA</span><span class="p">,</span> <span class="n">ERRCNT</span><span class="p">,</span> <span class="n">ICHAR0</span><span class="p">,</span> <span class="nb">IMAG</span><span class="p">,</span> <span class="n">INC</span><span class="p">,</span> <span class="n">IRC</span><span class="p">,</span>    <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">ITEXT</span><span class="p">,</span> <span class="n">IWF</span><span class="p">,</span> <span class="n">IWG</span><span class="p">,</span> <span class="n">KDI</span><span class="p">,</span> <span class="n">KDJ</span><span class="p">,</span> <span class="n">KLINE</span><span class="p">,</span> <span class="n">KSHIFT</span><span class="p">,</span> <span class="n">KSPEC</span><span class="p">,</span> <span class="n">KT</span><span class="p">,</span> <span class="n">LASTI</span><span class="p">,</span>    <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">LBUF</span><span class="p">,</span> <span class="n">LENLIN</span><span class="p">,</span> <span class="n">LENOUT</span><span class="p">,</span> <span class="n">LENTRY</span><span class="p">,</span> <span class="n">LENTXT</span><span class="p">,</span> <span class="n">LOCBEG</span><span class="p">,</span> <span class="n">LSTRT</span><span class="p">,</span> <span class="n">LTEXT</span><span class="p">,</span>    <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">MAXWID</span><span class="p">,</span> <span class="n">MPT</span><span class="p">,</span> <span class="n">NROW</span><span class="p">,</span> <span class="n">NCOL</span><span class="p">,</span> <span class="n">NDIM</span><span class="p">,</span> <span class="n">OUNIT</span><span class="p">,</span> <span class="n">GOTFMT</span><span class="p">,</span> <span class="n">XARG</span><span class="p">,</span> <span class="n">XARGOK</span>
        <span class="k">common</span> <span class="o">/</span><span class="n">CMESSC</span> <span class="o">/</span> <span class="n">BUF</span><span class="p">,</span> <span class="n">DOLS</span><span class="p">,</span> <span class="n">FMTF</span><span class="p">,</span> <span class="n">FMTG</span><span class="p">,</span> <span class="n">FMTI</span><span class="p">,</span> <span class="n">FMTJ</span><span class="p">,</span> <span class="n">FMTT</span><span class="p">,</span> <span class="n">FMTIM</span>
        <span class="k">equivalence</span> <span class="p">(</span><span class="n">IVAR</span><span class="p">(</span><span class="n">MEVBAS</span><span class="p">),</span> <span class="n">SUNIT</span><span class="p">)</span>
        <span class="k">equivalence</span> <span class="p">(</span><span class="n">FMTIM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">FMTR</span><span class="p">),</span> <span class="p">(</span><span class="n">FMTIM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">FMTC</span><span class="p">)</span>
  <span class="c">!</span>
        <span class="k">equivalence</span> <span class="p">(</span><span class="n">NROCO</span><span class="p">,</span> <span class="n">NROW</span><span class="p">)</span>
        <span class="k">equivalence</span> <span class="p">(</span><span class="n">MAXWID</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">LINSTR</span><span class="p">),</span> <span class="p">(</span><span class="n">MAXWID</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">KOLWID</span><span class="p">)</span>
  <span class="c">! ************************** End of stuff from common block ************</span>
  <span class="c">!</span>
        <span class="k">data </span><span class="n">INERR</span><span class="p">,</span> <span class="n">FIRST</span> <span class="o">/</span> <span class="mi">0</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="o">/</span>
        <span class="k">data </span><span class="n">ERMSG</span> <span class="o">/</span>                                                      <span class="p">&amp;</span>
       <span class="p">&amp;</span><span class="s1">&#39; reports error: Stop level = x, Print level = y, Error index = &#39;</span><span class="o">/</span>
        <span class="k">data </span><span class="n">ERMSG1</span> <span class="o">/</span> <span class="s1">&#39;: Print level = y, Index = &#39;</span> <span class="o">/</span>
  <span class="c">!                 50  51, 52  53  54 55 56 57 58</span>
        <span class="k">data </span><span class="n">INCM</span> <span class="o">/</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span> <span class="o">/</span>
        <span class="k">data </span><span class="n">MBNDLO</span> <span class="o">/</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>  <span class="mi">39</span><span class="p">,</span>  <span class="mi">39</span><span class="p">,</span> <span class="o">-</span><span class="mi">99</span><span class="p">,</span> <span class="o">-</span><span class="mi">99</span><span class="p">,</span>         <span class="mi">0</span><span class="p">,</span>          <span class="p">&amp;</span>
       <span class="p">&amp;</span>       <span class="mi">0</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>        <span class="mi">1</span><span class="p">,</span>          <span class="mi">1</span><span class="p">,</span>            <span class="p">&amp;</span>
       <span class="p">&amp;</span>       <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000000000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000000000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000000000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000000000</span><span class="p">,</span>  <span class="p">&amp;</span>
       <span class="p">&amp;</span>       <span class="o">-</span><span class="mi">1000000000</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span> <span class="o">/</span>
        <span class="k">data </span><span class="n">MBNDHI</span> <span class="o">/</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span>  <span class="mi">99</span><span class="p">,</span>  <span class="mi">99</span><span class="p">,</span> <span class="mi">100000000</span><span class="p">,</span>          <span class="p">&amp;</span>
       <span class="p">&amp;</span>  <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">50</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span>        <span class="p">&amp;</span>
       <span class="p">&amp;</span>  <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span>  <span class="p">&amp;</span>
       <span class="p">&amp;</span>  <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000000000</span> <span class="o">/</span>
  <span class="c">!</span>
  <span class="c">! ************************* Start of Executable Code *******************</span>
  <span class="c">!</span>
  <span class="c">!</span>
        <span class="n">NSKIP</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">FIRST</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">FIRST</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
  <span class="c">! Initialize common block</span>
           <span class="n">SUNIT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
           <span class="n">LHEAD</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="n">LINMSG</span> <span class="o">=</span> <span class="n">LNMSG</span>
           <span class="n">LINERR</span> <span class="o">=</span> <span class="n">LNERR</span>
           <span class="n">MUNIT</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">EUNIT</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">KSCRN</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">MAXERR</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">TABSPA</span> <span class="o">=</span> <span class="mi">6</span>
           <span class="n">LSTOP</span> <span class="o">=</span> <span class="mi">3</span>
           <span class="n">LPRINT</span> <span class="o">=</span> <span class="mi">3</span>
           <span class="n">ERRCNT</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">ICHAR0</span> <span class="o">=</span> <span class="nb">ICHAR</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
           <span class="n">KDI</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="n">KDJ</span> <span class="o">=</span> <span class="mi">6</span>
           <span class="n">LENLIN</span> <span class="o">=</span> <span class="n">LNMSG</span>
           <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="n">OUNIT</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">DOLS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">40</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&#39;</span>
           <span class="n">DOLS</span><span class="p">(</span><span class="mi">41</span><span class="p">:</span><span class="mi">72</span><span class="p">)</span> <span class="o">=</span><span class="s1">&#39;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&#39;</span>
           <span class="n">FMTI</span> <span class="o">=</span> <span class="s1">&#39;(99I01)&#39;</span>
           <span class="n">FMTJ</span> <span class="o">=</span> <span class="s1">&#39;(99I06)&#39;</span>
           <span class="n">FMTG</span> <span class="o">=</span> <span class="s1">&#39;(1P,99Exx.xx)  &#39;</span>
  <span class="c">!++ CODE for .C. is inactive</span>
  <span class="c">!      FMTI = &#39;%*d&#39;</span>
  <span class="c">!      FMTJ = &#39;%*d\0&#39;</span>
  <span class="c">!      FMTG = &#39;%*.*E\0&#39;</span>
  <span class="c">!++ END</span>
        <span class="k">else</span>
  <span class="c">!               1  2  3   4    5    6    7    8   9   10   11</span>
           <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">850</span><span class="p">,</span><span class="mi">1160</span><span class="p">,</span><span class="mi">1620</span><span class="p">,</span><span class="mi">1130</span><span class="p">,</span><span class="mi">1530</span><span class="p">,</span><span class="mi">960</span><span class="p">,</span><span class="mi">1210</span><span class="p">,</span><span class="mi">1220</span><span class="p">),</span> <span class="n">LENTRY</span>
        <span class="k">end if</span>
  <span class="c">!                             First entry for a message</span>
      <span class="mi">5</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c">!                             Usual continuation entry</span>
     <span class="mi">10</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">ITEXT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">LENTXT</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">NIDAT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">NFDAT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">NMDAT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
  <span class="c">!                     Continuation entry when have a non printing error</span>
  <span class="c">! Skip all actions -- Inside non-printing error message.</span>
     <span class="mi">20</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">1</span>
     <span class="mi">30</span> <span class="n">K</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&lt;=</span> <span class="n">MERET</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="n">MERET</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="n">MECONT</span><span class="p">)</span> <span class="k">return</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MEGBAS</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
           <span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">else</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&gt;</span> <span class="n">MEIMAT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&gt;</span> <span class="n">MEMAXI</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
              <span class="n">K</span> <span class="o">=</span> <span class="n">MEIVEC</span> <span class="o">+</span> <span class="nb">mod</span><span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="n">MEIVEC</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
           <span class="k">end if</span>
<span class="k">           </span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">INCM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">go</span> <span class="n">to</span> <span class="mi">30</span>
  <span class="c">!</span>
  <span class="c">! Print BUF</span>
     <span class="mi">40</span> <span class="k">call </span><span class="n">MESSPR</span>
  <span class="c">!                             Usual place to end an action request.</span>
    <span class="mi">100</span> <span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">INCM</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
  <span class="c">!                             Pick up the next action request</span>
    <span class="mi">120</span> <span class="n">M</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&gt;</span> <span class="n">MEGBAS</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">140</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MEVLAS</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MBNDLO</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="k">then</span>
<span class="k">              </span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">MBNDLO</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
           <span class="k">else if</span> <span class="p">(</span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MBNDHI</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="k">then</span>
<span class="k">              </span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">MBNDHI</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
           <span class="k">end if</span>
  <span class="c">!            MEHEAD, MEDDIG, MEMLIN, MEELIN, MEMUNI, MEEUNI</span>
           <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">122</span><span class="p">,</span>    <span class="mi">124</span><span class="p">,</span>    <span class="mi">126</span><span class="p">,</span>    <span class="mi">126</span><span class="p">,</span>    <span class="mi">128</span><span class="p">,</span>    <span class="mi">128</span><span class="p">),</span> <span class="n">M</span> <span class="o">-</span> <span class="n">MESUNI</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">/=</span> <span class="n">MENTXT</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
           <span class="n">ITEXT</span> <span class="o">=</span> <span class="p">(</span><span class="n">NTEXT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENTXT</span>
           <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">-</span> <span class="n">LENTXT</span><span class="o">*</span><span class="n">ITEXT</span>
           <span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
    <span class="mi">122</span>    <span class="k">if</span> <span class="p">(</span><span class="n">LHEAD</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           end if</span>
<span class="k">           </span><span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
    <span class="mi">124</span>    <span class="n">KDF</span> <span class="o">=</span> <span class="n">KDFDEF</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
    <span class="mi">126</span>    <span class="n">LENLIN</span> <span class="o">=</span> <span class="n">LINMSG</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
    <span class="mi">128</span>    <span class="k">if</span> <span class="p">(</span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">K</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">IVAR</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
           <span class="k">end if</span>
<span class="k">           </span><span class="n">OUNIT</span> <span class="o">=</span> <span class="n">MUNIT</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">M</span> <span class="o">==</span> <span class="o">-</span><span class="n">MESUNI</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">SUNIT</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SUNIT</span> <span class="o">=</span> <span class="n">MESSGS</span><span class="p">()</span>
        <span class="k">end if</span>
  <span class="c">!</span>
        <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">IVAR</span><span class="p">(</span><span class="o">-</span><span class="n">M</span><span class="p">)</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">120</span>
  <span class="c">!  ME ..    CONT  RET EMES ETXT  FSPV TABL</span>
    <span class="mi">140</span> <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">170</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">910</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="n">M</span><span class="o">-</span><span class="n">MEGBAS</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&lt;=</span> <span class="n">MEGVCI</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1000</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
  <span class="c">!</span>
  <span class="c">! Action MECONT -- Continue message on next entry</span>
    <span class="mi">170</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">return</span>
  <span class="c">!</span>
  <span class="c">! Some kind of error in message specification.</span>
    <span class="mi">180</span> <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
        <span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">57</span><span class="p">)</span> <span class="o">=</span>                                                       <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="s1">&#39;Actions in MESS terminated due to error in usage of MESS.&#39;</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="mi">57</span>
  <span class="c">!</span>
  <span class="c">! Action MERET -- Finish a message.</span>
    <span class="mi">200</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">INERR</span>
        <span class="n">INERR</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="n">INERR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">330</span>
  <span class="c">!                       Finish print before exit.</span>
        <span class="k">call </span><span class="n">MESSPR</span>
        <span class="k">return</span>
  <span class="c">!</span>
  <span class="c">! Action MEEMES -- Start an error message</span>
    <span class="mi">310</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">ERRCNT</span> <span class="o">=</span> <span class="n">ERRCNT</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="c">!++  Code for UMESS is inactive</span>
  <span class="c">!      call UMESS(TEXT, MACT(I+1), IVAR)</span>
  <span class="c">!++  End</span>
        <span class="nb">IMAG</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">MAXERR</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">MAXERR</span><span class="p">,</span> <span class="mi">1000</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="nb">IMAG</span><span class="p">)</span>
        <span class="n">KS</span> <span class="o">=</span> <span class="n">K</span> <span class="o">/</span> <span class="mi">10</span>
        <span class="n">KP</span> <span class="o">=</span> <span class="n">K</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">KS</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KS</span> <span class="o">&lt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LSTOP</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">KP</span> <span class="o">&lt;=</span> <span class="n">LPRINT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">INERR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
              <span class="n">go</span> <span class="n">to</span> <span class="mi">20</span>
           <span class="k">end if</span>
<span class="k">           </span><span class="n">INERR</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">INERR</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">OUNIT</span> <span class="o">=</span> <span class="n">EUNIT</span>
        <span class="n">LENLIN</span> <span class="o">=</span> <span class="n">LINERR</span>
  <span class="c">!                        Output a blank line.</span>
        <span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="mi">330</span> <span class="k">call </span><span class="n">MESSPR</span>
  <span class="c">!                        Put out line of $&#39;s</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LHEAD</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">LBUF</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DOLS</span><span class="p">),</span> <span class="n">LENLIN</span><span class="p">)</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="n">DOLS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">INERR</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">BUF</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">37</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39; Fatal error -- Program stopped. &#39;</span>
           <span class="k">call </span><span class="n">MESSPR</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">INERR</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">!                                 Just finished an error message</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">INERR</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">           </span><span class="n">OUNIT</span> <span class="o">=</span> <span class="n">MUNIT</span>
           <span class="n">LENLIN</span> <span class="o">=</span> <span class="n">LINMSG</span>
           <span class="k">return</span>
<span class="k">        end if</span>
  <span class="c">!                     Just starting an error message get program name</span>
        <span class="n">NTEXTR</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
  <span class="c">!                     Got the program name in BUF.</span>
    <span class="mi">370</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LBUF</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">ERMSG1</span><span class="p">(</span><span class="mi">17</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">KP</span> <span class="o">+</span> <span class="n">ICHAR0</span><span class="p">)</span>
           <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">LBUF</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">ERMSG1</span><span class="p">))</span> <span class="o">=</span> <span class="n">ERMSG1</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">ERMSG1</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">ERMSG</span><span class="p">(</span><span class="mi">30</span><span class="p">:</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">KS</span> <span class="o">+</span> <span class="n">ICHAR0</span><span class="p">)</span>
           <span class="n">ERMSG</span><span class="p">(</span><span class="mi">47</span><span class="p">:</span><span class="mi">47</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">KP</span> <span class="o">+</span> <span class="n">ICHAR0</span><span class="p">)</span>
           <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">LBUF</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">ERMSG</span><span class="p">))</span> <span class="o">=</span> <span class="n">ERMSG</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">ERMSG</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">call </span><span class="n">MESSFI</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="n">KDI</span>
        <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTI</span><span class="p">)</span> <span class="nb">IMAG</span>
  <span class="c">!          Finish up the start error message action.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENTXT</span>
           <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">LENTXT</span><span class="o">*</span><span class="n">ITEXT</span>
           <span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">KSPEC</span> <span class="o">=</span> <span class="mi">13</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">480</span>
  <span class="c">!                  Take care of any left over print from error header</span>
    <span class="mi">390</span> <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">MESSPR</span>
  <span class="c">!</span>
  <span class="c">! Action METEXT -- Print string from TEXT</span>
    <span class="mi">400</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">NTEXTR</span> <span class="o">=</span> <span class="n">NTEXT</span>
        <span class="n">ITEXTR</span> <span class="o">=</span> <span class="n">ITEXT</span>
  <span class="c">!                  Continue with print from TEXT</span>
  <span class="c">! K     take at most K-1 chars., but if 0 take max number</span>
  <span class="c">! K1    is last loc. used from TEXT if LENTXT is BIG.</span>
  <span class="c">! NEXT  is first character location in TEXT(ITEXT)</span>
  <span class="c">! K2    is last character location in TEXT(ITEXT)</span>
  <span class="c">! LSTRT is first character position in BUF</span>
  <span class="c">! LBUF  is last used character position in BUF</span>

    <span class="mi">410</span> <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">K2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LENTXT</span><span class="p">,</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="p">(</span><span class="n">LENBUF</span> <span class="o">-</span> <span class="n">LSTRT</span><span class="p">))</span>
        <span class="n">K</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">K2</span><span class="p">),</span> <span class="n">SC</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">! Want to take all that we can.</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LSTRT</span> <span class="o">+</span> <span class="n">K2</span> <span class="o">-</span> <span class="n">NTEXT</span>
           <span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">K2</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">K2</span> <span class="o">==</span> <span class="n">LENTXT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">1</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&lt;=</span> <span class="n">LENLIN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
           <span class="k">else</span>
<span class="k">             </span><span class="n">NTEXT</span> <span class="o">=</span> <span class="n">K2</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="k">end if</span>
<span class="k">           </span><span class="n">KSPEC</span> <span class="o">=</span> <span class="mi">12</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">ITEXT</span> <span class="o">-</span> <span class="n">ITEXTR</span> <span class="o">&lt;</span> <span class="mi">4000</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">480</span>
           <span class="n">KSPEC</span> <span class="o">=</span> <span class="mi">2</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="n">K</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="o">+</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
  <span class="c">!        Jump to location below if get $ after computing an NSKIP.</span>
    <span class="mi">415</span> <span class="k">continue</span>
<span class="k">        </span><span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="n">K</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">&gt;</span> <span class="n">LENTXT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">==</span> <span class="n">LENTXT</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">C</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">LENTXT</span><span class="p">:</span><span class="n">LENTXT</span><span class="p">)</span>
              <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">else</span>
<span class="k">              </span><span class="n">C</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
              <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">2</span>
           <span class="k">end if</span>
<span class="k">        else</span>
<span class="k">           </span><span class="n">C</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">NTEXT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">C</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">!                Special code to take care of &quot; &quot; following &quot;$&quot;.</span>
           <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">-</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">-</span> <span class="mi">1</span>
              <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">LENTXT</span>
           <span class="k">end if</span>
<span class="k">           </span><span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">NTEXTR</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">LENTRY</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">370</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">1510</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">KSPEC</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="s1">&#39;BERNIMFJG(T&#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
    <span class="mi">430</span> <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&gt;</span> <span class="n">LENLIN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">480</span>
  <span class="c">!              1   2   3   4   5   6   7   8   9  10  11  12, 13</span>
  <span class="c">!              B   E   R   N   I   M   F   J   G   (   T done end err</span>
        <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">455</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">450</span><span class="p">,</span><span class="mi">460</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="mi">680</span><span class="p">,</span><span class="mi">900</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="mi">900</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">690</span><span class="p">,</span><span class="mi">410</span><span class="p">,</span><span class="mi">390</span><span class="p">),</span> <span class="n">KSPEC</span>
  <span class="c">!               No match  -- Check for setting NSKIP</span>
        <span class="k">if</span> <span class="p">(((</span><span class="n">C</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">C</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">C</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">))</span> <span class="k">then</span>
<span class="k">           </span><span class="n">NSKIP</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">K1</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">C</span> <span class="o">/=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">436</span>
           <span class="n">K1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="mi">433</span>    <span class="n">C</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span>
           <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">&gt;=</span> <span class="n">LENTXT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
              <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">end if</span>
<span class="k">    </span><span class="mi">436</span>    <span class="k">if</span> <span class="p">((</span><span class="n">C</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">C</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">))</span> <span class="k">then</span>
<span class="k">              </span><span class="n">NSKIP</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">NSKIP</span> <span class="o">+</span> <span class="n">K1</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">-</span> <span class="n">ICHAR0</span><span class="p">)</span>
              <span class="n">go</span> <span class="n">to</span> <span class="mi">433</span>
           <span class="k">end if</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">C</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">K</span> <span class="o">=</span> <span class="mi">0</span>
              <span class="n">go</span> <span class="n">to</span> <span class="mi">415</span>
           <span class="k">end if</span>
<span class="k">        end if</span>
  <span class="c">!</span>
  <span class="c">! Continue with the text.</span>
    <span class="mi">440</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="n">C</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
  <span class="c">!                        Reset NTEXT for $R</span>
    <span class="mi">450</span> <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXTR</span>
        <span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXTR</span>
  <span class="c">!                             Done with METEXT action.</span>
    <span class="mi">455</span> <span class="n">NMDAT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">100</span>
  <span class="c">!           At this point want to output all in BUF</span>
    <span class="mi">460</span> <span class="k">do </span><span class="mi">470</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">480</span>
    <span class="mi">470</span> <span class="k">continue</span>
<span class="k">    </span><span class="mi">480</span> <span class="n">LBUF2</span> <span class="o">=</span> <span class="n">LBUF</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LBUF2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">LBUF</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="k">else if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&gt;</span> <span class="n">LENLIN</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           do </span><span class="mi">485</span> <span class="n">K</span> <span class="o">=</span> <span class="n">LENLIN</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">LENLIN</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">K</span><span class="p">:</span><span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 </span><span class="n">LBUF</span> <span class="o">=</span> <span class="n">K</span> <span class="o">-</span> <span class="mi">1</span>
                 <span class="n">go</span> <span class="n">to</span> <span class="mi">490</span>
              <span class="k">end if</span>
<span class="k">    </span><span class="mi">485</span>    <span class="k">continue</span>
<span class="k">           </span><span class="n">LBUF</span> <span class="o">=</span> <span class="n">LENLIN</span>
        <span class="k">end if</span>
<span class="k">    </span><span class="mi">490</span> <span class="n">LBUF1</span> <span class="o">=</span> <span class="n">LBUF</span>
        <span class="k">call </span><span class="n">MESSPR</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LBUF1</span> <span class="o">&gt;=</span> <span class="n">LBUF2</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">!                       The entire buffer has been printed.</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">KSPEC</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">455</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">KSPEC</span> <span class="o">/=</span> <span class="mi">4</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
        <span class="k">end if</span>
  <span class="c">!                       Remove trailing blanks</span>
        <span class="k">do </span><span class="mi">510</span> <span class="n">LBUF1</span> <span class="o">=</span> <span class="n">LBUF1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">LBUF2</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LBUF1</span><span class="p">:</span><span class="n">LBUF1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">520</span>
    <span class="mi">510</span> <span class="k">continue</span>
  <span class="c">!                       Shift the contents of the buffer.</span>
    <span class="mi">520</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF2</span><span class="o">-</span><span class="n">LBUF1</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">LSTRT</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="mi">530</span> <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&gt;=</span> <span class="n">LBUF1</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">!                              Take care of overlap.</span>
           <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">LBUF1</span> <span class="o">-</span> <span class="n">LSTRT</span>
           <span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF1</span><span class="p">:</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF1</span>
           <span class="n">LBUF1</span> <span class="o">=</span> <span class="n">K</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">530</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&gt;=</span> <span class="n">LSTRT</span><span class="p">)</span> <span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF1</span><span class="p">:</span><span class="n">LBUF2</span><span class="p">)</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">430</span>
  <span class="c">!</span>
  <span class="c">! Get information on user format</span>
    <span class="mi">600</span> <span class="n">KSPEC</span> <span class="o">=</span> <span class="mi">8</span>
  <span class="c">!              I,   i,   F,   f,   E,   e,   G,   g</span>
        <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">604</span><span class="p">,</span> <span class="mi">604</span><span class="p">,</span> <span class="mi">601</span><span class="p">,</span> <span class="mi">601</span><span class="p">,</span> <span class="mi">602</span><span class="p">,</span> <span class="mi">602</span><span class="p">,</span> <span class="mi">602</span><span class="p">,</span> <span class="mi">602</span><span class="p">),</span>                   <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="nb">index</span><span class="p">(</span><span class="s1">&#39;IiFfEeGg&#39;</span><span class="p">,</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">))</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
    <span class="mi">601</span> <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
        <span class="n">FMTG</span><span class="o">=</span><span class="s1">&#39;(0P,99F&#39;</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">603</span>
    <span class="mi">602</span> <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
        <span class="n">FMTG</span><span class="o">=</span><span class="s1">&#39;(1P,99&#39;</span><span class="o">//</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span>
  <span class="c">!++ CODE for .C. is inactive</span>
  <span class="c">!      FMTG(5:5) = TEXT(ITEXT)(NTEXT:NTEXT)</span>
  <span class="c">!++ END</span>
    <span class="mi">603</span> <span class="n">KSPEC</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="mi">604</span> <span class="nb">IMAG</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">GETW</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">NTEXT</span>
        <span class="n">FMTT</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
    <span class="mi">606</span> <span class="k">continue</span>
<span class="k">           </span><span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">&gt;</span> <span class="n">LENTXT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
              <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">end if</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">FMTT</span><span class="p">(</span><span class="n">NTEXT</span><span class="o">-</span><span class="n">K</span><span class="p">:</span><span class="n">NTEXT</span><span class="o">-</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span>
  <span class="c">!++ END</span>
           <span class="n">JJ</span> <span class="o">=</span> <span class="nb">ichar</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">))</span> <span class="o">-</span> <span class="n">ICHAR0</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">GETW</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              if</span> <span class="p">((</span><span class="n">JJ</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">JJ</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                 </span><span class="nb">IMAG</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="nb">IMAG</span> <span class="o">+</span> <span class="n">JJ</span>
              <span class="k">else</span>
<span class="k">                 if</span> <span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>  <span class="n">go</span> <span class="n">to</span> <span class="mi">610</span>
                 <span class="k">if</span> <span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>  <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
                 <span class="n">GETW</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
              <span class="k">end if</span>
<span class="k">           else</span>
<span class="k">              if</span> <span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">610</span>
              <span class="k">if</span> <span class="p">((</span><span class="n">JJ</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">JJ</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
           <span class="k">end if</span>
<span class="k">        </span><span class="n">go</span> <span class="n">to</span> <span class="mi">606</span>
  <span class="c">!</span>
    <span class="mi">610</span> <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">&gt;</span> <span class="n">LENTXT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="n">NTEXT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">end if</span>
  <span class="c">!++ CODE for ~.C. is active</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KSPEC</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">KDJ</span> <span class="o">=</span> <span class="nb">IMAG</span>
<span class="nb">           </span><span class="n">FMTJ</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">FMTT</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">IWG</span> <span class="o">=</span> <span class="nb">IMAG</span>
<span class="nb">           </span><span class="n">FMTG</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">15</span><span class="p">)</span> <span class="o">=</span> <span class="n">FMTT</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">NTEXT</span><span class="p">)</span> <span class="o">==</span> <span class="n">SC</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KSPEC</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">700</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">XARGOK</span><span class="p">)</span> <span class="k">return</span>
<span class="k">        </span><span class="n">go</span> <span class="n">to</span> <span class="mi">440</span>
  <span class="c">!</span>
  <span class="c">!                         Print from MDAT</span>
    <span class="mi">680</span> <span class="n">IOUT</span> <span class="o">=</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">NMDAT</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NMDAT</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">MDAT</span><span class="p">(</span><span class="n">NMDAT</span><span class="p">)</span> <span class="o">=</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">NMDAT</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">NMDAT</span> <span class="o">=</span> <span class="n">NMDAT</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">go</span> <span class="n">to</span> <span class="mi">720</span>
  <span class="c">!</span>
  <span class="c">!                         Process a tab</span>
    <span class="mi">690</span> <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LBUF</span> <span class="o">+</span> <span class="n">TABSPA</span> <span class="o">-</span> <span class="nb">mod</span><span class="p">(</span><span class="n">LBUF</span><span class="p">,</span> <span class="n">TABSPA</span><span class="p">),</span> <span class="n">LENLIN</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">850</span>
  <span class="c">!                         Print from IDAT</span>
    <span class="mi">700</span> <span class="n">NIDAT</span> <span class="o">=</span> <span class="n">NIDAT</span> <span class="o">+</span> <span class="n">NSKIP</span>
        <span class="n">NSKIP</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">IOUT</span> <span class="o">=</span> <span class="n">IDAT</span><span class="p">(</span><span class="n">NIDAT</span><span class="p">)</span>
        <span class="n">NIDAT</span> <span class="o">=</span> <span class="n">NIDAT</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="mi">720</span> <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">IMAG</span> <span class="o">=</span> <span class="n">IOUT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KSPEC</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="n">KDJ</span>
        <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTJ</span><span class="p">)</span> <span class="n">IOUT</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">850</span>
        <span class="k">end if</span>
  <span class="c">!</span>
  <span class="c">!                Get format for integer output.</span>
        <span class="k">call </span><span class="n">MESSFI</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="n">KDI</span>
        <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTI</span><span class="p">)</span> <span class="n">IOUT</span>
  <span class="c">!                         Entry here to check line after numeric output.</span>
    <span class="mi">850</span> <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&lt;=</span> <span class="n">LENLIN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
        <span class="n">KSPEC</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">480</span>
  <span class="c">!</span>
  <span class="c">!                          Take care of output for extra argument.</span>
    <span class="mi">900</span> <span class="k">if</span> <span class="p">(</span><span class="n">XARGOK</span><span class="p">)</span> <span class="k">return</span>
<span class="k">        </span><span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
  <span class="c">!</span>
  <span class="c">! Action METABL -- Start a table</span>
    <span class="mi">910</span> <span class="n">GOTFMT</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GOTFMT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">IROW</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="n">KOLWID</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">MESSPR</span>
    <span class="mi">920</span> <span class="k">continue</span>
<span class="k">        </span><span class="n">BUF</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="n">NROW</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">NCOL</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ICOL</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">3</span>
    <span class="mi">940</span> <span class="n">ICOL</span> <span class="o">=</span> <span class="n">ICOL</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">JJ</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">ICOL</span><span class="p">)</span>
        <span class="n">KLINE</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">JJ</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">LENOUT</span> <span class="o">=</span> <span class="n">JJ</span> <span class="o">/</span> <span class="mi">100000</span>
        <span class="n">NCOL</span> <span class="o">=</span> <span class="n">NCOL</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">KLINE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">GOTFMT</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">!                                 Print the data</span>
           <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LBUF</span> <span class="o">+</span> <span class="n">KLINE</span> <span class="o">*</span> <span class="n">LENOUT</span><span class="p">,</span> <span class="n">LENBUF</span><span class="p">)</span>
           <span class="n">JJ</span> <span class="o">=</span> <span class="n">JJ</span> <span class="o">/</span> <span class="mi">100</span>
           <span class="n">KK</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">JJ</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="c">!              Text,   I   I&#39;,   F    E    G</span>
           <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">948</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">943</span><span class="p">,</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">944</span><span class="p">),</span> <span class="n">KK</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
  <span class="c">!                             Integer output</span>
    <span class="mi">941</span>    <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">KDI</span> <span class="o">=</span> <span class="n">LENOUT</span>
           <span class="n">FMTI</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">LENOUT</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">ichar0</span><span class="p">)</span>
           <span class="n">FMTI</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">LENOUT</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">ichar0</span><span class="p">)</span>
  <span class="c">!++ END</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">KK</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTI</span><span class="p">)</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
              <span class="n">go</span> <span class="n">to</span> <span class="mi">960</span>
           <span class="k">end if</span>
  <span class="c">!                            Regular integer output</span>
           <span class="n">NIDAT</span> <span class="o">=</span> <span class="n">NIDAT</span> <span class="o">+</span> <span class="n">NSKIP</span>
           <span class="n">NSKIP</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTI</span><span class="p">)</span> <span class="p">(</span><span class="n">IDAT</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">K</span> <span class="o">=</span> <span class="n">NIDAT</span><span class="p">,</span>             <span class="p">&amp;</span>
       <span class="p">&amp;</span>      <span class="n">NIDAT</span><span class="o">+</span><span class="n">KLINE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">NIDAT</span> <span class="o">=</span> <span class="n">NIDAT</span> <span class="o">+</span> <span class="n">KLINE</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">960</span>
  <span class="c">!                           Various floating point output</span>
    <span class="mi">943</span>    <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">FMTF</span> <span class="o">=</span> <span class="s1">&#39;(0P,99F  .  )&#39;</span>
  <span class="c">!++ END</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">946</span>
    <span class="mi">944</span>    <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">FMTF</span> <span class="o">=</span> <span class="s1">&#39;(1P,99G  .  )&#39;</span>
  <span class="c">!++ END</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">946</span>
    <span class="mi">945</span>    <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">FMTF</span> <span class="o">=</span> <span class="s1">&#39;(1P,99E  .  )&#39;</span>
  <span class="c">!++ END</span>
    <span class="mi">946</span>    <span class="n">JJ</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">JJ</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">FMTF</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">ICHAR0</span> <span class="o">+</span> <span class="n">LENOUT</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">FMTF</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">ICHAR0</span> <span class="o">+</span> <span class="nb">mod</span><span class="p">(</span><span class="n">LENOUT</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
           <span class="n">FMTF</span><span class="p">(</span><span class="mi">11</span><span class="p">:</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">ICHAR0</span> <span class="o">+</span> <span class="n">JJ</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">FMTF</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">ICHAR0</span> <span class="o">+</span> <span class="nb">mod</span><span class="p">(</span><span class="n">JJ</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
  <span class="c">!++ CODE for .C. is inactive</span>
  <span class="c">!        IWF = LENOUT</span>
  <span class="c">!        lfprec = JJ</span>
  <span class="c">!++ END</span>
           <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">XARGOK</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
           <span class="n">MPT</span> <span class="o">=</span> <span class="n">NFDAT</span>
           <span class="n">NFDAT</span> <span class="o">=</span> <span class="n">NFDAT</span> <span class="o">+</span> <span class="n">KLINE</span>
           <span class="k">return</span>
  <span class="c">!                           Text output</span>
    <span class="mi">948</span>    <span class="n">K1</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="n">LBUF</span> <span class="o">-</span> <span class="n">LSTRT</span>
           <span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="n">ITEXT</span><span class="p">)(</span><span class="n">NTEXT</span><span class="p">:</span><span class="n">K1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">K1</span>
        <span class="k">else</span>
  <span class="c">!                                 Print the heading</span>
           <span class="n">KT</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">call </span><span class="n">MESSMH</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">KT</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
        <span class="k">end if</span>
<span class="k">    </span><span class="mi">960</span> <span class="k">if</span> <span class="p">((</span><span class="n">LBUF</span> <span class="o">&lt;=</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">))</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NCOL</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">940</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">JJ</span> <span class="o">=</span> <span class="n">LBUF</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">MDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
           <span class="k">call </span><span class="n">MESSPR</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">JJ</span>
        <span class="k">else</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">IROW</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              if</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">!++ CODE for ~.C. is active</span>
                 <span class="k">if</span> <span class="p">(</span><span class="n">SUNIT</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SUNIT</span> <span class="o">=</span> <span class="n">MESSGS</span><span class="p">()</span>
                 <span class="k">rewind</span><span class="p">(</span><span class="n">SUNIT</span><span class="p">)</span>
              <span class="k">end if</span>
<span class="k">           end if</span>
<span class="k">           write</span><span class="p">(</span><span class="n">SUNIT</span><span class="p">)</span> <span class="n">BUF</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">))</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&gt;</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">))</span> <span class="k">then</span>
<span class="k">           </span><span class="n">BUF</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="n">LBUF</span> <span class="o">-</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">BUF</span><span class="p">(</span><span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">-</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span>
           <span class="n">NROW</span> <span class="o">=</span> <span class="n">NROW</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GOTFMT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              if</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
              <span class="n">MDAT</span><span class="p">(</span><span class="n">NROW</span><span class="p">)</span> <span class="o">=</span> <span class="n">LBUF</span>
           <span class="k">end if</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">NCOL</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">960</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">940</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">LBUF</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GOTFMT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">GOTFMT</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
           <span class="n">IROW</span> <span class="o">=</span> <span class="n">IROW</span> <span class="o">-</span> <span class="mi">1</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">920</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">999</span>
        <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">999</span>
        <span class="n">endfile</span> <span class="n">SUNIT</span>
        <span class="n">KK</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="mi">994</span> <span class="n">KK</span> <span class="o">=</span> <span class="n">KK</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KK</span> <span class="o">&gt;</span> <span class="n">NROW</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">999</span>
        <span class="k">rewind</span><span class="p">(</span><span class="n">SUNIT</span><span class="p">)</span>
        <span class="n">IROW</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">KK</span>
    <span class="mi">995</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">IROW</span> <span class="o">=</span> <span class="n">IROW</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IROW</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           write</span><span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;(I4)&#39;</span><span class="p">)</span> <span class="nb">mod</span><span class="p">(</span><span class="n">IROW</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="k">end if</span>
<span class="k">        do </span><span class="mi">996</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">K</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">==</span> <span class="n">K</span><span class="p">)</span> <span class="n">LBUF</span> <span class="o">=</span> <span class="n">MDAT</span><span class="p">(</span><span class="n">KK</span><span class="p">)</span>
           <span class="k">read</span><span class="p">(</span><span class="n">SUNIT</span><span class="p">,</span> <span class="k">END</span> <span class="o">=</span> <span class="mi">994</span><span class="p">)</span> <span class="n">BUF</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="n">LBUF</span><span class="p">)</span>
    <span class="mi">996</span> <span class="k">continue</span>
<span class="k">        </span><span class="n">K</span> <span class="o">=</span> <span class="n">NROW</span>
        <span class="k">call </span><span class="n">MESSPR</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">995</span>
    <span class="mi">999</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span>
  <span class="c">!</span>
  <span class="c">!                          Get started with vector or matrix output</span>
   <span class="mi">1000</span> <span class="n">INC</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">LOCBEG</span> <span class="o">=</span> <span class="n">NIDAT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&gt;</span> <span class="n">MEGMAT</span><span class="p">)</span> <span class="k">then</span>
  <span class="c">! Have a user set increment between entries of a vector.</span>
          <span class="n">M</span> <span class="o">=</span> <span class="n">MEIVEC</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="n">MEIVCI</span><span class="p">)</span>
          <span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="n">INC</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">XARG</span> <span class="o">=</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="n">MEJMAT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">XARG</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">4</span>
           <span class="n">LOCBEG</span> <span class="o">=</span> <span class="n">NFDAT</span>
           <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">XARGOK</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">GOTFMT</span> <span class="o">=</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="n">MEIMAT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">GOTFMT</span><span class="p">)</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">LOCBEG</span> <span class="o">=</span> <span class="n">LOCBEG</span> <span class="o">+</span> <span class="n">NSKIP</span>
        <span class="n">NSKIP</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">MPT</span> <span class="o">=</span> <span class="n">LOCBEG</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">==</span> <span class="n">MEIMAT</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1300</span>
  <span class="c">!                           Take care of setup for vector output</span>
        <span class="n">KNT</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">LASKNT</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LASKNT</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">LASKNT</span> <span class="o">=</span> <span class="o">-</span><span class="n">LASKNT</span>
           <span class="n">KNT</span> <span class="o">=</span> <span class="n">LOCBEG</span> <span class="o">-</span> <span class="mi">1</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">LASKNT</span> <span class="o">&lt;=</span> <span class="n">KNT</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="nb">IMAG</span> <span class="o">=</span> <span class="n">LASKNT</span>
        <span class="n">LASTI</span> <span class="o">=</span> <span class="n">LOCBEG</span> <span class="o">+</span> <span class="n">INC</span> <span class="o">*</span> <span class="p">(</span><span class="n">LASKNT</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">KNT</span><span class="p">)</span>
        <span class="n">NCOL</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c">!                          Get format for label output.</span>
        <span class="k">call </span><span class="n">MESSFI</span>
        <span class="n">FMTR</span> <span class="o">=</span> <span class="n">FMTI</span>
        <span class="n">KDILAB</span> <span class="o">=</span> <span class="n">KDI</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">LINSTR</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">KDILAB</span><span class="o">+</span><span class="mi">2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">XARG</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GOTFMT</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1150</span>
           <span class="n">IWF</span> <span class="o">=</span> <span class="n">IWG</span>
           <span class="n">FMTF</span> <span class="o">=</span> <span class="n">FMTG</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">1160</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">MESSFD</span><span class="p">(</span><span class="n">IDAT</span><span class="p">)</span>
  <span class="c">!                                          After integer format</span>
        <span class="n">LENOUT</span> <span class="o">=</span> <span class="n">KDI</span>
        <span class="n">NIDAT</span> <span class="o">=</span> <span class="n">LASTI</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="c">!                                          Common code continues here</span>
   <span class="mi">1080</span> <span class="n">NLINE</span> <span class="o">=</span> <span class="p">(</span><span class="n">LENLIN</span> <span class="o">-</span> <span class="n">LINSTR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENOUT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1090</span>
        <span class="n">K</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">LINSTR</span><span class="p">,</span> <span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(((</span><span class="n">K</span><span class="o">-</span><span class="n">LINSTR</span><span class="p">)</span><span class="o">/</span><span class="n">LENOUT</span> <span class="o">+</span> <span class="p">(</span><span class="n">LENLIN</span><span class="o">-</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">LENOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">NLINE</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="n">K</span> <span class="o">+</span> <span class="p">&amp;</span>
       <span class="p">&amp;</span>   <span class="n">LENOUT</span> <span class="o">-</span> <span class="nb">mod</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">LINSTR</span><span class="p">,</span> <span class="n">LENOUT</span><span class="p">)</span>
        <span class="n">KLINE</span> <span class="o">=</span> <span class="p">(</span><span class="n">LENLIN</span> <span class="o">-</span> <span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENOUT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KLINE</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">LASKNT</span><span class="o">-</span><span class="n">KNT</span><span class="p">,</span> <span class="n">NLINE</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1085</span>
        <span class="n">LINSTR</span> <span class="o">=</span> <span class="n">K</span> <span class="o">-</span> <span class="n">LENOUT</span> <span class="o">*</span> <span class="p">((</span><span class="n">K</span> <span class="o">-</span> <span class="n">LINSTR</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENOUT</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KLINE</span> <span class="o">&gt;=</span> <span class="n">LASKNT</span><span class="o">-</span><span class="n">KNT</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">           </span><span class="n">KLINE</span> <span class="o">=</span> <span class="n">LASKNT</span> <span class="o">-</span> <span class="n">KNT</span>
           <span class="n">K</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">KNT</span> <span class="o">=</span> <span class="n">KNT</span> <span class="o">+</span> <span class="n">KLINE</span>
        <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">K</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">1110</span>
   <span class="mi">1085</span> <span class="k">call </span><span class="n">MESSPR</span>
   <span class="mi">1090</span> <span class="k">continue</span>
  <span class="c">!++ CODE for ~.C. is active</span>
        <span class="n">BUF</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">KDILAB</span><span class="p">),</span> <span class="n">FMTR</span><span class="p">)</span> <span class="n">KNT</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">BUF</span><span class="p">(</span><span class="n">KDILAB</span><span class="p">:</span><span class="n">KDILAB</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">KLINE</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">NLINE</span><span class="p">,</span> <span class="n">LASKNT</span> <span class="o">-</span> <span class="n">KNT</span><span class="p">)</span>
        <span class="n">KNT</span> <span class="o">=</span> <span class="n">KNT</span> <span class="o">+</span> <span class="n">KLINE</span>
        <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">KDILAB</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">KDILAB</span><span class="p">),</span> <span class="n">FMTR</span><span class="p">)</span> <span class="n">KNT</span>
        <span class="n">BUF</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">KDILAB</span><span class="p">:</span><span class="n">LINSTR</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LINSTR</span>
   <span class="mi">1110</span> <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LBUF</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="n">LENOUT</span> <span class="o">*</span> <span class="n">KLINE</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">XARG</span><span class="p">)</span> <span class="k">return</span>
  <span class="c">!                                    Integer output</span>
  <span class="c">!++ CODE for ~.C. is active</span>
        <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTI</span><span class="p">)</span> <span class="p">(</span><span class="n">IDAT</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">K</span> <span class="o">=</span> <span class="n">MPT</span><span class="p">,</span>                  <span class="p">&amp;</span>
       <span class="p">&amp;</span>    <span class="n">MPT</span><span class="o">+</span><span class="n">INC</span><span class="o">*</span><span class="p">(</span><span class="n">KLINE</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">INC</span><span class="p">)</span>
        <span class="n">MPT</span> <span class="o">=</span> <span class="n">MPT</span> <span class="o">+</span> <span class="n">KLINE</span> <span class="o">*</span> <span class="n">INC</span>
  <span class="c">!</span>
  <span class="c">!                                     Entry here after vector output.</span>
   <span class="mi">1130</span> <span class="k">if</span> <span class="p">(</span><span class="n">MPT</span> <span class="o">&lt;=</span> <span class="n">LASTI</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1085</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
  <span class="c">!                                          Get other format</span>
   <span class="mi">1150</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">return</span>
  <span class="c">!                                          After other format</span>
   <span class="mi">1160</span> <span class="n">LENOUT</span> <span class="o">=</span> <span class="n">IWF</span>
        <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="n">NFDAT</span> <span class="o">=</span> <span class="n">LASTI</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">1080</span>


  <span class="c">!                         Sparse vector output.</span>
   <span class="mi">1200</span> <span class="n">XARG</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">XARGOK</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
        <span class="n">GOTFMT</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
        <span class="n">MPT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">LOCBEG</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">INC</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">LASKNT</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">LASTI</span> <span class="o">=</span> <span class="n">LASKNT</span>
        <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">return</span>

  <span class="c">!                Entry after getting format for sparse data output.</span>
   <span class="mi">1210</span> <span class="n">LENOUT</span> <span class="o">=</span> <span class="n">IWF</span>
        <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">11</span>
        <span class="n">NLINE</span> <span class="o">=</span> <span class="n">LENLIN</span> <span class="o">/</span> <span class="n">IWF</span>

   <span class="mi">1220</span> <span class="k">call </span><span class="n">MESSPR</span>
        <span class="n">KLINE</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LASKNT</span> <span class="o">-</span> <span class="n">MPT</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NLINE</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KLINE</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LENOUT</span> <span class="o">*</span> <span class="n">KLINE</span>
        <span class="k">return</span>

  <span class="c">!</span>
  <span class="c">!                           Take care of setup for matrix output</span>
   <span class="mi">1300</span> <span class="k">continue</span>
<span class="k">        </span><span class="n">NDIM</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NDIM</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
           <span class="n">INC</span> <span class="o">=</span> <span class="o">-</span><span class="n">NDIM</span>
           <span class="n">NDIM</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">ICOL</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">IROW1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">NROW</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
           <span class="n">IROW1</span> <span class="o">=</span> <span class="o">-</span><span class="n">NROW</span> <span class="o">/</span> <span class="mi">100000</span>
           <span class="n">NROW</span> <span class="o">=</span> <span class="o">-</span><span class="n">NROW</span> <span class="o">-</span> <span class="mi">99999</span> <span class="o">*</span> <span class="n">IROW1</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">NCOL</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NCOL</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">NCOL</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
           <span class="n">ICOL</span> <span class="o">=</span> <span class="o">-</span><span class="n">NCOL</span> <span class="o">/</span> <span class="mi">100000</span>
           <span class="n">NCOL</span> <span class="o">=</span> <span class="o">-</span><span class="n">NCOL</span> <span class="o">-</span> <span class="mi">99999</span> <span class="o">*</span> <span class="n">IROW1</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">NTXTSV</span> <span class="o">=</span> <span class="n">NTEXT</span>
        <span class="n">ITXTSV</span> <span class="o">=</span> <span class="n">ITEXT</span>
        <span class="n">IRC</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="c">!                        Compute widths for row and column labels</span>
   <span class="mi">1320</span> <span class="n">MAXWID</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">MTEXT</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="n">IRC</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="nb">IMAG</span> <span class="o">=</span> <span class="n">NROCO</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span>
        <span class="n">KLINE</span> <span class="o">=</span> <span class="nb">IMAG</span>
<span class="nb">   </span><span class="mi">1330</span> <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">MTEXT</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(</span><span class="n">NTEXT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">LTEXT</span> <span class="o">=</span> <span class="mi">5</span>
           <span class="k">else</span>
  <span class="c">!                        Go get row/column widths</span>
              <span class="n">KT</span> <span class="o">=</span> <span class="mi">2</span>
              <span class="k">call </span><span class="n">MESSMH</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">KT</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 </span><span class="n">MTEXT</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
                 <span class="n">go</span> <span class="n">to</span> <span class="mi">1330</span>
              <span class="k">end if</span>
<span class="k">           end if</span>
<span class="k">           call </span><span class="n">MESSFI</span>
           <span class="n">MAXWID</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">MAXWID</span><span class="p">(</span><span class="n">IRC</span><span class="p">),</span> <span class="n">LTEXT</span> <span class="o">+</span> <span class="n">KDI</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">FMTIM</span><span class="p">(</span><span class="n">IRC</span><span class="p">)</span> <span class="o">=</span> <span class="n">FMTI</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">IRC</span> <span class="o">=</span> <span class="n">IRC</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IRC</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1320</span>
  <span class="c">!                 Widths for Row and column titles have been computed.</span>
        <span class="n">KSHIFT</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">LASTI</span> <span class="o">=</span> <span class="n">LOCBEG</span> <span class="o">+</span> <span class="n">INC</span> <span class="o">*</span> <span class="p">(</span><span class="n">NROW</span> <span class="o">-</span> <span class="n">IROW1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">XARG</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GOTFMT</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1610</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">IWF</span> <span class="o">=</span> <span class="n">IWG</span>
           <span class="n">FMTF</span> <span class="o">=</span> <span class="n">FMTG</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">1620</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">MESSFD</span><span class="p">(</span><span class="n">IDAT</span><span class="p">)</span>
  <span class="c">!</span>
        <span class="k">If</span> <span class="p">(</span><span class="n">KDI</span> <span class="o">&gt;=</span> <span class="n">KOLWID</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">LENOUT</span> <span class="o">=</span> <span class="n">KDI</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">KSHIFT</span> <span class="o">=</span> <span class="p">(</span><span class="n">KOLWID</span> <span class="o">-</span> <span class="n">KDI</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span><span class="mi">2</span>
           <span class="n">LENOUT</span> <span class="o">=</span> <span class="n">KOLWID</span>
  <span class="c">!++ CODE for ~.C. is active</span>
           <span class="n">KDI</span> <span class="o">=</span> <span class="n">KOLWID</span>
           <span class="n">FMTI</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">ICHAR0</span> <span class="o">+</span> <span class="n">KOLWID</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">FMTI</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="n">ICHAR0</span> <span class="o">+</span> <span class="nb">mod</span><span class="p">(</span><span class="n">KOLWID</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">NIDAT</span> <span class="o">=</span> <span class="n">NIDAT</span> <span class="o">+</span> <span class="n">NDIM</span><span class="o">*</span><span class="n">NCOL</span>
  <span class="c">!                              Continue with commmon code</span>
   <span class="mi">1390</span> <span class="n">NLINE</span> <span class="o">=</span> <span class="p">(</span><span class="n">LENLIN</span> <span class="o">-</span> <span class="n">LINSTR</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENOUT</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LBUF</span> <span class="o">&lt;=</span> <span class="n">LINSTR</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1420</span>
   <span class="mi">1400</span> <span class="k">call </span><span class="n">MESSPR</span>
   <span class="mi">1420</span> <span class="n">IROW</span> <span class="o">=</span> <span class="n">IROW1</span>
        <span class="n">KLINE</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">NLINE</span><span class="p">,</span> <span class="n">NCOL</span><span class="o">-</span><span class="n">ICOL</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="c">!                       Output column labels (if any)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">MTEXTC</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1480</span>
        <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">MTEXTC</span>
        <span class="nb">IMAG</span> <span class="o">=</span> <span class="n">ICOL</span>
        <span class="n">KT</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">call </span><span class="n">MESSMH</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">KT</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">180</span>
  <span class="c">!                       Return from output of column labels.</span>
        <span class="n">MTEXTC</span> <span class="o">=</span> <span class="n">NTEXT</span>
   <span class="mi">1480</span> <span class="n">ICOL</span> <span class="o">=</span> <span class="n">ICOL</span> <span class="o">+</span> <span class="n">KLINE</span>
   <span class="mi">1490</span> <span class="k">call </span><span class="n">MESSPR</span>
  <span class="c">!</span>
  <span class="c">!                      Output row labels (if any)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">MTEXTR</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1520</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">MTEXTR</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Row &#39;</span>
           <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LBUF</span> <span class="o">+</span> <span class="mi">4</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">1515</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">NTEXT</span> <span class="o">=</span> <span class="n">MTEXTR</span>
        <span class="n">ITEXT</span> <span class="o">=</span> <span class="p">(</span><span class="n">NTEXT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">LENTXT</span>
        <span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">-</span> <span class="n">ITEXT</span> <span class="o">*</span> <span class="n">LENTXT</span>
        <span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITEXT</span> <span class="o">+</span> <span class="mi">1</span>

  <span class="c">!                     Go get text for row label</span>
        <span class="n">NTEXTR</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">410</span>
  <span class="c">!                     Return from getting text for row label</span>
   <span class="mi">1510</span> <span class="k">if</span> <span class="p">(</span><span class="n">C</span> <span class="o">/=</span> <span class="s1">&#39;#&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">MTEXTR</span> <span class="o">=</span> <span class="n">NTEXT</span> <span class="o">+</span> <span class="n">LENTXT</span> <span class="o">*</span> <span class="p">(</span><span class="n">ITEXT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">LINSTR</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">1520</span>
        <span class="k">end if</span>
<span class="k">   </span><span class="mi">1515</span> <span class="k">continue</span>
<span class="k">        write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LBUF</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">LINSTR</span><span class="p">),</span> <span class="n">FMTR</span><span class="p">)</span> <span class="n">IROW</span>
   <span class="mi">1520</span> <span class="n">LSTRT</span> <span class="o">=</span> <span class="n">LINSTR</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="n">LINSTR</span> <span class="o">+</span> <span class="n">LENOUT</span><span class="o">*</span><span class="n">KLINE</span>
        <span class="n">LASTI</span> <span class="o">=</span> <span class="n">MPT</span> <span class="o">+</span> <span class="n">NDIM</span> <span class="o">*</span> <span class="n">KLINE</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">XARG</span><span class="p">)</span> <span class="k">return</span>
  <span class="c">!                                    Integer output</span>
           <span class="k">write</span> <span class="p">(</span><span class="n">BUF</span><span class="p">(</span><span class="n">LSTRT</span><span class="p">:</span><span class="n">LBUF</span><span class="p">),</span> <span class="n">FMTI</span><span class="p">)</span> <span class="p">(</span><span class="n">IDAT</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">K</span><span class="o">=</span><span class="n">MPT</span><span class="p">,</span><span class="n">LASTI</span><span class="p">,</span><span class="n">NDIM</span><span class="p">)</span>
  <span class="c">!</span>
  <span class="c">!                                     Entry here after matrix output.</span>
   <span class="mi">1530</span> <span class="n">MPT</span> <span class="o">=</span> <span class="n">MPT</span> <span class="o">+</span> <span class="n">INC</span>
        <span class="n">IROW</span> <span class="o">=</span> <span class="n">IROW</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="c">!</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IROW</span> <span class="o">&lt;=</span> <span class="n">NROW</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1490</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ICOL</span> <span class="o">&gt;</span> <span class="n">NCOL</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">NTEXT</span> <span class="o">=</span> <span class="n">NTXTSV</span>
           <span class="n">ITEXT</span> <span class="o">=</span> <span class="n">ITXTSV</span>
           <span class="n">go</span> <span class="n">to</span> <span class="mi">40</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">MPT</span> <span class="o">=</span> <span class="n">NDIM</span><span class="o">*</span><span class="p">(</span><span class="n">ICOL</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">MTEXTR</span> <span class="o">=</span> <span class="n">MACT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">call </span><span class="n">MESSPR</span>
        <span class="n">LBUF</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">1400</span>
  <span class="c">!                                Need to get format for matrix print.</span>
   <span class="mi">1610</span> <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">return</span>
  <span class="c">!                                Entry after got format for matrix print</span>
   <span class="mi">1620</span> <span class="k">If</span> <span class="p">(</span><span class="n">IWF</span> <span class="o">&gt;=</span> <span class="n">KOLWID</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">LENOUT</span> <span class="o">=</span> <span class="n">IWF</span>
        <span class="k">else</span>
<span class="k">           </span><span class="n">KSHIFT</span> <span class="o">=</span> <span class="p">(</span><span class="n">KOLWID</span> <span class="o">-</span> <span class="n">IWF</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span><span class="mi">2</span>
           <span class="n">LENOUT</span> <span class="o">=</span> <span class="n">KOLWID</span>
           <span class="k">write</span> <span class="p">(</span><span class="n">FMTF</span><span class="p">(</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;(I2)&#39;</span><span class="p">)</span> <span class="n">KOLWID</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">NFDAT</span> <span class="o">=</span> <span class="n">NFDAT</span> <span class="o">+</span> <span class="n">NDIM</span><span class="o">*</span><span class="n">NCOL</span>
        <span class="n">LENTRY</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">go</span> <span class="n">to</span> <span class="mi">1390</span>
      <span class="k">end subroutine </span><span class="n">mess</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> diva was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>