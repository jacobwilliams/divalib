<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Edition of DIVA">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>DIVAA &ndash; diva</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">diva </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>DIVAA
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="15.5% of total for procedures.">636 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/diva_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/diva_module.f90.html'>diva_module.f90</a></li>
    
     <li><a href='../module/diva_module.html'>diva_module</a></li>
    
  
     <li class="active">DIVAA</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-0">Common Blocks</a></h3></div>
  <div id="common-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/divaa.html#common-divaev~2">DIVAEV</a>
      
      <a class="list-group-item" href="../proc/divaa.html#common-divasc~2">DIVASC</a>
      
      <a class="list-group-item" href="../proc/divaa.html#common-divamc~2">DIVAMC</a>
      
    </div>
  </div>
</div>





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/divaa.html#src">DIVAA</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine DIVAA(TSPECS, Y, F, KORD, DIVAF, DIVAO)
    
    
   
</h2>
    
  


    
    <p>Main subroutine for variable order integration of ordinary
  differential equations</p>
<h3>History</h3>
<ul>
<li>1989-02-24 DIVAA  Krogh   Big error with BETA(2)=1+epsilon -- looped</li>
<li>1988-07-27 DIVAA  Krogh   Fixed to allow restart on a restart.</li>
<li>1988-03-07 DIVAA  Krogh   Initial code.</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tspecs~5"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>TSPECS</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y~8"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Y</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~8"></span>double precision</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kord~8"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>KORD</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-divaf~2"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DIVAF</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-divao~2"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DIVAO</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~divaa~~CallsGraph Pages: 1 -->
<svg id="procdivaaCallsGraph" width="242pt" height="116pt"
 viewBox="0.00 0.00 242.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~divaa~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>proc~~divaa~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 238,-112 238,4 -4,4"/>
<!-- proc~divaa -->
<g id="proc~~divaa~~CallsGraph_node1" class="node">
<title>proc~divaa</title>
<polygon fill="none" stroke="black" points="54,-66 0,-66 0,-42 54,-42 54,-66"/>
<text text-anchor="middle" x="27" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">DIVAA</text>
</g>
<!-- proc~divabu -->
<g id="proc~~divaa~~CallsGraph_node2" class="node">
<title>proc~divabu</title>
<g id="a_proc~~divaa~~CallsGraph_node2"><a xlink:href=".././proc/divabu.html" xlink:title="DIVABU">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-108 90,-108 90,-84 144,-84 144,-108"/>
<text text-anchor="middle" x="117" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVABU</text>
</a>
</g>
</g>
<!-- proc~divaa&#45;&gt;proc~divabu -->
<g id="proc~~divaa~~CallsGraph_edge1" class="edge">
<title>proc~divaa&#45;&gt;proc~divabu</title>
<path fill="none" stroke="#000000" d="M53.45,-66.15C62.21,-70.33 72.17,-75.08 81.52,-79.54"/>
<polygon fill="#000000" stroke="#000000" points="80.07,-82.73 90.6,-83.88 83.09,-76.41 80.07,-82.73"/>
</g>
<!-- proc~divahc -->
<g id="proc~~divaa~~CallsGraph_node3" class="node">
<title>proc~divahc</title>
<g id="a_proc~~divaa~~CallsGraph_node3"><a xlink:href=".././proc/divahc.html" xlink:title="DIVAHC">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DIVAHC</text>
</a>
</g>
</g>
<!-- proc~divaa&#45;&gt;proc~divahc -->
<g id="proc~~divaa~~CallsGraph_edge2" class="edge">
<title>proc~divaa&#45;&gt;proc~divahc</title>
<path fill="none" stroke="#000000" d="M54.4,-54C62.39,-54 71.31,-54 79.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-57.5 89.92,-54 79.92,-50.5 79.92,-57.5"/>
</g>
<!-- proc~dmess -->
<g id="proc~~divaa~~CallsGraph_node4" class="node">
<title>proc~dmess</title>
<g id="a_proc~~divaa~~CallsGraph_node4"><a xlink:href=".././proc/dmess.html" xlink:title="DMESS">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DMESS</text>
</a>
</g>
</g>
<!-- proc~divaa&#45;&gt;proc~dmess -->
<g id="proc~~divaa~~CallsGraph_edge3" class="edge">
<title>proc~divaa&#45;&gt;proc~dmess</title>
<path fill="none" stroke="#000000" d="M53.45,-41.85C62.21,-37.67 72.17,-32.92 81.52,-28.46"/>
<polygon fill="#000000" stroke="#000000" points="83.09,-31.59 90.6,-24.12 80.07,-25.27 83.09,-31.59"/>
</g>
<!-- proc~messfi -->
<g id="proc~~divaa~~CallsGraph_node5" class="node">
<title>proc~messfi</title>
<g id="a_proc~~divaa~~CallsGraph_node5"><a xlink:href=".././proc/messfi.html" xlink:title="MESSFI">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 180,-24 180,0 234,0 234,-24"/>
<text text-anchor="middle" x="207" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">MESSFI</text>
</a>
</g>
</g>
<!-- proc~dmess&#45;&gt;proc~messfi -->
<g id="proc~~divaa~~CallsGraph_edge4" class="edge">
<title>proc~dmess&#45;&gt;proc~messfi</title>
<path fill="none" stroke="#000000" d="M144.4,-12C152.39,-12 161.31,-12 169.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-15.5 179.92,-12 169.92,-8.5 169.92,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-1">Common Blocks</a></h3></div>
  <div id="common-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/divaa.html#common-divaev~2">DIVAEV</a>
      
      <a class="list-group-item" href="../proc/divaa.html#common-divasc~2">DIVASC</a>
      
      <a class="list-group-item" href="../proc/divaa.html#common-divamc~2">DIVAMC</a>
      
    </div>
  </div>
</div>





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/divaa.html#src">DIVAA</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
      <h2>Common Blocks</h2>
      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-divaev~2"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/diva.html#common-divaev'>DIVA</a> (subroutine)<br><a href='../proc/divacr.html#common-divaev~3'>DIVACR</a> (subroutine)<br><a href='../proc/divahc.html#common-divaev~4'>DIVAHC</a> (subroutine)<br><a href='../proc/divaop.html#common-divaev~5'>DIVAOP</a> (subroutine)<br><a href='../proc/divapr.html#common-divaev~6'>DIVAPR</a> (subroutine)<br><a href='../proc/divadb.html#common-divaev~7'>DIVADB</a> (subroutine)<br><a href='../proc/divag.html#common-divaev~8'>DIVAG</a> (subroutine)<br>">common /DIVAEV/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eeps2~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EEPS2</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eept75~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EEPT75</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eovep2~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EOVEP2</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ovtm75~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>OVTM75</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ovd10~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>OVD10</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eeps10~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EEPS10</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eeps16~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EEPS16</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-erov10~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EROV10</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-divasc~2"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/diva.html#common-divasc'>DIVA</a> (subroutine)<br><a href='../proc/divabu.html#common-divasc~3'>DIVABU</a> (subroutine)<br><a href='../proc/divaco.html#common-divasc~4'>DIVACO</a> (subroutine)<br><a href='../proc/divacr.html#common-divasc~5'>DIVACR</a> (subroutine)<br><a href='../proc/divahc.html#common-divasc~6'>DIVAHC</a> (subroutine)<br><a href='../proc/divain.html#common-divasc~7'>DIVAIN</a> (subroutine)<br><a href='../proc/divaop.html#common-divasc~8'>DIVAOP</a> (subroutine)<br><a href='../proc/divapr.html#common-divasc~9'>DIVAPR</a> (subroutine)<br><a href='../proc/divadb.html#common-divasc~10'>DIVADB</a> (subroutine)<br><a href='../proc/divag.html#common-divasc~11'>DIVAG</a> (subroutine)<br>">common /DIVASC/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tn~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TN</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xi~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>XI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iopst~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOPST</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kordi~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KORDI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmaxd~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMAXD</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmaxi~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMAXI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ldt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LDT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxdif~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MAXDIF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxint~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MAXINT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nkdko~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NKDKO</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nte~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NTE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nyny~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NYNY</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ndtf~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NDTF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-numdt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NUMDT</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-divamc~2"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/diva.html#common-divamc'>DIVA</a> (subroutine)<br><a href='../proc/divabu.html#common-divamc~3'>DIVABU</a> (subroutine)<br><a href='../proc/divaco.html#common-divamc~4'>DIVACO</a> (subroutine)<br><a href='../proc/divacr.html#common-divamc~5'>DIVACR</a> (subroutine)<br><a href='../proc/divahc.html#common-divamc~6'>DIVAHC</a> (subroutine)<br><a href='../proc/divaop.html#common-divamc~7'>DIVAOP</a> (subroutine)<br><a href='../proc/divapr.html#common-divamc~8'>DIVAPR</a> (subroutine)<br><a href='../proc/divadb.html#common-divamc~9'>DIVADB</a> (subroutine)<br><a href='../proc/divag.html#common-divamc~10'>DIVAG</a> (subroutine)<br>">common /DIVAMC/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tg~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tgstop~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TGSTOP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tmark~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TMARK</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tmarkx~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TMARKX</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tout~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TOUT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tolg~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>TOLG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hc~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hdec~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HDEC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hinc~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HINC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hincc~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HINCC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hmax~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HMAX</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hmaxp9~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HMAXP9</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hmin~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>HMIN</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alpha~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>ALPHA</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-beta~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>BETA</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-d~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>D</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>G</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>V</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ds~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>DS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-gs~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>GS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sigma~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>SIGMA</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rbq~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>RBQ</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dnoise~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>DNOISE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eave~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EAVE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eimax~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EIMAX</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eimin~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EIMIN</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-emax~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EMAX</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-erep~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>EREP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-robnd~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>ROBND</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-snoise~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>SNOISE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fdat~2"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>FDAT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-icf~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ICF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ics~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ICS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-igflg~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IGFLG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-igtype~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IGTYPE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-igstop~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IGSTOP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ilgrep~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ILGREP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ings~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>INGS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop3~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP3</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop4~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP4</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop5~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP5</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop6~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP6</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop7~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP7</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop8~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP8</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop9~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP9</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop10~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP10</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop11~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP11</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop12~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP12</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop13~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP13</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop14~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP14</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop15~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP15</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop16~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP16</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop17~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP17</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop18~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP18</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop19~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP19</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop20~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP20</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop21~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP21</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop22~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP22</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iop21s~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IOP21S</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-itolep~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ITOLEP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iy~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IY</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kemax~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KEMAX</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kis~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KIS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kmark~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KMARK</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kord1i~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KORD1I</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kord2i~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KORD2I</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kpred~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KPRED</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqdcon~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQDCON</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqicon~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQICON</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmaxs~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMAXS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmxds~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMXDS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmxil~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMXIL</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmxip~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMXIP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kqmxis~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KQMXIS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ksc~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ksout~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSOUT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ksstrt~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSSTRT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kstep~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>KSTEP</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lex~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LEX</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-linc~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LINC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lincd~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LINCD</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lincq~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LINCQ</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lsc~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>LSC</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxkqd~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MAXKQD</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxkqi~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>MAXKQI</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-method~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>METHOD</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ne~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NE</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-neptol~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NEPTOL</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ng~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NG</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ngtot~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NGTOT</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-noiseq~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NOISEQ</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-noutko~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NOUTKO</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ntolf~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NTOLF</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ny~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>NY</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idat~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>IDAT</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
    </section>
    <br>
    <script>
      $(function () {
      $('[data-toggle="popover"]').popover()
      })
    </script>
    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">DIVAA</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">,</span> <span class="n">DIVAF</span><span class="p">,</span> <span class="n">DIVAO</span><span class="p">)</span>

      <span class="kt">integer </span><span class="n">KORD</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="c">!--D Next line special: P=&gt;D, X=&gt;Q</span>
      <span class="kt">double precision </span><span class="n">TSPECS</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">Y</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="kt">double precision </span><span class="n">F</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="k">external </span><span class="n">DIVAF</span><span class="p">,</span> <span class="n">DIVAO</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">KDIM</span><span class="p">,</span> <span class="n">MAXORD</span><span class="p">,</span> <span class="n">MAXSTF</span>
<span class="c">!++ Substitute for KDIM, MAXORD, MAXSTF below</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">KDIM</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">MAXORD</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">MAXSTF</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="c">!--D Next line special: P=&gt;D, X=&gt;Q</span>
      <span class="kt">double precision </span><span class="n">TN</span>
      <span class="kt">double precision </span><span class="n">XI</span><span class="p">(</span><span class="n">KDIM</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!--D Next line special: P=&gt;D, X=&gt;Q</span>
      <span class="kt">double precision </span><span class="n">TG</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">TGSTOP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">TMARK</span><span class="p">,</span> <span class="n">TMARKX</span><span class="p">,</span> <span class="n">TOUT</span><span class="p">,</span> <span class="n">TOLG</span>
      <span class="kt">double precision </span><span class="n">ALPHA</span><span class="p">(</span><span class="n">KDIM</span><span class="p">),</span> <span class="n">BETA</span><span class="p">(</span><span class="n">KDIM</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
      <span class="kt">double precision  </span><span class="n">D</span><span class="p">(</span><span class="n">MAXSTF</span><span class="o">+</span><span class="n">MAXORD</span><span class="p">,</span><span class="n">MAXORD</span><span class="p">),</span> <span class="n">G</span><span class="p">(</span><span class="n">KDIM</span><span class="p">,</span><span class="n">MAXORD</span><span class="p">)</span>
      <span class="kt">double precision </span><span class="n">V</span><span class="p">(</span><span class="n">KDIM</span><span class="o">+</span><span class="n">MAXORD</span><span class="p">)</span>
      <span class="kt">double precision </span><span class="n">HC</span><span class="p">,</span> <span class="n">HDEC</span><span class="p">,</span> <span class="n">HINC</span><span class="p">,</span> <span class="n">HINCC</span><span class="p">,</span> <span class="n">HMAX</span><span class="p">,</span> <span class="n">HMAXP9</span><span class="p">,</span> <span class="n">HMIN</span>
      <span class="kt">double precision </span><span class="n">FDAT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="c">!</span>
      <span class="kt">double precision </span><span class="n">DS</span><span class="p">(</span><span class="n">MAXSTF</span><span class="o">+</span><span class="n">MAXORD</span><span class="p">,</span> <span class="n">MAXORD</span><span class="p">),</span> <span class="n">GS</span><span class="p">(</span><span class="n">KDIM</span><span class="p">)</span>
      <span class="kt">double precision </span><span class="n">SIGMA</span><span class="p">(</span><span class="n">KDIM</span><span class="p">),</span> <span class="n">RBQ</span><span class="p">(</span><span class="n">KDIM</span><span class="p">),</span> <span class="n">DNOISE</span>
      <span class="kt">double precision </span><span class="n">EAVE</span><span class="p">,</span> <span class="n">EIMAX</span><span class="p">,</span> <span class="n">EIMIN</span><span class="p">,</span> <span class="n">EMAX</span><span class="p">,</span> <span class="n">EREP</span><span class="p">,</span> <span class="n">ROBND</span><span class="p">,</span> <span class="n">SNOISE</span>
<span class="c">!</span>
<span class="c">!.    SPECIFICATION OF ENVIRONMENTAL CONSTANTS.</span>
      <span class="kt">double precision </span><span class="n">EEPS10</span><span class="p">,</span> <span class="n">EEPS16</span><span class="p">,</span> <span class="n">EROV10</span><span class="p">,</span> <span class="n">EEPS2</span>
      <span class="kt">double precision </span><span class="n">EEPT75</span><span class="p">,</span> <span class="n">EOVEP2</span><span class="p">,</span> <span class="n">OVTM75</span><span class="p">,</span> <span class="n">OVD10</span>
      <span class="k">common</span> <span class="o">/</span> <span class="n">DIVAEV</span> <span class="o">/</span> <span class="n">EEPS2</span><span class="p">,</span> <span class="n">EEPT75</span><span class="p">,</span> <span class="n">EOVEP2</span><span class="p">,</span> <span class="n">OVTM75</span><span class="p">,</span> <span class="n">OVD10</span><span class="p">,</span> <span class="n">EEPS10</span><span class="p">,</span>   <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">EEPS16</span><span class="p">,</span> <span class="n">EROV10</span>
      <span class="k">save</span> <span class="o">/</span> <span class="n">DIVAEV</span> <span class="o">/</span>
      <span class="kt">integer </span><span class="n">IOPST</span><span class="p">,</span> <span class="n">KORDI</span><span class="p">,</span> <span class="n">KQMAXD</span><span class="p">,</span> <span class="n">KQMAXI</span><span class="p">,</span> <span class="n">LDT</span><span class="p">,</span> <span class="n">MAXDIF</span><span class="p">,</span> <span class="n">MAXINT</span><span class="p">,</span> <span class="n">NKDKO</span><span class="p">,</span> <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">NTE</span><span class="p">,</span> <span class="n">NYNY</span><span class="p">,</span> <span class="n">NDTF</span><span class="p">,</span> <span class="n">NUMDT</span>
      <span class="k">common</span> <span class="o">/</span> <span class="n">DIVASC</span> <span class="o">/</span> <span class="n">TN</span><span class="p">,</span> <span class="n">XI</span><span class="p">,</span> <span class="n">IOPST</span><span class="p">,</span> <span class="n">KORDI</span><span class="p">,</span> <span class="n">KQMAXD</span><span class="p">,</span> <span class="n">KQMAXI</span><span class="p">,</span> <span class="n">LDT</span><span class="p">,</span>      <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">MAXDIF</span><span class="p">,</span> <span class="n">MAXINT</span><span class="p">,</span> <span class="n">NKDKO</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">NYNY</span><span class="p">,</span> <span class="n">NDTF</span><span class="p">,</span> <span class="n">NUMDT</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">ICF</span><span class="p">,</span><span class="n">ICS</span><span class="p">,</span><span class="n">IGFLG</span><span class="p">,</span><span class="n">IGTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">IGSTOP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ILGREP</span><span class="p">,</span><span class="n">INGS</span><span class="p">,</span><span class="n">IOP3</span><span class="p">,</span><span class="n">IOP4</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">IOP5</span><span class="p">,</span><span class="n">IOP6</span><span class="p">,</span><span class="n">IOP7</span><span class="p">,</span><span class="n">IOP8</span><span class="p">,</span><span class="n">IOP9</span><span class="p">,</span><span class="n">IOP10</span><span class="p">,</span><span class="n">IOP11</span><span class="p">,</span><span class="n">IOP12</span><span class="p">,</span><span class="n">IOP13</span><span class="p">,</span><span class="n">IOP14</span><span class="p">,</span><span class="n">IOP15</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">IOP16</span><span class="p">,</span><span class="n">IOP17</span><span class="p">,</span><span class="n">IOP18</span><span class="p">,</span><span class="n">IOP19</span><span class="p">,</span><span class="n">IOP20</span><span class="p">,</span><span class="n">IOP21</span><span class="p">,</span><span class="n">IOP22</span><span class="p">,</span><span class="n">IOP21S</span><span class="p">,</span><span class="n">ITOLEP</span><span class="p">,</span><span class="n">IY</span><span class="p">,</span>    <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">KEMAX</span><span class="p">,</span><span class="n">KIS</span><span class="p">,</span><span class="n">KMARK</span><span class="p">,</span><span class="n">KORD1I</span><span class="p">,</span><span class="n">KORD2I</span><span class="p">,</span><span class="n">KPRED</span><span class="p">,</span><span class="n">KQDCON</span><span class="p">,</span><span class="n">KQICON</span><span class="p">,</span><span class="n">KQMAXS</span><span class="p">,</span>      <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">KQMXDS</span><span class="p">,</span><span class="n">KQMXIL</span><span class="p">,</span><span class="n">KQMXIP</span><span class="p">,</span><span class="n">KQMXIS</span><span class="p">,</span><span class="n">KSC</span><span class="p">,</span><span class="n">KSOUT</span><span class="p">,</span><span class="n">KSSTRT</span><span class="p">,</span><span class="n">KSTEP</span><span class="p">,</span><span class="n">LEX</span><span class="p">,</span><span class="n">LINC</span><span class="p">,</span>   <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">LINCD</span><span class="p">,</span><span class="n">LINCQ</span><span class="p">,</span><span class="n">LSC</span><span class="p">,</span><span class="n">MAXKQD</span><span class="p">,</span><span class="n">MAXKQI</span><span class="p">,</span><span class="n">METHOD</span><span class="p">,</span><span class="n">NE</span><span class="p">,</span><span class="n">NEPTOL</span><span class="p">,</span><span class="n">NG</span><span class="p">,</span><span class="n">NGTOT</span><span class="p">,</span>       <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">NOISEQ</span><span class="p">,</span><span class="n">NOUTKO</span><span class="p">,</span><span class="n">NTOLF</span><span class="p">,</span><span class="n">NY</span><span class="p">,</span><span class="n">IDAT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
      <span class="k">common</span> <span class="o">/</span><span class="n">DIVAMC</span><span class="o">/</span> <span class="n">TG</span><span class="p">,</span><span class="n">TGSTOP</span><span class="p">,</span><span class="n">TMARK</span><span class="p">,</span><span class="n">TMARKX</span><span class="p">,</span><span class="n">TOUT</span><span class="p">,</span><span class="n">TOLG</span><span class="p">,</span><span class="n">HC</span><span class="p">,</span><span class="n">HDEC</span><span class="p">,</span><span class="n">HINC</span><span class="p">,</span>    <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">HINCC</span><span class="p">,</span><span class="n">HMAX</span><span class="p">,</span><span class="n">HMAXP9</span><span class="p">,</span><span class="n">HMIN</span><span class="p">,</span><span class="n">ALPHA</span><span class="p">,</span><span class="n">BETA</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">DS</span><span class="p">,</span><span class="n">GS</span><span class="p">,</span><span class="n">SIGMA</span><span class="p">,</span><span class="n">RBQ</span><span class="p">,</span><span class="n">DNOISE</span><span class="p">,&amp;</span>
     <span class="p">&amp;</span>   <span class="n">EAVE</span><span class="p">,</span><span class="n">EIMAX</span><span class="p">,</span><span class="n">EIMIN</span><span class="p">,</span><span class="n">EMAX</span><span class="p">,</span><span class="n">EREP</span><span class="p">,</span><span class="n">ROBND</span><span class="p">,</span><span class="n">SNOISE</span><span class="p">,</span><span class="n">FDAT</span><span class="p">,</span><span class="n">ICF</span><span class="p">,</span><span class="n">ICS</span><span class="p">,</span><span class="n">IGFLG</span><span class="p">,</span>    <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">IGTYPE</span><span class="p">,</span><span class="n">IGSTOP</span><span class="p">,</span><span class="n">ILGREP</span><span class="p">,</span><span class="n">INGS</span><span class="p">,</span><span class="n">IOP3</span><span class="p">,</span><span class="n">IOP4</span><span class="p">,</span><span class="n">IOP5</span><span class="p">,</span><span class="n">IOP6</span><span class="p">,</span><span class="n">IOP7</span><span class="p">,</span><span class="n">IOP8</span><span class="p">,</span><span class="n">IOP9</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">IOP10</span><span class="p">,</span><span class="n">IOP11</span><span class="p">,</span><span class="n">IOP12</span><span class="p">,</span><span class="n">IOP13</span><span class="p">,</span><span class="n">IOP14</span><span class="p">,</span><span class="n">IOP15</span><span class="p">,</span><span class="n">IOP16</span><span class="p">,</span><span class="n">IOP17</span><span class="p">,</span><span class="n">IOP18</span><span class="p">,</span><span class="n">IOP19</span><span class="p">,</span>   <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">IOP20</span><span class="p">,</span><span class="n">IOP21</span><span class="p">,</span><span class="n">IOP22</span><span class="p">,</span><span class="n">IOP21S</span><span class="p">,</span><span class="n">ITOLEP</span><span class="p">,</span><span class="n">IY</span><span class="p">,</span><span class="n">KEMAX</span><span class="p">,</span><span class="n">KIS</span><span class="p">,</span><span class="n">KMARK</span><span class="p">,</span><span class="n">KORD1I</span><span class="p">,</span>     <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">KORD2I</span><span class="p">,</span><span class="n">KPRED</span><span class="p">,</span><span class="n">KQDCON</span><span class="p">,</span><span class="n">KQICON</span><span class="p">,</span><span class="n">KQMAXS</span><span class="p">,</span><span class="n">KQMXDS</span><span class="p">,</span><span class="n">KQMXIL</span><span class="p">,</span><span class="n">KQMXIP</span><span class="p">,</span><span class="n">KQMXIS</span><span class="p">,</span> <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">KSC</span><span class="p">,</span><span class="n">KSOUT</span><span class="p">,</span><span class="n">KSSTRT</span><span class="p">,</span><span class="n">KSTEP</span><span class="p">,</span><span class="n">LEX</span><span class="p">,</span><span class="n">LINC</span><span class="p">,</span><span class="n">LINCD</span><span class="p">,</span><span class="n">LINCQ</span><span class="p">,</span><span class="n">LSC</span><span class="p">,</span><span class="n">MAXKQD</span><span class="p">,</span><span class="n">MAXKQI</span><span class="p">,</span> <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">METHOD</span><span class="p">,</span><span class="n">NE</span><span class="p">,</span><span class="n">NEPTOL</span><span class="p">,</span><span class="n">NG</span><span class="p">,</span><span class="n">NGTOT</span><span class="p">,</span><span class="n">NOISEQ</span><span class="p">,</span><span class="n">NOUTKO</span><span class="p">,</span><span class="n">NTOLF</span><span class="p">,</span><span class="n">NY</span><span class="p">,</span><span class="n">IDAT</span>
      <span class="k">save</span> <span class="o">/</span> <span class="n">DIVAMC</span> <span class="o">/</span> <span class="p">,</span> <span class="o">/</span> <span class="n">DIVASC</span> <span class="o">/</span>
<span class="c">!</span>
      <span class="kt">double precision </span><span class="n">CMP75</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">C1M5</span><span class="p">,</span> <span class="n">C1M3</span><span class="p">,</span> <span class="n">C2P5M3</span><span class="p">,</span> <span class="n">C8M3</span><span class="p">,</span> <span class="n">CP0625</span><span class="p">,</span> <span class="n">CP1</span>
      <span class="kt">double precision </span><span class="n">CP25</span><span class="p">,</span> <span class="n">CP3</span><span class="p">,</span> <span class="n">CP4</span><span class="p">,</span> <span class="n">CP5</span><span class="p">,</span> <span class="n">CP875</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C1P125</span><span class="p">,</span> <span class="n">C1P3</span><span class="p">,</span> <span class="n">C2</span>
      <span class="kt">double precision </span><span class="n">C6</span><span class="p">,</span> <span class="n">C10</span><span class="p">,</span> <span class="n">C16</span><span class="p">,</span> <span class="n">C4096</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CMP75</span> <span class="o">=</span> <span class="o">-</span><span class="p">.</span><span class="mi">75</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C0</span> <span class="o">=</span> <span class="mf">0.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1M5</span> <span class="o">=</span> <span class="mf">1.D-5</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1M3</span> <span class="o">=</span> <span class="mf">1.D-3</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C2P5M3</span> <span class="o">=</span> <span class="mf">2.5D-3</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C8M3</span> <span class="o">=</span> <span class="mf">8.D-3</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP0625</span> <span class="o">=</span> <span class="p">.</span><span class="mi">0625</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP1</span> <span class="o">=</span> <span class="p">.</span><span class="mi">1</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP25</span> <span class="o">=</span> <span class="p">.</span><span class="mi">25</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP3</span> <span class="o">=</span> <span class="p">.</span><span class="mi">3</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP4</span> <span class="o">=</span> <span class="p">.</span><span class="mi">4</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP5</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">CP875</span> <span class="o">=</span> <span class="p">.</span><span class="mi">875</span><span class="n">D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1</span> <span class="o">=</span> <span class="mf">1.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1P125</span> <span class="o">=</span> <span class="mf">1.125D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C1P3</span> <span class="o">=</span> <span class="mf">1.3D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C2</span> <span class="o">=</span> <span class="mf">2.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C6</span> <span class="o">=</span> <span class="mf">6.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C10</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C16</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">6.D0</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">C4096</span> <span class="o">=</span> <span class="mi">409</span><span class="mf">6.D0</span><span class="p">)</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">LDIS</span><span class="p">,</span> <span class="n">KEXIT</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">J1</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">LX</span>
      <span class="kt">double precision </span><span class="n">TP</span><span class="p">,</span> <span class="n">TP1</span><span class="p">,</span> <span class="n">TP2</span><span class="p">,</span> <span class="n">TP3</span><span class="p">,</span> <span class="n">HH</span><span class="p">,</span> <span class="n">DISADJ</span>
      <span class="kt">double precision </span><span class="n">SIGMAS</span><span class="p">,</span> <span class="n">TPS1</span><span class="p">,</span> <span class="n">TPS2</span><span class="p">,</span> <span class="n">EIMINO</span><span class="p">,</span> <span class="n">EXR</span>
<span class="c">!--D Next line special: P=&gt;D, X=&gt;Q</span>
      <span class="kt">double precision  </span><span class="n">TMARKA</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">XP</span><span class="p">,</span> <span class="n">XP1</span>
      <span class="k">equivalence</span> <span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">HH</span><span class="p">),</span> <span class="p">(</span><span class="n">TMARKA</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">TMARK</span><span class="p">)</span>
      <span class="k">equivalence</span> <span class="p">(</span><span class="n">KEXIT</span><span class="p">,</span> <span class="n">IOP17</span><span class="p">)</span>
      <span class="k">save </span><span class="n">EIMINO</span><span class="p">,</span> <span class="n">EXR</span><span class="p">,</span> <span class="n">SIGMAS</span><span class="p">,</span> <span class="n">TP</span><span class="p">,</span> <span class="n">TP1</span><span class="p">,</span> <span class="n">TP2</span><span class="p">,</span> <span class="n">TP3</span><span class="p">,</span> <span class="n">TPS1</span><span class="p">,</span> <span class="n">TPS2</span><span class="p">,</span> <span class="n">DISADJ</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">LDIS</span>
<span class="c">!</span>
<span class="c">!                      Declarations for error message processing.</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">MACT</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="n">MLOC</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">MENTXT</span><span class="p">,</span> <span class="n">MERET</span><span class="p">,</span> <span class="n">MEEMES</span><span class="p">,</span> <span class="n">METEXT</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MENTXT</span> <span class="o">=</span><span class="mi">23</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MERET</span>  <span class="o">=</span><span class="mi">51</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MEEMES</span> <span class="o">=</span><span class="mi">52</span><span class="p">)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">METEXT</span> <span class="o">=</span><span class="mi">53</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">! ********* Error message text ***************</span>
<span class="c">![Last 2 letters of Param. name]  [Text generating message.]</span>
<span class="c">!AA DIVAA$B</span>
<span class="c">!AB At: TN=$F, KSTEP=$I, with H=$F$E</span>
<span class="c">!AC A previously reported error was fatal.$E</span>
<span class="c">!AD Print points not properly ordered: TSPEC($I)=$F$E</span>
<span class="c">!AE An error tolerance of 0 requires setting special flags.  $B</span>
<span class="c">!AF Step size reduced too fast, doing a restart.  $B</span>
<span class="c">!AG H is so small that TN + H = TN.  $B</span>
<span class="c">!AH Error tolerance too small.  $B</span>
<span class="c">!AI Step size at end of start &lt; HMIN=$F, $B</span>
<span class="c">!AJ Error estimates require a stepsize &lt; HMIN=$F, $B</span>
<span class="c">!AK (Estimated Error) / (Requested Error) for equation $I is $F.  $B</span>
<span class="c">!AL Tolerance $I is F($I) = $F.$B</span>
<span class="c">!AM Tolerance $I is F($I) * F($I) = $F * $F = $F.$B</span>
<span class="c">!AN   Replacing F($I) with $F.$E</span>
      <span class="kt">integer </span><span class="n">LTXTAA</span><span class="p">,</span><span class="n">LTXTAB</span><span class="p">,</span><span class="n">LTXTAC</span><span class="p">,</span><span class="n">LTXTAD</span><span class="p">,</span><span class="n">LTXTAE</span><span class="p">,</span><span class="n">LTXTAF</span><span class="p">,</span><span class="n">LTXTAG</span><span class="p">,</span><span class="n">LTXTAH</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span> <span class="n">LTXTAI</span><span class="p">,</span><span class="n">LTXTAJ</span><span class="p">,</span><span class="n">LTXTAK</span><span class="p">,</span><span class="n">LTXTAL</span><span class="p">,</span><span class="n">LTXTAM</span><span class="p">,</span><span class="n">LTXTAN</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">LTXTAA</span><span class="o">=</span>  <span class="mi">1</span><span class="p">,</span><span class="n">LTXTAB</span><span class="o">=</span>  <span class="mi">8</span><span class="p">,</span><span class="n">LTXTAC</span><span class="o">=</span> <span class="mi">40</span><span class="p">,</span><span class="n">LTXTAD</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="n">LTXTAE</span><span class="o">=</span><span class="mi">129</span><span class="p">,&amp;</span>
     <span class="p">&amp;</span> <span class="n">LTXTAF</span><span class="o">=</span><span class="mi">189</span><span class="p">,</span><span class="n">LTXTAG</span><span class="o">=</span><span class="mi">237</span><span class="p">,</span><span class="n">LTXTAH</span><span class="o">=</span><span class="mi">272</span><span class="p">,</span><span class="n">LTXTAI</span><span class="o">=</span><span class="mi">302</span><span class="p">,</span><span class="n">LTXTAJ</span><span class="o">=</span><span class="mi">342</span><span class="p">,</span>          <span class="p">&amp;</span>
     <span class="p">&amp;</span> <span class="n">LTXTAK</span><span class="o">=</span><span class="mi">390</span><span class="p">,</span><span class="n">LTXTAL</span><span class="o">=</span><span class="mi">455</span><span class="p">,</span><span class="n">LTXTAM</span><span class="o">=</span><span class="mi">484</span><span class="p">,</span><span class="n">LTXTAN</span><span class="o">=</span><span class="mi">531</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">MTXTAA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">186</span><span class="p">)</span>
<span class="c">!</span>
      <span class="kt">integer </span><span class="n">LOCM</span><span class="p">,</span> <span class="n">MLOCAC</span><span class="p">,</span> <span class="n">MLOCAD</span><span class="p">,</span> <span class="n">MLOCAE</span><span class="p">,</span> <span class="n">MLOCAF</span><span class="p">,</span> <span class="n">MLOCAG</span><span class="p">,</span> <span class="n">MLOCAH</span><span class="p">,</span>     <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">MLOCAI</span><span class="p">,</span> <span class="n">MLOCAJ</span>

      <span class="k">parameter</span> <span class="p">(</span><span class="n">LOCM</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">256</span><span class="p">)</span>
<span class="c">!                     KORD1I   Severity   Loc. message</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAC</span> <span class="o">=</span> <span class="mi">23</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">99</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAC</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAD</span> <span class="o">=</span> <span class="mi">13</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">38</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAD</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAE</span> <span class="o">=</span> <span class="mi">22</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">38</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAE</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAF</span> <span class="o">=</span>  <span class="mi">3</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">14</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAF</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAG</span> <span class="o">=</span> <span class="mi">21</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">38</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAG</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAH</span> <span class="o">=</span>  <span class="mi">2</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">25</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAH</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAI</span> <span class="o">=</span> <span class="mi">11</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">38</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAI</span><span class="p">))</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">MLOCAJ</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">38</span> <span class="o">+</span> <span class="mi">256</span> <span class="o">*</span> <span class="n">LTXTAJ</span><span class="p">))</span>
<span class="c">!</span>
      <span class="k">data </span><span class="n">MTXTAA</span><span class="o">/</span><span class="s1">&#39;DIVAA$BAt: TN=$F, KSTEP=$I, with H=$F$EA previously r&amp;</span>
<span class="s1">     &amp;eported error was fatal.$EPrint points not properly ordered: TSPEC&amp;</span>
<span class="s1">     &amp;($I)=$F$EAn error tolerance of 0 requires setting special flags. $&amp;</span>
<span class="s1">     &amp; &#39;</span><span class="p">,</span><span class="s1">&#39;$BStep size reduced too fast, doing a restart.  $BH is so smal&amp;</span>
<span class="s1">     &amp;l that TN + H = TN.  $BError tolerance too small.  $BStep size at$&amp;</span>
<span class="s1">     &amp; end of start &lt; HMIN=$F, $BError estimates require a steps&#39;</span><span class="p">,</span><span class="s1">&#39;ize &lt;&amp;</span>
<span class="s1">     &amp; HMIN=$F, $B(Estimated Error) / (Requested Error) for equation $I$&amp;</span>
<span class="s1">     &amp; is $F.  $BTolerance $I is F($I) = $F.$BTolerance $I is F($I) * F(&amp;</span>
<span class="s1">     &amp;$I) = $F * $F = $F.$B  Replacing F($I) with $F.$E&#39;</span><span class="o">/</span>
      <span class="k">data </span><span class="n">MLOC</span> <span class="o">/</span> <span class="n">MLOCAC</span><span class="p">,</span> <span class="n">MLOCAD</span><span class="p">,</span> <span class="n">MLOCAE</span><span class="p">,</span> <span class="n">MLOCAF</span><span class="p">,</span> <span class="n">MLOCAG</span><span class="p">,</span> <span class="n">MLOCAH</span><span class="p">,</span>       <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="n">MLOCAI</span><span class="p">,</span> <span class="n">MLOCAJ</span> <span class="o">/</span>
<span class="c">!</span>
<span class="c">!                      1 2 3 4       5 6       7       8 9      10</span>
      <span class="k">data </span><span class="n">MACT</span> <span class="o">/</span> <span class="n">MEEMES</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">MENTXT</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">METEXT</span><span class="p">,</span> <span class="n">MENTXT</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">METEXT</span><span class="p">,</span>     <span class="p">&amp;</span>
     <span class="p">&amp;</span>  <span class="n">MENTXT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">METEXT</span><span class="p">,</span> <span class="n">MENTXT</span><span class="p">,</span> <span class="n">LTXTAN</span><span class="p">,</span> <span class="n">METEXT</span><span class="p">,</span> <span class="n">MERET</span> <span class="o">/</span>
<span class="c">!           11 12      13      14      15      16     17</span>
<span class="c">!</span>
      <span class="k">data </span><span class="n">EXR</span><span class="p">,</span> <span class="n">EIMINO</span> <span class="o">/</span> <span class="n">CP1</span><span class="p">,</span> <span class="n">C8M3</span> <span class="o">/</span>
      <span class="k">data </span><span class="n">LDIS</span> <span class="o">/</span> <span class="mi">0</span> <span class="o">/</span>
<span class="c">!</span>
<span class="c">! ************** START OF EXECUTABLE CODE ******************************</span>
<span class="c">!</span>
  <span class="mi">660</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span><span class="p">)</span> <span class="mi">670</span><span class="p">,</span> <span class="mi">1380</span><span class="p">,</span> <span class="mi">1840</span>
  <span class="mi">670</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2140</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">720</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="mi">1840</span><span class="p">,</span> <span class="mi">710</span><span class="p">,</span> <span class="mi">1840</span>
<span class="c">!     **** SPECIAL OUTPUT CASE (EXTRAPOLATION OR GSTOP)</span>
  <span class="mi">680</span> <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">1220</span><span class="p">,</span> <span class="mi">1190</span><span class="p">,</span> <span class="mi">830</span><span class="p">,</span> <span class="mi">690</span><span class="p">,</span> <span class="mi">690</span><span class="p">,</span> <span class="mi">2190</span><span class="p">),</span> <span class="n">KEXIT</span>
<span class="c">!     **** RESET TMARK BEFORE GOING WHERE DIRECTED BY KEXIT</span>
  <span class="mi">690</span> <span class="n">KEXIT</span> <span class="o">=</span> <span class="n">KEXIT</span> <span class="o">-</span> <span class="mi">2</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1890</span>
<span class="c">!     **** USER HAS REQUESTED A RESTART</span>
  <span class="mi">700</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
      <span class="n">IGFLG</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">))</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">KORD1I</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">==</span> <span class="mi">5</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1890</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">720</span>
<span class="c">!                Set up for a discontinuity</span>
  <span class="mi">710</span> <span class="n">XP</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!                Adjust for discontinuity in Y</span>
         <span class="n">J</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="mi">712</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTE</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">NKDKO</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KORDI</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">NKDKO</span> <span class="o">+</span> <span class="n">I</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">J</span> <span class="o">+</span> <span class="n">KORDI</span>
            <span class="n">XP1</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
  <span class="mi">711</span>       <span class="n">Y</span><span class="p">(</span><span class="n">NYNY</span> <span class="o">+</span> <span class="n">J</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">NYNY</span> <span class="o">+</span> <span class="n">J</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="o">+</span> <span class="n">XP1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&lt;</span> <span class="n">KORDI</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">XP1</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="n">K</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">TN</span> <span class="o">-</span> <span class="n">XP</span><span class="p">)</span> <span class="o">*</span> <span class="n">XP1</span> <span class="o">/</span> <span class="nb">dble</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
               <span class="n">K</span> <span class="o">=</span> <span class="n">K</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">go</span> <span class="n">to</span> <span class="mi">711</span>
            <span class="k">end if</span>
<span class="k">  </span><span class="mi">712</span>    <span class="k">continue</span>
<span class="k">      else</span>
<span class="k">         </span><span class="n">IGFLG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">DISADJ</span> <span class="o">=</span> <span class="n">HH</span>
      <span class="n">XP1</span> <span class="o">=</span> <span class="p">(</span><span class="n">XP</span> <span class="o">-</span> <span class="n">TN</span><span class="p">)</span> <span class="o">/</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">XP1</span> <span class="o">&lt;</span> <span class="n">CP25</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">XP1</span> <span class="o">&lt;</span> <span class="n">CMP75</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
         <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TN</span> <span class="o">-</span> <span class="n">XI</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
         <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.D0</span><span class="o">*</span><span class="p">(</span><span class="n">TN</span> <span class="o">-</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
         <span class="k">call </span><span class="n">DIVAIN</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
         <span class="k">do </span><span class="mi">713</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NY</span>
            <span class="n">Y</span><span class="p">(</span><span class="n">NYNY</span> <span class="o">+</span> <span class="n">J</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
  <span class="mi">713</span>    <span class="k">continue</span>
<span class="c">!          Move difference tables back one step</span>
         <span class="n">TN</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="mi">714</span>    <span class="k">call </span><span class="n">DIVABU</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">KSC</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">KSC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">do </span><span class="mi">715</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">KSC</span><span class="p">),</span> <span class="n">IOP11</span><span class="o">-</span><span class="mi">1</span>
               <span class="n">BETA</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">BETA</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">XI</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">XI</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
  <span class="mi">715</span>       <span class="k">continue</span>
<span class="k">            </span><span class="n">K</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">go</span> <span class="n">to</span> <span class="mi">714</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="c">!      Take step to discontinuity.</span>
      <span class="n">HH</span> <span class="o">=</span> <span class="p">(</span><span class="n">XP</span> <span class="o">-</span> <span class="n">TN</span><span class="p">)</span>
      <span class="n">EREP</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">EREP</span><span class="p">)</span>
      <span class="n">KIS</span> <span class="o">=</span> <span class="mi">1000</span>
      <span class="n">LDIS</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">LSC</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">HINCC</span> <span class="o">=</span> <span class="n">C1P125</span>
      <span class="n">KSSTRT</span> <span class="o">=</span> <span class="n">KSTEP</span> <span class="o">+</span> <span class="mi">2</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1115</span>
<span class="c">! ********</span>
<span class="c">! INITIALIZE FOR STARTING AN INTEGRATION</span>
<span class="c">! ********</span>
  <span class="mi">720</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">LSC</span> <span class="o">=</span> <span class="mi">8</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
      <span class="n">LINCD</span> <span class="o">=</span> <span class="mi">64</span>
      <span class="n">LDT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
      <span class="n">KQMAXI</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">EIMIN</span> <span class="o">=</span> <span class="n">CP3</span>
      <span class="n">EAVE</span> <span class="o">=</span> <span class="n">C10</span>
      <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">C0</span>
      <span class="n">IGFLG</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KIS</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">KSSTRT</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">ROBND</span> <span class="o">=</span> <span class="mf">0.D0</span>


<span class="c">! GO COMPUTE INITIAL DERIVATIVES</span>
  <span class="mi">730</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="n">ICS</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">ICF</span> <span class="o">=</span> <span class="n">NE</span>
<span class="c">!++  End</span>
  <span class="mi">740</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="n">KPRED</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1360</span>
<span class="c">!   RETURN AFTER COMPUTING INITIAL (OR NOISE TEST) DERIVATIVES</span>
  <span class="mi">750</span> <span class="k">continue</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP18</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">790</span>
<span class="c">!.    **** SPECIAL LOGIC TO COMPUTE VARIATIONAL DERIVATIVES</span>
  <span class="mi">760</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">770</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">3</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="mi">770</span> <span class="k">if</span> <span class="p">(</span><span class="n">ICF</span> <span class="o">==</span> <span class="n">NTE</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">790</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">ICS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">790</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">ICS</span> <span class="o">=</span> <span class="n">ICF</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="mi">780</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">ICF</span> <span class="o">=</span> <span class="n">IOP18</span> <span class="o">+</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="n">ICF</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="n">ICF</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ICF</span><span class="p">)</span> <span class="mi">1360</span><span class="p">,</span> <span class="mi">780</span><span class="p">,</span> <span class="mi">1360</span>
<span class="c">!++  End</span>
  <span class="mi">790</span> <span class="n">ICS</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">ICF</span> <span class="o">=</span> <span class="n">NE</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">EREP</span><span class="p">)</span> <span class="mi">2220</span><span class="p">,</span> <span class="mi">2220</span><span class="p">,</span> <span class="mi">1430</span>
<span class="c">!++  End</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">1490</span><span class="p">,</span> <span class="mi">810</span><span class="p">,</span> <span class="mi">1490</span>
<span class="c">! END OF SPECIAL CODE FOR INITIALIZATION AT THE START</span>
<span class="c">! ********</span>
<span class="c">! UPDATE VARIABLES TO PREPARE FOR NEXT STEP</span>
<span class="c">! ********</span>
  <span class="mi">800</span> <span class="n">LDT</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">EIMIN</span> <span class="o">=</span> <span class="n">C2P5M3</span><span class="o">+</span><span class="n">EIMIN</span><span class="o">*</span><span class="p">(</span><span class="n">C6</span><span class="o">*</span><span class="n">EAVE</span><span class="o">+</span><span class="n">EIMAX</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">EIMIN</span><span class="o">+</span><span class="n">C1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C6</span><span class="o">*</span><span class="n">EIMAX</span><span class="o">+</span><span class="n">EAVE</span><span class="p">))</span>
  <span class="mi">810</span> <span class="k">do </span><span class="mi">820</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NY</span>
  <span class="mi">820</span>    <span class="n">Y</span><span class="p">(</span><span class="n">NYNY</span> <span class="o">+</span> <span class="n">J</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
      <span class="n">TN</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c">! ********</span>
<span class="c">! TEST FOR VARIOUS TYPES OF OUTPUT</span>
<span class="c">! ********</span>
<span class="c">!     TEST FOR END OF STEP OUTPUT (OR IF DUMP OUTPUT TO BE TESTED FOR)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP6</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">840</span>
<span class="c">!   SET UP FOR END OF STEP OUTPUT</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">6</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1810</span>
<span class="c">!     SET UP AFTER OTHER COMPUTATIONS HAVE BEEN MADE (TSPECS(1)/=TN)</span>
  <span class="mi">830</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">6</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">860</span>
<span class="c">!     TEST FOR AN OUTPUT POINT</span>
  <span class="mi">840</span> <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">*</span> <span class="p">(</span><span class="n">TMARK</span> <span class="o">-</span> <span class="n">TN</span><span class="p">))</span> <span class="mi">1760</span><span class="p">,</span> <span class="mi">1760</span><span class="p">,</span> <span class="mi">850</span>
<span class="c">!     TEST FOR TOO MANY STEPS OUTPUT</span>
  <span class="mi">850</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">KSOUT</span> <span class="o">&gt;</span> <span class="n">KSTEP</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">890</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">4</span>
  <span class="mi">860</span> <span class="k">if</span> <span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">TN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1810</span>
<span class="c">!     GO INTERPOLATE VALUES AT END OF LAST STEP</span>
  <span class="mi">870</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TN</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1780</span>
<span class="c">!     CONTINUE AFTER TOO MANY STEPS OUTPUT</span>
  <span class="mi">880</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">KSOUT</span> <span class="o">=</span> <span class="n">KSTEP</span> <span class="o">+</span> <span class="n">IOP4</span>
  <span class="mi">890</span> <span class="k">continue</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP9</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">920</span>
<span class="c">!++  Code for DUMP &amp; STIFF is inactive</span>
<span class="c">!      KQMXDS=KQMAXD</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="n">KQMXIS</span> <span class="o">=</span> <span class="n">KQMAXI</span>
      <span class="n">KIS</span> <span class="o">=</span> <span class="n">KIS</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KIS</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">920</span>
<span class="c">!.   TIME TO DUMP THE SOLUTION</span>
  <span class="mi">900</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">9</span>
<span class="c">!.    SET TO UPDATE THE DIFFERENCE TABLE</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LDT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1810</span>
<span class="c">! Note that doing this update can lead to very small differences in the</span>
<span class="c">! results because of round off differences.</span>
      <span class="n">LDT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1780</span>
<span class="c">!++  End</span>
<span class="c">! RETURN AFTER DUMPING THE SOLUTION</span>
  <span class="mi">910</span> <span class="k">continue</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="n">KIS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c">!.    TEST IF SOLUTION DUMP DUE TO RESTART, END, OR</span>
<span class="c">!.    DROP IN INTEG. ORDER</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="mi">1860</span><span class="p">,</span> <span class="mi">1750</span><span class="p">,</span> <span class="mi">1180</span>
<span class="c">!++  End</span>
<span class="c">! END OF TESTING FOR VARIOUS TYPES OF OUTPUT</span>
<span class="c">!   TEST IF STEPSIZE MAY BE INCREASED OR IF TESTS SHOULD BE MADE</span>
<span class="c">!   FOR DECREASING THE STEPSIZE (OR IF STARTING OR USER SELECTING H)</span>
  <span class="mi">920</span> <span class="n">KSTEP</span> <span class="o">=</span> <span class="n">KSTEP</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span><span class="p">)</span> <span class="mi">930</span><span class="p">,</span> <span class="mi">980</span><span class="p">,</span> <span class="mi">940</span>
  <span class="mi">930</span> <span class="k">continue</span>
<span class="c">!     **** ONLY POSSIBLE VALUES AT THIS POINT ARE</span>
<span class="c">!          LINC = -2 OR -5</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">1120</span><span class="p">,</span> <span class="mi">1110</span><span class="p">,</span> <span class="mi">1120</span>
<span class="c">! ********</span>
<span class="c">! ERROR ESTIMATES INDICATE STEPSIZE CAN BE INCREASED</span>
<span class="c">! ********</span>
  <span class="mi">940</span> <span class="n">HC</span> <span class="o">=</span> <span class="n">HINCC</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">HC</span> <span class="o">=</span> <span class="n">HC</span> <span class="o">**</span> <span class="n">LINC</span>
      <span class="n">HH</span> <span class="o">=</span> <span class="n">HC</span> <span class="o">*</span> <span class="n">HH</span>
<span class="c">!     TEST IF NEW STEPSIZE IS TOO BIG</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HMAX</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">HMAX</span><span class="p">)</span> <span class="mi">970</span><span class="p">,</span> <span class="mi">970</span><span class="p">,</span> <span class="mi">960</span>
  <span class="mi">950</span> <span class="n">EAVE</span> <span class="o">=</span> <span class="n">EIMAX</span>
      <span class="n">ROBND</span> <span class="o">=</span> <span class="n">CP3</span> <span class="o">+</span> <span class="n">HINCC</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1110</span>
<span class="c">!     NEW STEPSIZE IS TOO BIG</span>
  <span class="mi">960</span> <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">HMAXP9</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">970</span>
      <span class="n">HH</span> <span class="o">=</span> <span class="nb">sign</span><span class="p">(</span><span class="n">HMAX</span><span class="p">,</span> <span class="n">HH</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">950</span>
<span class="c">!     RESTORE THE OLD STEPSIZE</span>
  <span class="mi">970</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1150</span>
<span class="c">! END OF CODE FOR CASE WHEN ERROR ESTIMATES INDICATE STEPSIZE INCREASE</span>
<span class="c">! ********</span>
<span class="c">! TEST IF ESTIMATED ERRORS INDICATE STEPSIZE SHOULD BE DECREASED</span>
<span class="c">! ********</span>
  <span class="mi">980</span> <span class="n">ROBND</span> <span class="o">=</span> <span class="n">C1P3</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">EIMAX</span> <span class="o">&lt;=</span> <span class="n">EAVE</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">990</span>
      <span class="n">EAVE</span> <span class="o">=</span> <span class="n">EAVE</span> <span class="o">+</span> <span class="n">CP4</span> <span class="o">*</span> <span class="p">(</span><span class="n">EIMAX</span> <span class="o">-</span> <span class="n">EAVE</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">EIMAX</span> <span class="o">*</span> <span class="n">EMAX</span><span class="p">)</span> <span class="o">-</span> <span class="n">C1M3</span><span class="p">)</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1010</span><span class="p">,</span> <span class="mi">1010</span>
  <span class="mi">990</span> <span class="n">EAVE</span> <span class="o">=</span> <span class="n">EIMAX</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">EIMAX</span> <span class="o">*</span> <span class="n">EMAX</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">EIMIN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1010</span>
 <span class="mi">1000</span> <span class="n">ROBND</span> <span class="o">=</span> <span class="n">CP3</span> <span class="o">+</span> <span class="p">(</span><span class="n">SIGMA</span><span class="p">(</span><span class="n">KQMAXS</span><span class="p">)</span><span class="o">/</span><span class="n">SIGMA</span><span class="p">(</span><span class="n">KQMAXS</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1180</span>
<span class="c">!     TEST IF STEPSIZE SHOULD BE REDUCED</span>
 <span class="mi">1010</span> <span class="k">if</span> <span class="p">(</span><span class="n">EMAX</span> <span class="o">*</span> <span class="n">EIMAX</span> <span class="o">&lt;</span> <span class="n">EXR</span> <span class="o">*</span> <span class="n">EAVE</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1180</span>
<span class="c">! ********</span>
<span class="c">! ERROR ESTIMATES INDICATE STEPSIZE SHOULD BE REDUCED</span>
<span class="c">! ********</span>
      <span class="n">HC</span> <span class="o">=</span> <span class="n">HDEC</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">EIMIN</span> <span class="o">&lt;=</span> <span class="n">EIMINO</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1030</span>
      <span class="n">EIMIN</span> <span class="o">=</span> <span class="n">EIMINO</span>
      <span class="n">HC</span> <span class="o">=</span> <span class="n">CP875</span>
 <span class="mi">1030</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">HC</span> <span class="o">*</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1040</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">1090</span>
 <span class="mi">1040</span> <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">HMIN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1090</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">CP875</span><span class="o">*</span><span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">HMIN</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span><span class="p">)</span> <span class="mi">1050</span><span class="p">,</span> <span class="mi">970</span><span class="p">,</span> <span class="mi">970</span>
      <span class="n">HH</span> <span class="o">=</span> <span class="nb">sign</span><span class="p">(</span><span class="n">HMIN</span><span class="p">,</span> <span class="n">HH</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1090</span>
<span class="c">!     STEPSIZE IS TOO SMALL TO BE REDUCED</span>
<span class="c">!     SET UP ERROR INDICATORS AND PREPARE FOR RETURN TO USER</span>
 <span class="mi">1050</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">8</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
<span class="c">!     PROCEED WITH CURRENT STEPSIZE DESPITE ERROR BEING TOO BIG</span>
 <span class="mi">1070</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">HH</span>
      <span class="n">EMAX</span> <span class="o">=</span> <span class="n">C0</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1420</span><span class="p">,</span> <span class="mi">1430</span><span class="p">,</span> <span class="mi">1430</span>
<span class="c">!     SET LSC TO END STARTING PHASE</span>
 <span class="mi">1080</span> <span class="n">LSC</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c">!     CHECK IF REPEATING A STEP</span>
 <span class="mi">1090</span> <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">/=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1110</span>
<span class="c">!   WHEN REPEATING A STEP, BACK UP THE DIFFERENCES AND STEPSIZE INFO.</span>
 <span class="mi">1100</span> <span class="k">call </span><span class="n">DIVABU</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
<span class="c">!   TEST IF NOISE TEST (LINC = -7) OR IF H IS NOT</span>
<span class="c">!     BEING CHANGED (LINC = -4)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">1780</span><span class="p">,</span> <span class="mi">1180</span><span class="p">,</span> <span class="mi">1110</span>
<span class="c">! ********</span>
<span class="c">! STEPSIZE IS TO BE CHANGED</span>
<span class="c">! ********</span>
 <span class="mi">1110</span> <span class="k">continue</span>
<span class="c">! MODIFY STEPSIZE TO REDUCE ROUNDOFF ERROR IN ACCUMULATING INDEP. VAR.</span>
      <span class="n">TP</span> <span class="o">=</span> <span class="n">C2</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TN</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4096</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>
      <span class="n">TP</span> <span class="o">=</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">))</span> <span class="o">-</span> <span class="n">TP</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">/=</span> <span class="n">C0</span><span class="p">)</span> <span class="n">HH</span> <span class="o">=</span> <span class="nb">sign</span><span class="p">(</span><span class="n">TP</span><span class="p">,</span> <span class="n">HH</span><span class="p">)</span>
<span class="c">!     TEST IF NEW STEPSIZE SELECTED ACTUALLY GIVES A CHANGE</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">==</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1140</span>
 <span class="mi">1115</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">HH</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1140</span>
<span class="c">!     SETUP TO TELL USER ABOUT STEPSIZE CHANGE (OR TO CHANGE STEPSIZE)</span>
 <span class="mi">1120</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">8</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">860</span>
<span class="c">!     RETURN AFTER TELLING USER ABOUT STEPSIZE CHANGE</span>
 <span class="mi">1130</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 <span class="mi">1140</span> <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">/=</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="n">KQICON</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
 <span class="mi">1150</span> <span class="n">HC</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">EOVEP2</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">))</span> <span class="o">/</span> <span class="n">EEPS2</span>
<span class="c">! ********</span>
<span class="c">! PREPARE FOR BEGINNING A NEW STEP</span>
<span class="c">! ********</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">LINC</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LINC</span><span class="p">,</span> <span class="n">LINCQ</span><span class="p">)</span> <span class="o">+</span> <span class="n">LINCQ</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">1190</span>
      <span class="k">end if</span>
<span class="k"> </span><span class="mi">1180</span> <span class="n">LINC</span> <span class="o">=</span> <span class="n">LINCD</span>
 <span class="mi">1190</span> <span class="k">if</span> <span class="p">(</span><span class="n">HC</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TN</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1200</span>
<span class="c">!     **** GIVE SINGULARITY DIAGNOSTIC</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">5</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
 <span class="mi">1200</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TN</span> <span class="o">+</span> <span class="n">HH</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LEX</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1250</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">*</span> <span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">TMARKX</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">C0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1250</span>
      <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TMARKX</span>
      <span class="n">HH</span> <span class="o">=</span> <span class="n">TMARKX</span> <span class="o">-</span> <span class="n">TN</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="mi">64</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LEX</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1240</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">LSC</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">HH</span> <span class="o">/</span> <span class="n">XI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">CP3</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1230</span>
 <span class="mi">1220</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">CP875</span> <span class="o">*</span> <span class="n">HH</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1110</span>
<span class="c">!     **** GIVE OUTPUT AT CURRENT TMARK (WITH EXTRAPOLATION)</span>
 <span class="mi">1230</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="o">-</span><span class="n">KMARK</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1770</span>
<span class="c">!     **** INTEGRATE TO TMARKX</span>
 <span class="mi">1240</span> <span class="n">KQICON</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="c">!   TEST IF SUBROUTINE FOR COMPUTING INTEGRATION COEFF. SHOULD BE CALLED</span>
 <span class="mi">1250</span> <span class="k">continue</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      IF ((KQMAXI &lt;KQICON) .OR. (KQMAXD&lt;KQDCON)) GO TO 1320</span>
<span class="c">!++  Code for ~STIFF is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KQMAXI</span> <span class="o">&lt;</span> <span class="n">KQICON</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1320</span>
<span class="c">!++  End</span>
<span class="c">!   GO COMPUTE COEFFICIENTS REQUIRED FOR THE INTEGRATION</span>
<span class="c">!     TEST IF STARTING</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1310</span>
 <span class="mi">1260</span> <span class="n">KQMAXI</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      IF (METHOD) 1262,1270,1264</span>
<span class="c">! 1262 KQMAXI=0</span>
<span class="c">! 1264 KQMAXD=max(MAXDIF,2)</span>
<span class="c">!      CALL DIVAHC</span>
<span class="c">!c.  SET UP TO GO DO INITIALIZATION FOR CASE OF STIFF EQUATIONS</span>
<span class="c">!      KORD1I=5</span>
<span class="c">!      GO TO 1350</span>
<span class="c">!++  End</span>
<span class="c">!   INITIALIZE FOR EQUATIONS WHICH ARE NOT STIFF</span>
 <span class="mi">1270</span> <span class="n">KQMAXD</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">call </span><span class="n">DIVAHC</span>
      <span class="n">J</span> <span class="o">=</span> <span class="n">NDTF</span>
      <span class="k">do </span><span class="mi">1300</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTE</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!         if (KORD(I + 3) &lt;= 0) go to 1290</span>
<span class="c">!++  End</span>
         <span class="n">KORD</span><span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c">!     INITIALIZE THE DIFFERENCE TABLE</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LDT</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="n">F</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
         <span class="n">F</span><span class="p">(</span><span class="n">J</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">C0</span>
         <span class="n">F</span><span class="p">(</span><span class="n">J</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">C0</span>
 <span class="mi">1290</span>    <span class="k">continue</span>
<span class="k">         </span><span class="n">J</span> <span class="o">=</span> <span class="n">J</span> <span class="o">+</span> <span class="n">NUMDT</span>
 <span class="mi">1300</span>    <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1340</span>
      <span class="n">LSC</span> <span class="o">=</span> <span class="mi">7</span>
      <span class="n">LDT</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1330</span>
<span class="c">!   INTEGRATION IS NOT BEING STARTED</span>
 <span class="mi">1310</span> <span class="n">K</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">KEMAX</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
      <span class="n">SIGMAS</span> <span class="o">=</span> <span class="n">SIGMA</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
      <span class="k">call </span><span class="n">DIVAHC</span>
<span class="c">!     **** ADJUST EAVE</span>
      <span class="n">TPS1</span> <span class="o">=</span> <span class="n">BETA</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TPS1</span> <span class="o">&gt;</span> <span class="n">C1</span><span class="p">)</span> <span class="n">TPS1</span> <span class="o">=</span> <span class="n">CP5</span> <span class="o">*</span> <span class="n">TPS1</span> <span class="o">+</span> <span class="n">CP5</span>
      <span class="n">EAVE</span> <span class="o">=</span> <span class="n">EAVE</span> <span class="o">*</span> <span class="n">TPS1</span> <span class="o">*</span> <span class="p">(</span><span class="n">SIGMA</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">/</span> <span class="n">SIGMAS</span><span class="p">)</span>
<span class="c">!     TEST BELOW USED TO GET SAME RESULTS WITH/WITHOUT EXTRA EQUATIONS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">&gt;</span> <span class="n">KQICON</span><span class="p">)</span> <span class="n">LSC</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">LSC</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="c">! END OF SPECIAL LOGIC FOR CASE WHEN INTEG. COEFF. ROUTINE IS CALLED</span>
 <span class="mi">1320</span> <span class="k">continue</span>
<span class="c">! ********</span>
<span class="c">! PREDICT Y</span>
<span class="c">! ********</span>
 <span class="mi">1330</span> <span class="k">continue</span>
<span class="c">!++  Code for ~ARGM is active</span>
      <span class="k">call </span><span class="n">DIVAPR</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Y</span><span class="p">(</span><span class="n">NYNY</span><span class="p">),</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
<span class="c">!++  Code for ARGM is inactive</span>
<span class="c">!      CALL DIVAPE</span>
<span class="c">!++  End</span>
<span class="c">!     GO GET PREDICTED DERIVATIVES</span>
 <span class="mi">1340</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="n">KPRED</span>
<span class="c">! ********</span>
<span class="c">! CALL DIVAF  (OR RETURN)</span>
<span class="c">! ********</span>
 <span class="mi">1350</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="mi">0</span>
 <span class="mi">1360</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD1I</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP13</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<span class="k">      call </span><span class="n">DIVAF</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="c">!     TEST FOR SPECIAL USER RETURN</span>
 <span class="mi">1380</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2130</span>
<span class="c">!     TEST FOR SPECIAL CASE</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">660</span>
<span class="c">! ********</span>
<span class="c">! TRANSFER CONTROL TO PROPER PLACE AFTER COMPUTING DERIVATIVES</span>
<span class="c">! ********</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1390</span>
 <span class="mi">1390</span> <span class="k">continue</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ICS</span> <span class="o">-</span> <span class="n">ICF</span><span class="p">)</span> <span class="mi">1410</span><span class="p">,</span> <span class="mi">1410</span><span class="p">,</span> <span class="mi">760</span>
<span class="c">!++  End</span>
<span class="c">! ********</span>
<span class="c">! PREPARE FOR CORRECTING, AND CORRECT Y</span>
<span class="c">! ********</span>
 <span class="mi">1400</span> <span class="n">ITOLEP</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">ILGREP</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">IY</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">EIMAX</span> <span class="o">=</span> <span class="n">C1M5</span>
      <span class="n">EMAX</span> <span class="o">=</span> <span class="n">C0</span>
      <span class="n">KQMAXI</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="n">KQMAXS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      IF (METHOD) 1404,1410,1406</span>
<span class="c">! 1404 KQMAXI=0</span>
<span class="c">! 1406 KQMAXD=2</span>
<span class="c">!++  End</span>
 <span class="mi">1410</span> <span class="k">continue</span>
<span class="c">!++  Code for ~ARGM is active</span>
      <span class="k">call </span><span class="n">DIVACR</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="n">NTOLF</span><span class="p">),</span> <span class="n">KORD</span><span class="p">(</span><span class="n">IOP16</span><span class="p">))</span>
<span class="c">!++  Code for ARGM is inactive</span>
<span class="c">!      CALL DIVACE</span>
<span class="c">!++  End</span>
<span class="c">!     TEST IF ESTIMATED ERROR IS TOO BIG (OR IF DIAGNOSTIC CALLED FOR)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">EMAX</span> <span class="o">&gt;</span> <span class="n">EREP</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">EREP</span><span class="p">)</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">1670</span>
 <span class="mi">1420</span> <span class="k">continue</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP18</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">760</span>
<span class="c">!++  End</span>
 <span class="mi">1430</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c">!     TEST IF NOISE APPEARS TO LIMIT PRECISION</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">EMAX</span> <span class="o">&lt;</span> <span class="n">C0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1470</span>
<span class="c">!++  Code for ~STIFF is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span><span class="p">)</span> <span class="mi">1450</span><span class="p">,</span> <span class="mi">1360</span><span class="p">,</span> <span class="mi">1610</span>
<span class="c">!++  Code for STIFF is inactive</span>
<span class="c">!      IF (LSC) 1450,1460,1610</span>
<span class="c">!++  End</span>
<span class="c">!     SET LSC=0 IF NOISE NO LONGER APPEARS TO LIMIT PRECISION</span>
<span class="c">!     OR IF THE END OF THE STARTING PHASE HAS BEEN REACHED</span>
 <span class="mi">1450</span> <span class="n">LSC</span> <span class="o">=</span> <span class="mi">0</span>
 <span class="mi">1460</span> <span class="k">if</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1350</span><span class="p">,</span> <span class="mi">1350</span>
<span class="c">! ********</span>
<span class="c">! NOISE APPEARS TO BE LIMITING PRECISION</span>
<span class="c">! ********</span>
 <span class="mi">1470</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">LSC</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">LSC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">KQMAXS</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1460</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">EMAX</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EXR</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1590</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
      <span class="n">TPS2</span> <span class="o">=</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">BETA</span><span class="p">(</span><span class="n">NOISEQ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="n">NOISEQ</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">SNOISE</span> <span class="o">&lt;</span> <span class="n">EEPS10</span> <span class="o">*</span> <span class="n">TPS2</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1550</span>
      <span class="n">TP</span> <span class="o">=</span> <span class="nb">sign</span><span class="p">(</span><span class="n">EEPT75</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TN</span><span class="p">)</span> <span class="o">+</span> <span class="n">OVTM75</span><span class="p">,</span> <span class="n">HH</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">TP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1550</span>
      <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TN</span> <span class="o">+</span> <span class="n">TP</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c">!     **** GO TO BACK UP THE DIFFERENCES AND GET F(TSPECS(1))</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1100</span>
<span class="c">!     **** SOLUTION HAS BEEN INTERPOLATED AND F COMPUTED</span>
 <span class="mi">1490</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="n">LINC</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="mi">1510</span><span class="p">,</span> <span class="mi">1520</span><span class="p">,</span> <span class="mi">1500</span>
 <span class="mi">1500</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TN</span> <span class="o">+</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="n">TP</span><span class="p">)</span>
      <span class="n">TP1</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">KEMAX</span><span class="p">)</span>
      <span class="n">TP2</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">NDTF</span> <span class="o">+</span> <span class="n">NUMDT</span> <span class="o">*</span> <span class="n">KEMAX</span> <span class="o">-</span> <span class="n">NUMDT</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1780</span>
<span class="c">!     **** COMPUTE 2-ND DIFFERENCE AT CLOSE SPACED T VALUES</span>
 <span class="mi">1510</span> <span class="n">TP2</span> <span class="o">=</span> <span class="n">TP3</span>
 <span class="mi">1520</span> <span class="n">TP3</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">KEMAX</span><span class="p">)</span>
      <span class="n">TPS1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">TP3</span> <span class="o">-</span> <span class="n">TP1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">TP1</span> <span class="o">-</span> <span class="n">TP2</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">C16</span> <span class="o">*</span> <span class="n">TPS1</span> <span class="o">*</span> <span class="n">TPS2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">DNOISE</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="mi">1550</span><span class="p">,</span> <span class="mi">870</span><span class="p">,</span> <span class="mi">1550</span>
 <span class="mi">1530</span> <span class="k">continue</span>
<span class="k">      </span><span class="n">TPS2</span> <span class="o">=</span> <span class="n">CP25</span> <span class="o">*</span> <span class="n">SNOISE</span> <span class="o">/</span> <span class="n">RBQ</span><span class="p">(</span><span class="n">NOISEQ</span><span class="p">)</span>
      <span class="k">do </span><span class="mi">1540</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NUMDT</span>
         <span class="n">TPS1</span> <span class="o">=</span> <span class="n">TPS1</span> <span class="o">+</span> <span class="n">TPS1</span>
         <span class="n">RBQ</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">TPS1</span><span class="p">,</span> <span class="n">TPS2</span> <span class="o">*</span> <span class="n">RBQ</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
 <span class="mi">1540</span>    <span class="k">continue</span>
<span class="k">      </span><span class="n">LINC</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c">!FTK Next two lines added 2009-10-15</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">EMAX</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EREP</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1460</span>
<span class="c">!FTK  LINC = -1  And then on 2015-03-14 commented out this line</span>

      <span class="n">HH</span> <span class="o">=</span> <span class="n">CP875</span> <span class="o">*</span> <span class="n">HH</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1040</span>
<span class="c">!     **** SET UP TO GIVE NOISE DIAGNOSTIC</span>
 <span class="mi">1550</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">6</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
<span class="c">!     **** AFTER GIVING NOISE DIAGNOSTIC</span>
 <span class="mi">1560</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">TPS1</span> <span class="o">=</span> <span class="n">EEPS10</span>
<span class="c">!FTK Next line added 2009-10-15</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">TPS1</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">49</span><span class="n">D0</span> <span class="o">*</span> <span class="n">RBQ</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1530</span>
      <span class="k">end if</span>
<span class="c">!     **** SET NEW VALUE FOR OFFENDING TOL</span>
      <span class="n">F</span><span class="p">(</span><span class="n">NTOLF</span> <span class="o">+</span> <span class="n">ITOLEP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FDAT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="mi">1180</span><span class="p">,</span> <span class="mi">1570</span><span class="p">,</span> <span class="mi">1180</span>
 <span class="mi">1570</span> <span class="n">LINC</span> <span class="o">=</span> <span class="mi">0</span>
 <span class="mi">1580</span> <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span><span class="p">)</span> <span class="mi">1460</span><span class="p">,</span> <span class="mi">1460</span><span class="p">,</span> <span class="mi">1610</span>
<span class="c">!     **** CHANGE HINCC AND ADJUST SIGMA( )</span>
 <span class="mi">1590</span> <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">/=</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1580</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">HINCC</span> <span class="o">==</span> <span class="n">C1P125</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1580</span>
      <span class="n">TPS1</span> <span class="o">=</span> <span class="n">C1P125</span> <span class="o">/</span> <span class="n">HINCC</span>
      <span class="n">TPS2</span> <span class="o">=</span> <span class="mf">1.0D0</span>
      <span class="k">do </span><span class="mi">1600</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">IOP11</span>
         <span class="n">TPS2</span> <span class="o">=</span> <span class="n">TPS2</span> <span class="o">*</span> <span class="n">TPS1</span>
         <span class="n">SIGMA</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">SIGMA</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">*</span> <span class="n">TPS2</span>
 <span class="mi">1600</span>    <span class="k">continue</span>
<span class="k">      </span><span class="n">EAVE</span> <span class="o">=</span> <span class="n">EAVE</span> <span class="o">*</span> <span class="n">TPS1</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">KORD</span><span class="p">(</span><span class="n">KEMAX</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span>
      <span class="n">LINCD</span> <span class="o">=</span> <span class="mi">6</span>
      <span class="n">LINCQ</span> <span class="o">=</span> <span class="mi">12</span>
      <span class="n">HINCC</span> <span class="o">=</span> <span class="n">C1P125</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1460</span>
<span class="c">!   END OF CODE FOR CASE WHEN NOISE APPEARS TO LIMIT PRECISION</span>
<span class="c">! ********</span>
<span class="c">! SPECIAL LOGIC FOR STARTING THE INTEGRATION</span>
<span class="c">! ********</span>
 <span class="mi">1610</span> <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">800</span>
      <span class="n">LSC</span> <span class="o">=</span> <span class="n">LSC</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1620</span><span class="p">,</span> <span class="mi">1640</span><span class="p">,</span> <span class="mi">1650</span>
 <span class="mi">1620</span> <span class="k">if</span> <span class="p">(</span><span class="n">EIMAX</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">CP0625</span><span class="o">*</span><span class="n">EAVE</span><span class="o">*</span><span class="p">(</span><span class="n">SIGMA</span><span class="p">(</span><span class="n">KQMAXS</span><span class="p">)</span><span class="o">/</span><span class="n">SIGMAS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">BETA</span><span class="p">(</span><span class="n">KQMAXS</span><span class="o">+</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">800</span>
 <span class="mi">1630</span> <span class="n">KSSTRT</span> <span class="o">=</span> <span class="n">KSTEP</span> <span class="o">+</span> <span class="mi">2</span>
<span class="c">!   TEST IF STEPSIZE IS TOO SMALL BEFORE ENDING STARTING PHASE</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">HMIN</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1450</span>
<span class="c">!     GIVE DIAGNOSTIC FOR STEPSIZE TOO SMALL AT END OF START</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">7</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
<span class="c">!   SET LSC TO DO ONE DERIVATIVE EVAL. PER STEP</span>
 <span class="mi">1640</span> <span class="n">LSC</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">800</span>
<span class="c">!     TEST IF FIRST TIME THROUGH THE FIRST STEP</span>
 <span class="mi">1650</span> <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1340</span>
<span class="c">!     END STARTING PHASE IF CONVERGENCE OF CORRECTOR ITERATES TOO SLOW</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LDT</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1660</span>
      <span class="n">LSC</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LSC</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">800</span>
 <span class="mi">1660</span> <span class="n">LDT</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">1260</span><span class="p">,</span> <span class="mi">1630</span><span class="p">,</span> <span class="mi">1260</span>
<span class="c">! END OF SPECIAL LOGIC FOR STARTING THE INTEGRATION</span>
<span class="c">! ********</span>
<span class="c">! ESTIMATED ERROR IS TOO BIG</span>
<span class="c">! ********</span>
 <span class="mi">1670</span> <span class="k">if</span> <span class="p">(</span><span class="n">BETA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">C1</span><span class="p">)</span> <span class="mi">1690</span><span class="p">,</span> <span class="mi">1730</span><span class="p">,</span> <span class="mi">1680</span>
 <span class="mi">1680</span> <span class="n">HC</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">/</span> <span class="n">BETA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">BETA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">C1P125</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1740</span>
 <span class="mi">1690</span> <span class="k">if</span> <span class="p">(</span><span class="n">BETA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">CP1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1730</span>
<span class="c">!   REQUIRED STEPSIZE REDUCTION IS TOO RAPID -- GIVE A DIAGNOSTIC</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
<span class="c">!</span>
<span class="c">!     TEST KORD(2) AFTER ABOVE DIAGNOSTIC OR A DISCONTINUITY DIAGNOSTIC</span>
 <span class="mi">1700</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1730</span>
<span class="c">!  TEST IF SOLUTION MUST BE DUMPED BEFORE A RESTART</span>
 <span class="mi">1710</span> <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP9</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1750</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KIS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1750</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
<span class="c">!.    GO DUMP SOLUTION BEFORE REPEATING THE STEP</span>
 <span class="mi">1720</span> <span class="n">KQMAXI</span> <span class="o">=</span> <span class="n">KQMXIS</span>
<span class="c">!++  Code for DUMP &amp; STIFF is inactive</span>
<span class="c">!      KQMAXD=KQMXDS</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="k">call </span><span class="n">DIVABU</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">900</span>
<span class="c">!++  End</span>
<span class="c">!   SET UP TO REPEAT THE STEP</span>
 <span class="mi">1730</span> <span class="n">HC</span> <span class="o">=</span> <span class="n">CP5</span>
 <span class="mi">1740</span> <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1030</span>
<span class="c">!   RESTART THE INTEGRATION IF ERROR IS TOO BIG ON FIRST OR SECOND STEP</span>
<span class="c">! LOOP TO SELECT A NEW INITIAL STEPSIZE</span>
 <span class="mi">1750</span> <span class="n">LSC</span> <span class="o">=</span> <span class="mi">7</span>
 <span class="mi">1755</span> <span class="n">HH</span> <span class="o">=</span> <span class="n">HH</span> <span class="o">*</span> <span class="n">CP5</span>
      <span class="n">EMAX</span> <span class="o">=</span> <span class="n">EMAX</span> <span class="o">*</span> <span class="n">CP25</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">EMAX</span> <span class="o">&gt;=</span> <span class="n">CP3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1755</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1090</span>
<span class="c">!   END OF SELECTING A NEW INITIAL STEPSIZE</span>
<span class="c">! END OF LOGIC FOR CASE WHEN ESTIMATED ERROR IS TOO BIG</span>
<span class="c">! ********</span>
<span class="c">! INTEGRATION HAS REACHED AN OUTPUT POINT</span>
<span class="c">! ********</span>
 <span class="mi">1760</span> <span class="k">if</span> <span class="p">(</span><span class="n">KMARK</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1920</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">KMARK</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">KMARK</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">TMARK</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1790</span>
 <span class="mi">1770</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TMARK</span>
 <span class="mi">1780</span> <span class="k">call </span><span class="n">DIVAIN</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">)</span>
 <span class="mi">1790</span> <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">KORD1I</span><span class="p">)</span> <span class="mi">1800</span><span class="p">,</span> <span class="mi">730</span><span class="p">,</span> <span class="mi">1810</span>
<span class="c">!   OUTPUT POINT IS OBTAINED BY EXTRAPOLATION</span>
 <span class="mi">1800</span> <span class="k">continue</span>
<span class="c">!++  Code for EXTRAP is active</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="o">-</span><span class="n">KORD1I</span>
      <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
      <span class="n">KEXIT</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c">!.  TEST IF GSTOP-S ARE PRESENT</span>
<span class="c">!++  Code for EXTRAP &amp;  GSTOP is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">NGTOT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1820</span>
      <span class="n">IGFLG</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">KEXIT</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">7</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP7</span><span class="p">)</span> <span class="mi">740</span><span class="p">,</span> <span class="mi">1820</span><span class="p">,</span> <span class="mi">740</span>
<span class="c">!++  End</span>
<span class="c">! ********</span>
<span class="c">! CALL DIVAO  (OR RETURN)</span>
<span class="c">! ********</span>
 <span class="mi">1810</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="mi">1</span>
 <span class="mi">1820</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD1I</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP14</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<span class="k">      call </span><span class="n">DIVAO</span><span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Y</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="c">!     TEST FOR SPECIAL USER RETURN OR FOR A RESTART</span>
<span class="c">!++  Code for ~DUMP is inactive</span>
<span class="c">! 1840 IF (KORD(1)) 2130,700,1880</span>
<span class="c">!++  Code for DUMP is active</span>
 <span class="mi">1840</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1880</span>
 <span class="mi">1850</span> <span class="k">if</span> <span class="p">(</span><span class="n">IOP9</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1870</span>
<span class="c">!.    **** GO DUMP THE SOLUTION</span>
      <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
      <span class="n">ITOLEP</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">NEPTOL</span> <span class="o">=</span> <span class="n">KORD1I</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">/=</span> <span class="mi">8</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">900</span>
 <span class="mi">1860</span> <span class="n">LINC</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">LINCD</span><span class="p">)</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="n">NEPTOL</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITOLEP</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="mi">1870</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="mi">2130</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">2100</span>
<span class="c">!++  End</span>
 <span class="mi">1880</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="p">(</span><span class="mi">2140</span><span class="p">,</span> <span class="mi">1810</span><span class="p">,</span> <span class="mi">1350</span><span class="p">,</span> <span class="mi">2110</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">680</span><span class="p">,</span>  <span class="p">&amp;</span>
     <span class="p">&amp;</span>   <span class="mi">710</span><span class="p">),</span> <span class="o">-</span><span class="n">KORD2I</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1380</span>
<span class="c">! ********</span>
<span class="c">! TRANSFER CONTROL TO PROPER PLACE AFTER OUTPUT</span>
<span class="c">! ********</span>
 <span class="mi">1890</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">1910</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">1900</span>
 <span class="mi">1900</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="mi">840</span><span class="p">,</span> <span class="mi">1130</span><span class="p">,</span> <span class="mi">910</span>
 <span class="mi">1910</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">880</span>
<span class="c">!   GET NEW TOUT</span>
 <span class="mi">1920</span> <span class="n">TOUT</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">TSPECS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c">! GET NEW TMARK (NEXT INDEP. VAR. OUTPUT POINT)</span>
 <span class="mi">1930</span> <span class="n">XP</span> <span class="o">=</span> <span class="n">TMARK</span>
      <span class="n">K</span> <span class="o">=</span> <span class="n">KMARK</span>
      <span class="n">TMARK</span> <span class="o">=</span> <span class="n">TOUT</span>
      <span class="n">KMARK</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="n">LEX</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP5</span><span class="p">)</span> <span class="mi">1940</span><span class="p">,</span> <span class="mi">1980</span><span class="p">,</span> <span class="mi">1970</span>
 <span class="mi">1940</span> <span class="n">I</span> <span class="o">=</span> <span class="o">-</span><span class="n">IOP5</span>
 <span class="mi">1950</span> <span class="n">I</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">3</span>
      <span class="n">J1</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">J1</span><span class="p">)</span> <span class="mi">1950</span><span class="p">,</span> <span class="mi">1980</span><span class="p">,</span> <span class="mi">1960</span>
 <span class="mi">1960</span> <span class="n">J2</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
      <span class="n">L</span> <span class="o">=</span> <span class="n">KORD</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1990</span>
 <span class="mi">1970</span> <span class="n">J1</span> <span class="o">=</span> <span class="mi">5</span>
      <span class="n">J2</span> <span class="o">=</span> <span class="n">IOP5</span>
      <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">J2</span> <span class="o">&gt;=</span> <span class="n">J1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1990</span>
 <span class="mi">1980</span> <span class="n">J1</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">J2</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">L</span> <span class="o">=</span> <span class="n">IOP3</span>
<span class="c">!</span>
<span class="c">!     **** LOOP TO SET NEW TMARK (AND TMARKX)</span>
 <span class="mi">1990</span> <span class="k">do </span><span class="mi">2060</span> <span class="n">J</span> <span class="o">=</span> <span class="n">J1</span><span class="p">,</span> <span class="n">J2</span>
<span class="c">!        **** TEST IF EXTRAPOLATION NOT POSSIBLE</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">L</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2010</span>
         <span class="n">LX</span> <span class="o">=</span> <span class="mi">2</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LEX</span><span class="p">)</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2030</span><span class="p">,</span> <span class="mi">2020</span>
 <span class="mi">2000</span>    <span class="n">LEX</span> <span class="o">=</span> <span class="n">L</span>
 <span class="mi">2010</span>    <span class="n">LX</span> <span class="o">=</span> <span class="mi">1</span>
 <span class="mi">2020</span>    <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">*</span> <span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">-</span> <span class="n">TMARKA</span><span class="p">(</span><span class="n">LX</span><span class="p">)))</span> <span class="mi">2030</span><span class="p">,</span> <span class="mi">2060</span><span class="p">,</span> <span class="mi">2060</span>
 <span class="mi">2030</span>    <span class="k">if</span> <span class="p">(</span><span class="n">J</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2050</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">*</span> <span class="p">(</span><span class="n">TSPECS</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">-</span> <span class="n">XP</span><span class="p">))</span> <span class="mi">2060</span><span class="p">,</span> <span class="mi">2040</span><span class="p">,</span> <span class="mi">2050</span>
 <span class="mi">2040</span>    <span class="k">if</span> <span class="p">((</span><span class="n">K</span> <span class="o">&gt;=</span> <span class="n">J</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="mi">3</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2060</span>
 <span class="mi">2050</span>    <span class="n">TMARKA</span><span class="p">(</span><span class="n">LX</span><span class="p">)</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">LX</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2000</span>
         <span class="n">KMARK</span> <span class="o">=</span> <span class="n">J</span>
 <span class="mi">2060</span>    <span class="k">continue</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">IOP5</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1950</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">J1</span> <span class="o">/=</span> <span class="mi">4</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1980</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KMARK</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="n">KMARK</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c">!     **** TEST IF NEW TMARK IS ACCEPTABLE</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">HH</span> <span class="o">*</span> <span class="p">(</span><span class="n">XP</span> <span class="o">-</span> <span class="n">TMARK</span><span class="p">))</span> <span class="mi">2070</span><span class="p">,</span> <span class="mi">2080</span><span class="p">,</span> <span class="mi">2090</span>
 <span class="mi">2070</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD2I</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">670</span><span class="p">,</span> <span class="mi">840</span><span class="p">,</span> <span class="mi">670</span>
 <span class="mi">2080</span> <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">/=</span> <span class="n">KMARK</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2070</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1850</span>
<span class="c">!++  Code for ~DUMP is inactive</span>
<span class="c">!      IF (KORD1I == 3) GO TO 2100</span>
<span class="c">!++  End</span>
 <span class="mi">2090</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2190</span>
<span class="c">! SETUP TO INDICATE ERROR IN SPECIFICATION OF OUTPUT POINTS</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">KMARK</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KMARK</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">KMARK</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">FDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">TSPECS</span><span class="p">(</span><span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
<span class="c">!     SET KORD1I=1 TO INDICATE THAT END OF INTEGRATION HAS BEEN REACHED</span>
 <span class="mi">2100</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c">! ********</span>
<span class="c">! RETURN TO USER</span>
<span class="c">! ********</span>
 <span class="mi">2110</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="n">KORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD1I</span>
 <span class="mi">2130</span> <span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="k">return</span>
<span class="c">! ********</span>
<span class="c">! TRANSFER CONTROL TO PROPER PLACE AFTER RETURN TO USER</span>
<span class="c">! ********</span>
 <span class="mi">2140</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">2150</span><span class="p">,</span> <span class="mi">1560</span><span class="p">,</span> <span class="mi">2160</span>
 <span class="mi">2150</span> <span class="n">KORD2I</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1930</span>
 <span class="mi">2160</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">1700</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mi">2170</span>
 <span class="mi">2170</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">13</span><span class="p">)</span> <span class="mi">2180</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">2190</span>
 <span class="mi">2180</span> <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">HMIN</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span> <span class="mi">1030</span><span class="p">,</span> <span class="mi">1450</span><span class="p">,</span> <span class="mi">1030</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span> <span class="mi">1070</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1070</span>
<span class="c">!   ERROR MESSAGES HAVE BEEN IGNORED -- COMPUTATION CAN NOT CONTINUE</span>
 <span class="mi">2190</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2240</span>
<span class="c">!</span>
<span class="c">!        AFTER A DISCONTINUITY RETURN</span>
 <span class="mi">2200</span> <span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="mi">1710</span><span class="p">,</span> <span class="mi">1730</span><span class="p">,</span> <span class="mi">1100</span>
<span class="c">! ********</span>
<span class="c">! PROBLEM ENCOUNTERED WHEN CORRECTING</span>
<span class="c">! ********</span>
 <span class="mi">2210</span> <span class="k">if</span> <span class="p">(</span><span class="n">LDIS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">2230</span>
<span class="c">!           Extra checks when had a user specified discontinuity.</span>
<span class="c">!++  Code for VAREQ is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOP18</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">760</span>
<span class="c">!++  End</span>
 <span class="mi">2220</span> <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">2</span>
      <span class="n">LDIS</span> <span class="o">=</span> <span class="n">LDIS</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">TP</span> <span class="o">=</span> <span class="n">DISADJ</span> <span class="o">/</span> <span class="n">HH</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KIS</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">LDIS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">KQMAXS</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">LDIS</span> <span class="o">=</span> <span class="mi">0</span>
               <span class="n">EREP</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">EREP</span><span class="p">)</span>
               <span class="n">TSPECS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">HH</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">TP</span><span class="p">,</span> <span class="n">TP</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>                       <span class="p">&amp;</span>
     <span class="p">&amp;</span>            <span class="p">(</span><span class="n">CP25</span> <span class="o">*</span> <span class="n">EXR</span><span class="o">/</span><span class="n">EMAX</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">333333333</span><span class="n">D0</span><span class="p">)</span>
               <span class="n">go</span> <span class="n">to</span> <span class="mi">720</span>
            <span class="k">end if</span>
<span class="k">            </span><span class="n">LINC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">IOP9</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KIS</span> <span class="o">=</span> <span class="mi">1001</span>
            <span class="n">go</span> <span class="n">to</span> <span class="mi">800</span>
         <span class="k">end if</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">IOP9</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">KIS</span> <span class="o">=</span> <span class="n">KIS</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">KQMAXS</span> <span class="o">&lt;=</span> <span class="n">LDIS</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="n">KIS</span> <span class="o">=</span> <span class="n">LDIS</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="n">LINC</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LINC</span><span class="p">,</span> <span class="n">LDIS</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">LDIS</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">KQMAXS</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">EREP</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">EREP</span><span class="p">)</span>
         <span class="n">LDIS</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">EMAX</span> <span class="o">&gt;</span> <span class="n">EREP</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1670</span>
         <span class="n">go</span> <span class="n">to</span> <span class="mi">1430</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&gt;=</span> <span class="n">HINCC</span><span class="o">**</span><span class="p">(</span><span class="n">LINC</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">((</span><span class="n">LDIS</span> <span class="o">/=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">TP</span> <span class="o">&gt;</span> <span class="nb">dble</span><span class="p">(</span><span class="n">KQMAXS</span><span class="p">)))</span> <span class="n">LSC</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="n">EIMIN</span> <span class="o">=</span> <span class="n">CP5</span>
         <span class="n">EAVE</span> <span class="o">=</span> <span class="n">EAVE</span> <span class="o">*</span> <span class="n">TP</span><span class="o">**</span><span class="mi">8</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">LSC</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1630</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">EMAX</span> <span class="o">&gt;</span> <span class="n">EXR</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1730</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">1430</span>
<span class="c">!</span>
 <span class="mi">2230</span> <span class="n">EREP</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">EREP</span><span class="p">)</span>
<span class="c">!++  Code for DUMP is active</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">LINC</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1720</span>
<span class="c">!++  End</span>
<span class="c">!     BAD TOL</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c">! ********</span>
<span class="c">! ERROR PROCESSING</span>
<span class="c">! ********</span>
 <span class="mi">2240</span> <span class="n">FDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TN</span>
      <span class="n">FDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">HH</span>
      <span class="n">IDAT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">KSTEP</span>
      <span class="n">ITOLEP</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">NEPTOL</span><span class="p">,</span> <span class="o">-</span><span class="n">NEPTOL</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">J</span> <span class="o">=</span> <span class="mi">3</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">J</span> <span class="o">=</span> <span class="mi">4</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HMIN</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">K</span> <span class="o">=</span> <span class="mi">8</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">MACT</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">LTXTAL</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">C0</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITOLEP</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITOLEP</span> <span class="o">+</span> <span class="n">NTOLF</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">K</span> <span class="o">=</span> <span class="mi">11</span>
         <span class="k">end if</span>
<span class="k">      else</span>
<span class="k">         </span><span class="n">MACT</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">LTXTAK</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">EMAX</span>
         <span class="n">IDAT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">KEMAX</span>
         <span class="n">IDAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITOLEP</span>
         <span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITOLEP</span> <span class="o">+</span> <span class="n">NTOLF</span> <span class="o">-</span> <span class="mi">1</span>
         <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
         <span class="n">K</span> <span class="o">=</span> <span class="mi">14</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">KORD1I</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">K</span> <span class="o">=</span> <span class="mi">17</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">2.D0</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">EMAX</span><span class="p">)</span> <span class="o">*</span> <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">FDAT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">MACT</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">LTXTAL</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">NEPTOL</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">MACT</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">LTXTAM</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">IDAT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">IDAT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">IDAT</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">FDAT</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="c">! Set the location for the first part of the message that varies, set</span>
<span class="c">! the error severity, and the index number, print the error and</span>
<span class="c">! return or stop.</span>
      <span class="n">L</span> <span class="o">=</span> <span class="n">MLOC</span><span class="p">(</span><span class="n">KORD1I</span><span class="p">)</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">LOCM</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">MACT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">LOCM</span><span class="p">)</span> <span class="o">/</span> <span class="mi">32</span>
      <span class="n">KORD1I</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
      <span class="n">MACT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">KORD1I</span>
      <span class="n">MACT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">MERET</span>
<span class="c">!--D Next line special: P=&gt;S, X=&gt;D</span>
      <span class="k">call </span><span class="n">DMESS</span><span class="p">(</span><span class="n">MACT</span><span class="p">,</span> <span class="n">MTXTAA</span><span class="p">,</span> <span class="n">IDAT</span><span class="p">,</span> <span class="n">FDAT</span><span class="p">)</span>
      <span class="n">MACT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">MENTXT</span>
      <span class="n">go</span> <span class="n">to</span> <span class="mi">2110</span>

    <span class="k">end subroutine </span><span class="n">divaa</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> diva was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>